<?xml version='1.0' encoding='UTF-8' standalone='no'?>
<doxygen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="compound.xsd" version="1.9.1" xml:lang="en-US">
  <compounddef id="FichierHDF_8cpp" kind="file" language="C++">
    <compoundname>FichierHDF.cpp</compoundname>
    <includes refid="EntreeSortie_8h" local="no">EntreeSortie.h</includes>
    <includes refid="FichierHDF_8h" local="no">FichierHDF.h</includes>
    <includes local="no">vector</includes>
    <includes refid="communications_8h" local="no">communications.h</includes>
    <incdepgraph>
      <node id="1">
        <label>FichierHDF.cpp</label>
        <link refid="FichierHDF_8cpp"/>
        <childnode refid="2" relation="include">
        </childnode>
      </node>
      <node id="2">
        <label>vector</label>
      </node>
    </incdepgraph>
    <briefdescription>
    </briefdescription>
    <detaileddescription>
    </detaileddescription>
    <programlisting>
<codeline lineno="1"><highlight class="comment">/****************************************************************************</highlight></codeline>
<codeline lineno="2"><highlight class="comment">*<sp/>Copyright<sp/>(c)<sp/>2024,<sp/>CEA</highlight></codeline>
<codeline lineno="3"><highlight class="comment">*<sp/>All<sp/>rights<sp/>reserved.</highlight></codeline>
<codeline lineno="4"><highlight class="comment">*</highlight></codeline>
<codeline lineno="5"><highlight class="comment">*<sp/>Redistribution<sp/>and<sp/>use<sp/>in<sp/>source<sp/>and<sp/>binary<sp/>forms,<sp/>with<sp/>or<sp/>without<sp/>modification,<sp/>are<sp/>permitted<sp/>provided<sp/>that<sp/>the<sp/>following<sp/>conditions<sp/>are<sp/>met:</highlight></codeline>
<codeline lineno="6"><highlight class="comment">*<sp/>1.<sp/>Redistributions<sp/>of<sp/>source<sp/>code<sp/>must<sp/>retain<sp/>the<sp/>above<sp/>copyright<sp/>notice,<sp/>this<sp/>list<sp/>of<sp/>conditions<sp/>and<sp/>the<sp/>following<sp/>disclaimer.</highlight></codeline>
<codeline lineno="7"><highlight class="comment">*<sp/>2.<sp/>Redistributions<sp/>in<sp/>binary<sp/>form<sp/>must<sp/>reproduce<sp/>the<sp/>above<sp/>copyright<sp/>notice,<sp/>this<sp/>list<sp/>of<sp/>conditions<sp/>and<sp/>the<sp/>following<sp/>disclaimer<sp/>in<sp/>the<sp/>documentation<sp/>and/or<sp/>other<sp/>materials<sp/>provided<sp/>with<sp/>the<sp/>distribution.</highlight></codeline>
<codeline lineno="8"><highlight class="comment">*<sp/>3.<sp/>Neither<sp/>the<sp/>name<sp/>of<sp/>the<sp/>copyright<sp/>holder<sp/>nor<sp/>the<sp/>names<sp/>of<sp/>its<sp/>contributors<sp/>may<sp/>be<sp/>used<sp/>to<sp/>endorse<sp/>or<sp/>promote<sp/>products<sp/>derived<sp/>from<sp/>this<sp/>software<sp/>without<sp/>specific<sp/>prior<sp/>written<sp/>permission.</highlight></codeline>
<codeline lineno="9"><highlight class="comment">*</highlight></codeline>
<codeline lineno="10"><highlight class="comment">*<sp/>THIS<sp/>SOFTWARE<sp/>IS<sp/>PROVIDED<sp/>BY<sp/>THE<sp/>COPYRIGHT<sp/>HOLDERS<sp/>AND<sp/>CONTRIBUTORS<sp/>&quot;AS<sp/>IS&quot;<sp/>AND<sp/>ANY<sp/>EXPRESS<sp/>OR<sp/>IMPLIED<sp/>WARRANTIES,<sp/>INCLUDING,<sp/>BUT<sp/>NOT<sp/>LIMITED<sp/>TO,<sp/>THE<sp/>IMPLIED<sp/>WARRANTIES<sp/>OF<sp/>MERCHANTABILITY<sp/>AND<sp/>FITNESS<sp/>FOR<sp/>A<sp/>PARTICULAR<sp/>PURPOSE<sp/>ARE<sp/>DISCLAIMED.</highlight></codeline>
<codeline lineno="11"><highlight class="comment">*<sp/>IN<sp/>NO<sp/>EVENT<sp/>SHALL<sp/>THE<sp/>COPYRIGHT<sp/>HOLDER<sp/>OR<sp/>CONTRIBUTORS<sp/>BE<sp/>LIABLE<sp/>FOR<sp/>ANY<sp/>DIRECT,<sp/>INDIRECT,<sp/>INCIDENTAL,<sp/>SPECIAL,<sp/>EXEMPLARY,<sp/>OR<sp/>CONSEQUENTIAL<sp/>DAMAGES<sp/>(INCLUDING,<sp/>BUT<sp/>NOT<sp/>LIMITED<sp/>TO,<sp/>PROCUREMENT<sp/>OF<sp/>SUBSTITUTE<sp/>GOODS<sp/>OR<sp/>SERVICES;<sp/>LOSS<sp/>OF<sp/>USE,<sp/>DATA,<sp/>OR<sp/>PROFITS;</highlight></codeline>
<codeline lineno="12"><highlight class="comment">*<sp/>OR<sp/>BUSINESS<sp/>INTERRUPTION)<sp/>HOWEVER<sp/>CAUSED<sp/>AND<sp/>ON<sp/>ANY<sp/>THEORY<sp/>OF<sp/>LIABILITY,<sp/>WHETHER<sp/>IN<sp/>CONTRACT,<sp/>STRICT<sp/>LIABILITY,<sp/>OR<sp/>TORT<sp/>(INCLUDING<sp/>NEGLIGENCE<sp/>OR<sp/>OTHERWISE)<sp/>ARISING<sp/>IN<sp/>ANY<sp/>WAY<sp/>OUT<sp/>OF<sp/>THE<sp/>USE<sp/>OF<sp/>THIS<sp/>SOFTWARE,<sp/>EVEN<sp/>IF<sp/>ADVISED<sp/>OF<sp/>THE<sp/>POSSIBILITY<sp/>OF<sp/>SUCH<sp/>DAMAGE.</highlight></codeline>
<codeline lineno="13"><highlight class="comment">*</highlight></codeline>
<codeline lineno="14"><highlight class="comment">*****************************************************************************/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="15"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;EntreeSortie.h&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="16"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;FichierHDF.h&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="17"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;vector&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="18"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;communications.h&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="19"><highlight class="normal"></highlight></codeline>
<codeline lineno="20"><highlight class="normal"></highlight><highlight class="preprocessor">#ifndef<sp/>MED_</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="21" refid="classFichierHDF_1ac43702178467435cbdef199bc28a5fa9" refkind="member"><highlight class="normal"><ref refid="classFichierHDF_1ac43702178467435cbdef199bc28a5fa9" kindref="member">FichierHDF::FichierHDF</ref>()</highlight></codeline>
<codeline lineno="22"><highlight class="normal">{</highlight></codeline>
<codeline lineno="23"><highlight class="normal"><sp/><sp/>Cerr<sp/>&lt;&lt;<sp/></highlight><highlight class="stringliteral">&quot;FichierHDF<sp/>needs<sp/>HDF<sp/>(so<sp/>MED)<sp/>to<sp/>be<sp/>used!&quot;</highlight><highlight class="normal"><sp/>&lt;&lt;<sp/>finl;</highlight></codeline>
<codeline lineno="24"><highlight class="normal"><sp/><sp/><ref refid="classProcess_1acc2fbbe761e08e5870ae605c0705491c" kindref="member">Process::exit</ref>(-1);</highlight></codeline>
<codeline lineno="25"><highlight class="normal">}</highlight></codeline>
<codeline lineno="26" refid="classFichierHDF_1ab680851f981677ee033f22f7b6bb4d1f" refkind="member"><highlight class="normal"><ref refid="classFichierHDF_1ab680851f981677ee033f22f7b6bb4d1f" kindref="member">FichierHDF::~FichierHDF</ref>()<sp/>{}</highlight></codeline>
<codeline lineno="27"><highlight class="normal"></highlight></codeline>
<codeline lineno="28" refid="classFichierHDF_1ae8d1c1444d9d7ac5d0bef32feaa050df" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="classFichierHDF_1ae8d1c1444d9d7ac5d0bef32feaa050df" kindref="member">FichierHDF::create</ref>(<ref refid="classNom" kindref="compound">Nom</ref><sp/>filename)<sp/>{}</highlight></codeline>
<codeline lineno="29" refid="classFichierHDF_1a55803f961da3af25680be6cec26e85ec" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="classFichierHDF_1a55803f961da3af25680be6cec26e85ec" kindref="member">FichierHDF::open</ref>(<ref refid="classNom" kindref="compound">Nom</ref><sp/>filename,<sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>readOnly)<sp/>{}</highlight></codeline>
<codeline lineno="30" refid="classFichierHDF_1ac5d8eb389ee60109c2d60029f442487f" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="classFichierHDF_1ac5d8eb389ee60109c2d60029f442487f" kindref="member">FichierHDF::close</ref>()<sp/>{}</highlight></codeline>
<codeline lineno="31"><highlight class="normal"></highlight></codeline>
<codeline lineno="32" refid="classFichierHDF_1a25d4709e6498f901d7624c01306f3def" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="classFichierHDF_1a25d4709e6498f901d7624c01306f3def" kindref="member">FichierHDF::create_and_fill_dataset_MW</ref>(<ref refid="classNom" kindref="compound">Nom</ref><sp/>dataset_basename,<sp/><ref refid="classSortie__Brute" kindref="compound">Sortie_Brute</ref>&amp;<sp/>sortie)<sp/>{}</highlight></codeline>
<codeline lineno="33" refid="classFichierHDF_1a318cc4c44e8d8e24fa4b457e378308b8" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="classFichierHDF_1a25d4709e6498f901d7624c01306f3def" kindref="member">FichierHDF::create_and_fill_dataset_MW</ref>(<ref refid="classNom" kindref="compound">Nom</ref><sp/>dataset_basename,<sp/><ref refid="classSChaine" kindref="compound">SChaine</ref>&amp;<sp/>sortie)<sp/>{}</highlight></codeline>
<codeline lineno="34" refid="classFichierHDF_1a7ba14e3b21aaca1de6d4473ccd3a5a66" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="classFichierHDF_1a7ba14e3b21aaca1de6d4473ccd3a5a66" kindref="member">FichierHDF::create_and_fill_dataset_SW</ref>(<ref refid="classNom" kindref="compound">Nom</ref><sp/>datasetname,<sp/><ref refid="classSortie__Brute" kindref="compound">Sortie_Brute</ref>&amp;<sp/>sortie)<sp/>{}</highlight></codeline>
<codeline lineno="35" refid="classFichierHDF_1a4a6063ebd4afc5bac8d24f4ceb60bf62" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="classFichierHDF_1a4a6063ebd4afc5bac8d24f4ceb60bf62" kindref="member">FichierHDF::fill_dataset</ref>(<ref refid="classNom" kindref="compound">Nom</ref><sp/>dataset_name,<sp/><ref refid="classSortie__Brute" kindref="compound">Sortie_Brute</ref>&amp;<sp/>sortie)<sp/>{}</highlight></codeline>
<codeline lineno="36"><highlight class="normal"></highlight></codeline>
<codeline lineno="37" refid="classFichierHDF_1a4b1e63bb02aebe3cd085af22cdd870af" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="classFichierHDF_1a4b1e63bb02aebe3cd085af22cdd870af" kindref="member">FichierHDF::read_dataset</ref>(<ref refid="classNom" kindref="compound">Nom</ref><sp/>dataset_basename,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>proc_rank,<sp/><ref refid="classEntree__Brute" kindref="compound">Entree_Brute</ref>&amp;<sp/>entree)<sp/>{}</highlight></codeline>
<codeline lineno="38"><highlight class="normal"></highlight></codeline>
<codeline lineno="39" refid="classFichierHDF_1a5731b503f5e1472ad9ab934f759dcf7b" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/><ref refid="classFichierHDF_1a5731b503f5e1472ad9ab934f759dcf7b" kindref="member">FichierHDF::exists</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal">*<sp/>dataset_name)</highlight></codeline>
<codeline lineno="40"><highlight class="normal">{</highlight></codeline>
<codeline lineno="41"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="42"><highlight class="normal">}</highlight></codeline>
<codeline lineno="43" refid="classFichierHDF_1a0ad22bc624e64d0fecd33abb64b4881a" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/><ref refid="classFichierHDF_1a0ad22bc624e64d0fecd33abb64b4881a" kindref="member">FichierHDF::is_hdf5</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>*file_name)</highlight></codeline>
<codeline lineno="44"><highlight class="normal">{</highlight></codeline>
<codeline lineno="45"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="46"><highlight class="normal">}</highlight></codeline>
<codeline lineno="47"><highlight class="normal"></highlight></codeline>
<codeline lineno="48" refid="classFichierHDF_1a400d8db992340b6e5f4a0379e87ce560" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="classFichierHDF_1a400d8db992340b6e5f4a0379e87ce560" kindref="member">FichierHDF::prepare_file_props</ref>()<sp/>{}</highlight></codeline>
<codeline lineno="49" refid="classFichierHDF_1a8251a110f8aedee5695532706ebc2b4b" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="classFichierHDF_1a8251a110f8aedee5695532706ebc2b4b" kindref="member">FichierHDF::prepare_dataset_props</ref>()<sp/>{}</highlight></codeline>
<codeline lineno="50"><highlight class="normal"></highlight><highlight class="preprocessor">#else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="51"><highlight class="normal"></highlight></codeline>
<codeline lineno="52"><highlight class="normal"></highlight></codeline>
<codeline lineno="53"><highlight class="normal"></highlight><highlight class="keyword">template</highlight><highlight class="normal">&lt;</highlight><highlight class="keyword">typename</highlight><highlight class="normal"><sp/>T&gt;</highlight></codeline>
<codeline lineno="54"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">inline</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>hdf5_error(T<sp/>status)</highlight></codeline>
<codeline lineno="55"><highlight class="normal">{</highlight></codeline>
<codeline lineno="56"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(status<sp/>&lt;0)</highlight></codeline>
<codeline lineno="57"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="58"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>Cerr<sp/>&lt;&lt;<sp/></highlight><highlight class="stringliteral">&quot;HDF5<sp/>error<sp/>occured<sp/>-<sp/>exiting&quot;</highlight><highlight class="normal"><sp/>&lt;&lt;<sp/>finl;</highlight></codeline>
<codeline lineno="59"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classProcess_1acc2fbbe761e08e5870ae605c0705491c" kindref="member">Process::exit</ref>();</highlight></codeline>
<codeline lineno="60"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="61"><highlight class="normal">}</highlight></codeline>
<codeline lineno="62"><highlight class="normal"></highlight></codeline>
<codeline lineno="63"><highlight class="normal"><ref refid="classFichierHDF_1ac43702178467435cbdef199bc28a5fa9" kindref="member">FichierHDF::FichierHDF</ref>():<sp/><sp/>file_id_(0),<sp/>file_access_plst_(0),</highlight></codeline>
<codeline lineno="64"><highlight class="normal"><sp/><sp/>dataset_transfer_plst_(0)<sp/>{}</highlight></codeline>
<codeline lineno="65"><highlight class="normal"></highlight></codeline>
<codeline lineno="66"><highlight class="normal"><ref refid="classFichierHDF_1ab680851f981677ee033f22f7b6bb4d1f" kindref="member">FichierHDF::~FichierHDF</ref>()</highlight></codeline>
<codeline lineno="67"><highlight class="normal">{</highlight></codeline>
<codeline lineno="68"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//close();</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="69"><highlight class="normal">}</highlight></codeline>
<codeline lineno="70"><highlight class="normal"></highlight></codeline>
<codeline lineno="71"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="classFichierHDF_1ae8d1c1444d9d7ac5d0bef32feaa050df" kindref="member">FichierHDF::create</ref>(<ref refid="classNom" kindref="compound">Nom</ref><sp/>filename)</highlight></codeline>
<codeline lineno="72"><highlight class="normal">{</highlight></codeline>
<codeline lineno="73"><highlight class="normal"><sp/><sp/><ref refid="classFichierHDF_1a400d8db992340b6e5f4a0379e87ce560" kindref="member">prepare_file_props</ref>();</highlight></codeline>
<codeline lineno="74"><highlight class="normal"><sp/><sp/>file_id_<sp/>=<sp/>H5Fcreate(filename,<sp/>H5F_ACC_TRUNC<sp/></highlight><highlight class="comment">/*H5F_ACC_EXCL*/</highlight><highlight class="normal">,<sp/>H5P_DEFAULT,<sp/>file_access_plst_);</highlight></codeline>
<codeline lineno="75"><highlight class="normal"><sp/><sp/>hdf5_error&lt;hid_t&gt;(file_id_);</highlight></codeline>
<codeline lineno="76"><highlight class="normal"><sp/><sp/>Cerr<sp/>&lt;&lt;<sp/></highlight><highlight class="stringliteral">&quot;HDF5<sp/>&quot;</highlight><highlight class="normal"><sp/>&lt;&lt;<sp/>filename<sp/>&lt;&lt;<sp/></highlight><highlight class="stringliteral">&quot;<sp/>file<sp/>created<sp/>!&quot;</highlight><highlight class="normal"><sp/>&lt;&lt;<sp/>finl;</highlight></codeline>
<codeline lineno="77"><highlight class="normal"><sp/><sp/><ref refid="classFichierHDF_1a7d5bffb599ec7d2053ca95b3aeb23a2f" kindref="member">set_int_size</ref>();</highlight></codeline>
<codeline lineno="78"><highlight class="normal">}</highlight></codeline>
<codeline lineno="79"><highlight class="normal"></highlight></codeline>
<codeline lineno="80"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="classFichierHDF_1a55803f961da3af25680be6cec26e85ec" kindref="member">FichierHDF::open</ref>(<ref refid="classNom" kindref="compound">Nom</ref><sp/>filename,<sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>readOnly)</highlight></codeline>
<codeline lineno="81"><highlight class="normal">{</highlight></codeline>
<codeline lineno="82"><highlight class="normal"><sp/><sp/><ref refid="classFichierHDF_1a400d8db992340b6e5f4a0379e87ce560" kindref="member">prepare_file_props</ref>();</highlight></codeline>
<codeline lineno="83"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">unsigned</highlight><highlight class="normal"><sp/>st<sp/>=<sp/>readOnly<sp/>?<sp/>H5F_ACC_RDONLY<sp/>:<sp/>H5F_ACC_RDWR;</highlight></codeline>
<codeline lineno="84"><highlight class="normal"><sp/><sp/>file_id_<sp/>=<sp/>H5Fopen(filename,<sp/>st,<sp/>file_access_plst_);</highlight></codeline>
<codeline lineno="85"><highlight class="normal"><sp/><sp/>hdf5_error&lt;hid_t&gt;(file_id_);</highlight></codeline>
<codeline lineno="86"><highlight class="normal"><sp/><sp/>Cerr<sp/>&lt;&lt;<sp/></highlight><highlight class="stringliteral">&quot;HDF5<sp/>&quot;</highlight><highlight class="normal"><sp/>&lt;&lt;<sp/>filename<sp/>&lt;&lt;<sp/></highlight><highlight class="stringliteral">&quot;<sp/>file<sp/>opened<sp/>!&quot;</highlight><highlight class="normal"><sp/>&lt;&lt;<sp/>finl;</highlight></codeline>
<codeline lineno="87"><highlight class="normal"><sp/><sp/><ref refid="classFichierHDF_1a0871fd1d5218ab377e48f4d69f34e092" kindref="member">check_int_size</ref>(filename);</highlight></codeline>
<codeline lineno="88"><highlight class="normal">}</highlight></codeline>
<codeline lineno="89"><highlight class="normal"></highlight></codeline>
<codeline lineno="90"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="classFichierHDF_1a400d8db992340b6e5f4a0379e87ce560" kindref="member">FichierHDF::prepare_file_props</ref>()</highlight></codeline>
<codeline lineno="91"><highlight class="normal">{</highlight></codeline>
<codeline lineno="92"><highlight class="normal"><sp/><sp/>file_access_plst_<sp/>=<sp/>H5Pcreate(H5P_FILE_ACCESS);</highlight></codeline>
<codeline lineno="93"><highlight class="normal"></highlight></codeline>
<codeline lineno="94"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//increasing<sp/>size<sp/>of<sp/>the<sp/>B-tree<sp/>containing<sp/>metadata<sp/>info<sp/>(to<sp/>approximately<sp/>match<sp/>the<sp/>size<sp/>striping)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="95"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//useful<sp/>when<sp/>we<sp/>are<sp/>writing<sp/>a<sp/>lot<sp/>of<sp/>chunks</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="96"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>see<sp/>https://www.nersc.gov/users/training/online-tutorials/introduction-to-scientific-i-o/?show_all=1</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="97"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>file_creation_plst_<sp/>=<sp/>H5Pcreate(H5P_FILE_CREATE);</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="98"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>hsize_t<sp/>btree_ik<sp/>=<sp/>(stripe_size<sp/>-<sp/>4096)<sp/>/<sp/>96;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="99"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>H5Pset_istore_k(file_creation_plst_,<sp/>btree_ik);</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="100"><highlight class="normal">}</highlight></codeline>
<codeline lineno="101"><highlight class="normal"></highlight></codeline>
<codeline lineno="102"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="classFichierHDF_1a8251a110f8aedee5695532706ebc2b4b" kindref="member">FichierHDF::prepare_dataset_props</ref>()</highlight></codeline>
<codeline lineno="103"><highlight class="normal">{</highlight></codeline>
<codeline lineno="104"><highlight class="normal"><sp/><sp/>dataset_transfer_plst_<sp/>=<sp/>H5Pcreate(H5P_DATASET_XFER);</highlight></codeline>
<codeline lineno="105"><highlight class="normal">}</highlight></codeline>
<codeline lineno="106"><highlight class="normal"></highlight></codeline>
<codeline lineno="107"><highlight class="normal"></highlight></codeline>
<codeline lineno="108"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="classFichierHDF_1ac5d8eb389ee60109c2d60029f442487f" kindref="member">FichierHDF::close</ref>()</highlight></codeline>
<codeline lineno="109"><highlight class="normal">{</highlight></codeline>
<codeline lineno="110"><highlight class="normal"><sp/><sp/>Cerr<sp/>&lt;&lt;<sp/></highlight><highlight class="stringliteral">&quot;[HDF5]<sp/>closing<sp/>file...&quot;</highlight><highlight class="normal"><sp/>&lt;&lt;<sp/>finl;</highlight></codeline>
<codeline lineno="111"><highlight class="normal"></highlight></codeline>
<codeline lineno="112"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//getting<sp/>file<sp/>name</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="113"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>filename[100];</highlight></codeline>
<codeline lineno="114"><highlight class="normal"><sp/><sp/>H5Fget_name(file_id_,<sp/>filename,<sp/>100);</highlight></codeline>
<codeline lineno="115"><highlight class="normal"></highlight></codeline>
<codeline lineno="116"><highlight class="normal"><sp/><sp/>H5Fclose(file_id_);</highlight></codeline>
<codeline lineno="117"><highlight class="normal"></highlight></codeline>
<codeline lineno="118"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(file_access_plst_)<sp/><sp/><sp/><sp/>H5Pclose(file_access_plst_);</highlight></codeline>
<codeline lineno="119"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(dataset_transfer_plst_)<sp/>H5Pclose(dataset_transfer_plst_);</highlight></codeline>
<codeline lineno="120"><highlight class="normal"><sp/><sp/>Cerr<sp/>&lt;&lt;<sp/></highlight><highlight class="stringliteral">&quot;HDF5<sp/>&quot;</highlight><highlight class="normal"><sp/>&lt;&lt;<sp/>filename<sp/>&lt;&lt;<sp/></highlight><highlight class="stringliteral">&quot;<sp/>file<sp/>closed<sp/>!&quot;</highlight><highlight class="normal"><sp/>&lt;&lt;<sp/>finl;</highlight></codeline>
<codeline lineno="121"><highlight class="normal"></highlight></codeline>
<codeline lineno="122"><highlight class="normal">}</highlight></codeline>
<codeline lineno="123"><highlight class="normal"></highlight></codeline>
<codeline lineno="124"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="classFichierHDF_1a4b1e63bb02aebe3cd085af22cdd870af" kindref="member">FichierHDF::read_dataset</ref>(<ref refid="classNom" kindref="compound">Nom</ref><sp/>dataset_basename,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>proc_rank,<sp/><ref refid="classEntree__Brute" kindref="compound">Entree_Brute</ref>&amp;<sp/>entree)</highlight></codeline>
<codeline lineno="125"><highlight class="normal">{</highlight></codeline>
<codeline lineno="126"><highlight class="normal"><sp/><sp/><ref refid="classFichierHDF_1a8251a110f8aedee5695532706ebc2b4b" kindref="member">prepare_dataset_props</ref>();</highlight></codeline>
<codeline lineno="127"><highlight class="normal"></highlight></codeline>
<codeline lineno="128"><highlight class="normal"><sp/><sp/><ref refid="classNom" kindref="compound">Nom</ref><sp/>dataset_name<sp/>=<sp/>dataset_basename;</highlight></codeline>
<codeline lineno="129"><highlight class="normal"><sp/><sp/>dataset_name<sp/>=<sp/>dataset_name.<ref refid="classNom_1a67b66f01988827cce6bf1f108b850bda" kindref="member">nom_me</ref>(proc_rank,<sp/>0,<sp/>1<sp/></highlight><highlight class="comment">/*without_padding*/</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="130"><highlight class="normal"></highlight></codeline>
<codeline lineno="131"><highlight class="normal"><sp/><sp/>hid_t<sp/>dataset_id<sp/>=<sp/>H5Dopen2(file_id_,<sp/>dataset_name,<sp/>H5P_DEFAULT);</highlight></codeline>
<codeline lineno="132"><highlight class="normal"><sp/><sp/>hid_t<sp/>dataspace_id<sp/>=<sp/><sp/>H5Dget_space(dataset_id);</highlight></codeline>
<codeline lineno="133"><highlight class="normal"><sp/><sp/>hssize_t<sp/>sz<sp/>=<sp/>H5Sget_simple_extent_npoints(dataspace_id);</highlight></codeline>
<codeline lineno="134"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>*<sp/>dset_data<sp/>=<sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal">[sz];</highlight></codeline>
<codeline lineno="135"><highlight class="normal"><sp/><sp/>Cerr<sp/>&lt;&lt;<sp/></highlight><highlight class="stringliteral">&quot;[HDF5]<sp/>Reading<sp/>into<sp/>HDF<sp/>dataset<sp/>&quot;</highlight><highlight class="normal"><sp/>&lt;&lt;<sp/>dataset_name<sp/>&lt;&lt;<sp/></highlight><highlight class="stringliteral">&quot;...&quot;</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="136"><highlight class="normal"><sp/><sp/>H5Dread(dataset_id,<sp/>H5T_NATIVE_OPAQUE,<sp/>H5S_ALL,<sp/>H5S_ALL,<sp/>dataset_transfer_plst_,<sp/>dset_data);</highlight></codeline>
<codeline lineno="137"><highlight class="normal"><sp/><sp/>Cerr<sp/>&lt;&lt;<sp/></highlight><highlight class="stringliteral">&quot;<sp/>Done<sp/>!&quot;</highlight><highlight class="normal"><sp/>&lt;&lt;<sp/>finl;</highlight></codeline>
<codeline lineno="138"><highlight class="normal"></highlight></codeline>
<codeline lineno="139"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>Put<sp/>extracted<sp/>data<sp/>in<sp/>a<sp/>standard<sp/>Entree_Brute<sp/>from<sp/>TRUST,<sp/>that<sp/>we<sp/>then<sp/>use<sp/>to<sp/>feed<sp/>TRUST<sp/>objects</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="140"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(is_different_int_size_)</highlight></codeline>
<codeline lineno="141"><highlight class="normal"></highlight><highlight class="preprocessor">#ifdef<sp/>INT_is_64_</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="142"><highlight class="normal"><sp/><sp/><sp/><sp/>entree.<ref refid="classAbstractIO_1af6e5d6749ee060cd9b6a3ab5906d473b" kindref="member">set_64b</ref>(</highlight><highlight class="keyword">false</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="143"><highlight class="normal"></highlight><highlight class="preprocessor">#else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="144"><highlight class="normal"><sp/><sp/><sp/><sp/>entree.<ref refid="classAbstractIO_1af6e5d6749ee060cd9b6a3ab5906d473b" kindref="member">set_64b</ref>(</highlight><highlight class="keyword">true</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="145"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="146"><highlight class="normal"><sp/><sp/>entree.<ref refid="classEntree__Brute_1ae1857b40f712d9cf5ba958143ae2a693" kindref="member">set_data</ref>(dset_data,<sp/>(</highlight><highlight class="keywordtype">unsigned</highlight><highlight class="normal">)<sp/>sz);<sp/><sp/></highlight><highlight class="comment">//<sp/>data<sp/>are<sp/>copied<sp/>into<sp/>the<sp/>Entree</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="147"><highlight class="normal"></highlight></codeline>
<codeline lineno="148"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">delete</highlight><highlight class="normal">[]<sp/>dset_data;</highlight></codeline>
<codeline lineno="149"><highlight class="normal"><sp/><sp/>H5Dclose(dataset_id);</highlight></codeline>
<codeline lineno="150"><highlight class="normal"><sp/><sp/>H5Sclose(dataspace_id);</highlight></codeline>
<codeline lineno="151"><highlight class="normal"></highlight></codeline>
<codeline lineno="152"><highlight class="normal">}</highlight></codeline>
<codeline lineno="153"><highlight class="normal"></highlight></codeline>
<codeline lineno="154"><highlight class="normal"></highlight></codeline>
<codeline lineno="155"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="classFichierHDF_1aa7a6c082401ad61f9db752a783de8ccf" kindref="member">FichierHDF::create_datasets</ref>(<ref refid="classNoms" kindref="compound">Noms</ref><sp/>dataset_names,<sp/>hsize_t<sp/>length)</highlight></codeline>
<codeline lineno="156"><highlight class="normal">{</highlight></codeline>
<codeline lineno="157"><highlight class="normal"><sp/><sp/>hid_t<sp/>dataspace_id<sp/>=<sp/>H5Screate_simple(1,<sp/>&amp;length,<sp/></highlight><highlight class="keyword">nullptr</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="158"><highlight class="normal"></highlight></codeline>
<codeline lineno="159"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>Create<sp/>the<sp/>dataset</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="160"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal">(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>i=0;<sp/>i&lt;dataset_names.size();<sp/>i++)</highlight></codeline>
<codeline lineno="161"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="162"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classNom" kindref="compound">Nom</ref><sp/>dataset_name<sp/>=<sp/>dataset_names[i];</highlight></codeline>
<codeline lineno="163"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>hid_t<sp/>dataset_id<sp/>=<sp/>H5Dcreate2(file_id_,<sp/>dataset_name,<sp/>H5T_NATIVE_OPAQUE,<sp/>dataspace_id,<sp/>H5P_DEFAULT,<sp/>H5P_DEFAULT,<sp/>H5P_DEFAULT);</highlight></codeline>
<codeline lineno="164"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>hdf5_error&lt;herr_t&gt;(H5Dclose(dataset_id));</highlight></codeline>
<codeline lineno="165"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="166"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>Close<sp/>dataset<sp/>and<sp/>dataspace</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="167"><highlight class="normal"><sp/><sp/>hdf5_error&lt;herr_t&gt;(H5Sclose(dataspace_id));</highlight></codeline>
<codeline lineno="168"><highlight class="normal"></highlight></codeline>
<codeline lineno="169"><highlight class="normal"><sp/><sp/>Cerr<sp/>&lt;&lt;<sp/></highlight><highlight class="stringliteral">&quot;[HDF5]<sp/>All<sp/>datasets<sp/>created<sp/>!&quot;</highlight><highlight class="normal"><sp/>&lt;&lt;<sp/>finl;</highlight></codeline>
<codeline lineno="170"><highlight class="normal">}</highlight></codeline>
<codeline lineno="171"><highlight class="normal"></highlight></codeline>
<codeline lineno="172"><highlight class="normal"></highlight></codeline>
<codeline lineno="173"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="classFichierHDF_1a4a6063ebd4afc5bac8d24f4ceb60bf62" kindref="member">FichierHDF::fill_dataset</ref>(<ref refid="classNom" kindref="compound">Nom</ref><sp/>dataset_name,<sp/><ref refid="classSortie__Brute" kindref="compound">Sortie_Brute</ref>&amp;<sp/>sortie)</highlight></codeline>
<codeline lineno="174"><highlight class="normal">{</highlight></codeline>
<codeline lineno="175"><highlight class="normal"><sp/><sp/><ref refid="classFichierHDF_1a8251a110f8aedee5695532706ebc2b4b" kindref="member">prepare_dataset_props</ref>();</highlight></codeline>
<codeline lineno="176"><highlight class="normal"></highlight></codeline>
<codeline lineno="177"><highlight class="normal"><sp/><sp/>hsize_t<sp/>lenData<sp/>=<sp/>sortie.<ref refid="classSortie__Brute_1a5429279d5f058f3fa8cb1891ab8fe644" kindref="member">get_size</ref>();</highlight></codeline>
<codeline lineno="178"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>*<sp/>data<sp/>=<sp/>sortie.<ref refid="classSortie__Brute_1a8c671dadd57fdfc806023b4bf9413a6f" kindref="member">get_data</ref>();</highlight></codeline>
<codeline lineno="179"><highlight class="normal"></highlight></codeline>
<codeline lineno="180"><highlight class="normal"><sp/><sp/>hsize_t<sp/>dims[1]<sp/>=<sp/>{lenData};</highlight></codeline>
<codeline lineno="181"><highlight class="normal"><sp/><sp/>hid_t<sp/>dataspace_id<sp/>=<sp/>H5Screate_simple(1,<sp/>dims,<sp/></highlight><highlight class="keyword">nullptr</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="182"><highlight class="normal"></highlight></codeline>
<codeline lineno="183"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>Open<sp/>the<sp/>dataset</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="184"><highlight class="normal"><sp/><sp/>hid_t<sp/>dataset_id<sp/>=<sp/>H5Dopen2(file_id_,<sp/>dataset_name,<sp/>H5P_DEFAULT);</highlight></codeline>
<codeline lineno="185"><highlight class="normal"><sp/><sp/>hdf5_error&lt;hid_t&gt;(dataset_id<sp/>);</highlight></codeline>
<codeline lineno="186"><highlight class="normal"></highlight></codeline>
<codeline lineno="187"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>Writing<sp/>into<sp/>it:</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="188"><highlight class="normal"><sp/><sp/>Cerr<sp/>&lt;&lt;<sp/></highlight><highlight class="stringliteral">&quot;[HDF5]<sp/>Writing<sp/>into<sp/>HDF<sp/>dataset<sp/>&quot;</highlight><highlight class="normal"><sp/>&lt;&lt;<sp/>dataset_name<sp/>&lt;&lt;<sp/></highlight><highlight class="stringliteral">&quot;...&quot;</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="189"><highlight class="normal"><sp/><sp/>hdf5_error&lt;herr_t&gt;(H5Dwrite(dataset_id,<sp/>H5T_NATIVE_OPAQUE,<sp/>H5S_ALL,<sp/>dataspace_id,<sp/>dataset_transfer_plst_,<sp/>data));</highlight></codeline>
<codeline lineno="190"><highlight class="normal"><sp/><sp/>Cerr<sp/>&lt;&lt;<sp/></highlight><highlight class="stringliteral">&quot;<sp/>Done<sp/>!&quot;</highlight><highlight class="normal"><sp/>&lt;&lt;<sp/>finl;</highlight></codeline>
<codeline lineno="191"><highlight class="normal"></highlight></codeline>
<codeline lineno="192"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>Close<sp/>dataset<sp/>and<sp/>dataspace</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="193"><highlight class="normal"><sp/><sp/>hdf5_error&lt;herr_t&gt;(H5Dclose(dataset_id));</highlight></codeline>
<codeline lineno="194"><highlight class="normal"><sp/><sp/>hdf5_error&lt;herr_t&gt;(H5Sclose(dataspace_id));</highlight></codeline>
<codeline lineno="195"><highlight class="normal"></highlight></codeline>
<codeline lineno="196"><highlight class="normal">}</highlight></codeline>
<codeline lineno="197"><highlight class="normal"></highlight></codeline>
<codeline lineno="198"><highlight class="normal"></highlight></codeline>
<codeline lineno="199"><highlight class="normal"></highlight></codeline>
<codeline lineno="200"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="classFichierHDF_1a25d4709e6498f901d7624c01306f3def" kindref="member">FichierHDF::create_and_fill_dataset_MW</ref>(<ref refid="classNom" kindref="compound">Nom</ref><sp/>dataset_basename,<sp/><ref refid="classSortie__Brute" kindref="compound">Sortie_Brute</ref>&amp;<sp/>sortie)</highlight></codeline>
<codeline lineno="201"><highlight class="normal">{</highlight></codeline>
<codeline lineno="202"><highlight class="normal"><sp/><sp/>hsize_t<sp/>lenData<sp/>=<sp/>sortie.<ref refid="classSortie__Brute_1a5429279d5f058f3fa8cb1891ab8fe644" kindref="member">get_size</ref>();</highlight></codeline>
<codeline lineno="203"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>*<sp/>data<sp/>=<sp/>sortie.<ref refid="classSortie__Brute_1a8c671dadd57fdfc806023b4bf9413a6f" kindref="member">get_data</ref>();</highlight></codeline>
<codeline lineno="204"><highlight class="normal"></highlight></codeline>
<codeline lineno="205"><highlight class="normal"><sp/><sp/><ref refid="classFichierHDF_1a25d4709e6498f901d7624c01306f3def" kindref="member">create_and_fill_dataset_MW</ref>(dataset_basename,<sp/>data,<sp/>lenData,<sp/>H5T_NATIVE_OPAQUE);</highlight></codeline>
<codeline lineno="206"><highlight class="normal">}</highlight></codeline>
<codeline lineno="207"><highlight class="normal"></highlight></codeline>
<codeline lineno="208"><highlight class="normal"></highlight></codeline>
<codeline lineno="209"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="classFichierHDF_1a25d4709e6498f901d7624c01306f3def" kindref="member">FichierHDF::create_and_fill_dataset_MW</ref>(<ref refid="classNom" kindref="compound">Nom</ref><sp/>dataset_basename,<sp/><ref refid="classSChaine" kindref="compound">SChaine</ref>&amp;<sp/>sortie)</highlight></codeline>
<codeline lineno="210"><highlight class="normal">{</highlight></codeline>
<codeline lineno="211"><highlight class="normal"><sp/><sp/>hsize_t<sp/>lenData<sp/>=<sp/>sortie.<ref refid="classSChaine_1a44cc86f71761104ba5d2f940dd58d5d7" kindref="member">get_size</ref>();</highlight></codeline>
<codeline lineno="212"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>*<sp/>data<sp/>=<sp/>sortie.<ref refid="classSChaine_1a328b5a25ca0f229dd8d014ee98ee7f1d" kindref="member">get_str</ref>();</highlight></codeline>
<codeline lineno="213"><highlight class="normal"></highlight></codeline>
<codeline lineno="214"><highlight class="normal"><sp/><sp/><ref refid="classFichierHDF_1a25d4709e6498f901d7624c01306f3def" kindref="member">create_and_fill_dataset_MW</ref>(dataset_basename,<sp/>data,<sp/>lenData,<sp/>H5T_C_S1);</highlight></codeline>
<codeline lineno="215"><highlight class="normal">}</highlight></codeline>
<codeline lineno="216"><highlight class="normal"></highlight></codeline>
<codeline lineno="217"><highlight class="normal"></highlight></codeline>
<codeline lineno="218"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="classFichierHDF_1a25d4709e6498f901d7624c01306f3def" kindref="member">FichierHDF::create_and_fill_dataset_MW</ref>(<ref refid="classNom" kindref="compound">Nom</ref><sp/>dataset_basename,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal">*<sp/>data,<sp/>hsize_t<sp/>lenData,<sp/>hid_t<sp/>datatype)</highlight></codeline>
<codeline lineno="219"><highlight class="normal">{</highlight></codeline>
<codeline lineno="220"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//collecting<sp/>the<sp/>lengths<sp/>of<sp/>the<sp/>datasets<sp/>from<sp/>every<sp/>other<sp/>processors</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="221"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">long</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">long</highlight><highlight class="normal"><sp/>init_value<sp/>=<sp/>lenData;</highlight></codeline>
<codeline lineno="222"><highlight class="normal"><sp/><sp/>std::vector&lt;long<sp/>long&gt;<sp/>datasets_len(<ref refid="classProcess_1a6bf692ce58d9578aa62ac3c07b8caaa1" kindref="member">Process::nproc</ref>(),<sp/>init_value);</highlight></codeline>
<codeline lineno="223"><highlight class="normal"><sp/><sp/>envoyer_all_to_all(datasets_len,<sp/>datasets_len);</highlight></codeline>
<codeline lineno="224"><highlight class="normal"></highlight></codeline>
<codeline lineno="225"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>Creating<sp/>the<sp/>datasets<sp/>from<sp/>every<sp/>processor</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="226"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>(metadata<sp/>have<sp/>to<sp/>be<sp/>written<sp/>collectively)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="227"><highlight class="normal"><sp/><sp/>std::vector&lt;hid_t&gt;<sp/>datasets_id(<ref refid="classProcess_1a6bf692ce58d9578aa62ac3c07b8caaa1" kindref="member">Process::nproc</ref>());</highlight></codeline>
<codeline lineno="228"><highlight class="normal"><sp/><sp/><ref refid="classNom" kindref="compound">Nom</ref><sp/>my_dataset_name;</highlight></codeline>
<codeline lineno="229"><highlight class="normal"></highlight></codeline>
<codeline lineno="230"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal">(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>p<sp/>=<sp/>0;<sp/>p<sp/>&lt;<sp/><ref refid="classProcess_1a6bf692ce58d9578aa62ac3c07b8caaa1" kindref="member">Process::nproc</ref>();<sp/>p++)</highlight></codeline>
<codeline lineno="231"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="232"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classNom" kindref="compound">Nom</ref><sp/>dname<sp/>=<sp/>dataset_basename;</highlight></codeline>
<codeline lineno="233"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>dname<sp/>=<sp/>dname.<ref refid="classNom_1a67b66f01988827cce6bf1f108b850bda" kindref="member">nom_me</ref>(p,<sp/>0,<sp/>1<sp/></highlight><highlight class="comment">/*without_padding*/</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="234"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(p<sp/>==<sp/><ref refid="classProcess_1ab55ba07167ec807ed3a145cac0f5dca4" kindref="member">Process::me</ref>())<sp/>my_dataset_name<sp/>=<sp/>dname;</highlight></codeline>
<codeline lineno="235"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>hsize_t<sp/>dlen=<sp/>datasets_len[p];</highlight></codeline>
<codeline lineno="236"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>hid_t<sp/>dspace<sp/>=<sp/>H5Screate_simple(1,<sp/>&amp;dlen,<sp/></highlight><highlight class="keyword">nullptr</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="237"><highlight class="normal"></highlight></codeline>
<codeline lineno="238"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>datasets_id[p]<sp/>=<sp/>H5Dcreate2(file_id_,<sp/>dname,<sp/>datatype,<sp/>dspace,</highlight></codeline>
<codeline lineno="239"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>H5P_DEFAULT,<sp/>H5P_DEFAULT,<sp/>H5P_DEFAULT<sp/>);</highlight></codeline>
<codeline lineno="240"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>H5Sclose(dspace);</highlight></codeline>
<codeline lineno="241"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="242"><highlight class="normal"></highlight></codeline>
<codeline lineno="243"><highlight class="normal"><sp/><sp/>Cerr<sp/>&lt;&lt;<sp/></highlight><highlight class="stringliteral">&quot;[HDF5]<sp/>All<sp/>datasets<sp/>created<sp/>!&quot;</highlight><highlight class="normal"><sp/>&lt;&lt;<sp/>finl;</highlight></codeline>
<codeline lineno="244"><highlight class="normal"></highlight></codeline>
<codeline lineno="245"><highlight class="normal"><sp/><sp/>hid_t<sp/>dataspace_id<sp/>=<sp/>H5Screate_simple(1,<sp/>&amp;lenData,<sp/></highlight><highlight class="keyword">nullptr</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="246"><highlight class="normal"></highlight></codeline>
<codeline lineno="247"><highlight class="normal"><sp/><sp/>Cerr<sp/>&lt;&lt;<sp/></highlight><highlight class="stringliteral">&quot;[HDF5]<sp/>Writing<sp/>into<sp/>HDF<sp/>dataset<sp/>&quot;</highlight><highlight class="normal"><sp/>&lt;&lt;<sp/>my_dataset_name<sp/>&lt;&lt;<sp/></highlight><highlight class="stringliteral">&quot;...&quot;</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="248"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>Writing<sp/>my<sp/>own<sp/>dataset</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="249"><highlight class="normal"><sp/><sp/>H5Dwrite(datasets_id[<ref refid="classProcess_1ab55ba07167ec807ed3a145cac0f5dca4" kindref="member">Process::me</ref>()],<sp/>datatype,<sp/>dataspace_id,<sp/>H5S_ALL,<sp/>dataset_transfer_plst_,<sp/>data);</highlight></codeline>
<codeline lineno="250"><highlight class="normal"><sp/><sp/>Cerr<sp/>&lt;&lt;<sp/></highlight><highlight class="stringliteral">&quot;<sp/>Dataset<sp/>written<sp/>!&quot;</highlight><highlight class="normal"><sp/>&lt;&lt;<sp/>finl;</highlight></codeline>
<codeline lineno="251"><highlight class="normal"></highlight></codeline>
<codeline lineno="252"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>Close<sp/>dataset<sp/>and<sp/>dataspace</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="253"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal">(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>p<sp/>=<sp/>0;<sp/>p<sp/>&lt;<sp/><ref refid="classProcess_1a6bf692ce58d9578aa62ac3c07b8caaa1" kindref="member">Process::nproc</ref>();<sp/>p++)</highlight></codeline>
<codeline lineno="254"><highlight class="normal"><sp/><sp/><sp/><sp/>H5Dclose(datasets_id[p]);</highlight></codeline>
<codeline lineno="255"><highlight class="normal"><sp/><sp/>Cerr<sp/>&lt;&lt;<sp/></highlight><highlight class="stringliteral">&quot;[HDF5]<sp/>All<sp/>datasets<sp/>closed<sp/>!&quot;</highlight><highlight class="normal"><sp/>&lt;&lt;<sp/>finl;</highlight></codeline>
<codeline lineno="256"><highlight class="normal"></highlight></codeline>
<codeline lineno="257"><highlight class="normal"><sp/><sp/>H5Sclose(dataspace_id);</highlight></codeline>
<codeline lineno="258"><highlight class="normal">}</highlight></codeline>
<codeline lineno="259"><highlight class="normal"></highlight></codeline>
<codeline lineno="260"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="classFichierHDF_1a7ba14e3b21aaca1de6d4473ccd3a5a66" kindref="member">FichierHDF::create_and_fill_dataset_SW</ref>(<ref refid="classNom" kindref="compound">Nom</ref><sp/>dataset_name,<sp/><ref refid="classSortie__Brute" kindref="compound">Sortie_Brute</ref>&amp;<sp/>sortie)</highlight></codeline>
<codeline lineno="261"><highlight class="normal">{</highlight></codeline>
<codeline lineno="262"><highlight class="normal"><sp/><sp/><ref refid="classFichierHDF_1a8251a110f8aedee5695532706ebc2b4b" kindref="member">prepare_dataset_props</ref>();</highlight></codeline>
<codeline lineno="263"><highlight class="normal"></highlight></codeline>
<codeline lineno="264"><highlight class="normal"><sp/><sp/>hsize_t<sp/>lenData<sp/>=<sp/>sortie.<ref refid="classSortie__Brute_1a5429279d5f058f3fa8cb1891ab8fe644" kindref="member">get_size</ref>();</highlight></codeline>
<codeline lineno="265"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>*<sp/>data<sp/>=<sp/>sortie.<ref refid="classSortie__Brute_1a8c671dadd57fdfc806023b4bf9413a6f" kindref="member">get_data</ref>();</highlight></codeline>
<codeline lineno="266"><highlight class="normal"></highlight></codeline>
<codeline lineno="267"><highlight class="normal"><sp/><sp/>hsize_t<sp/>dims[1]<sp/>=<sp/>{lenData};</highlight></codeline>
<codeline lineno="268"><highlight class="normal"><sp/><sp/>hid_t<sp/>dataspace_id<sp/>=<sp/>H5Screate_simple(1,<sp/>dims,<sp/></highlight><highlight class="keyword">nullptr</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="269"><highlight class="normal"></highlight></codeline>
<codeline lineno="270"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>Create<sp/>the<sp/>dataset</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="271"><highlight class="normal"><sp/><sp/>hid_t<sp/>dataset_id<sp/>=<sp/>H5Dcreate2(file_id_,<sp/>dataset_name,<sp/>H5T_NATIVE_OPAQUE,<sp/>dataspace_id,</highlight></codeline>
<codeline lineno="272"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>H5P_DEFAULT,<sp/>H5P_DEFAULT,<sp/>H5P_DEFAULT);</highlight></codeline>
<codeline lineno="273"><highlight class="normal"></highlight></codeline>
<codeline lineno="274"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>Writing<sp/>into<sp/>it:</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="275"><highlight class="normal"><sp/><sp/>Cerr<sp/>&lt;&lt;<sp/></highlight><highlight class="stringliteral">&quot;[HDF5]<sp/>Writing<sp/>into<sp/>HDF<sp/>dataset<sp/>&quot;</highlight><highlight class="normal"><sp/>&lt;&lt;<sp/>dataset_name<sp/>&lt;&lt;<sp/></highlight><highlight class="stringliteral">&quot;...&quot;</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="276"><highlight class="normal"><sp/><sp/>H5Dwrite(dataset_id,<sp/>H5T_NATIVE_OPAQUE,<sp/>H5S_ALL,<sp/>H5S_ALL,<sp/>dataset_transfer_plst_,<sp/>data);</highlight></codeline>
<codeline lineno="277"><highlight class="normal"><sp/><sp/>Cerr<sp/>&lt;&lt;<sp/></highlight><highlight class="stringliteral">&quot;<sp/>Done<sp/>!&quot;</highlight><highlight class="normal"><sp/>&lt;&lt;<sp/>finl;</highlight></codeline>
<codeline lineno="278"><highlight class="normal"></highlight></codeline>
<codeline lineno="279"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>Close<sp/>dataset<sp/>and<sp/>dataspace</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="280"><highlight class="normal"><sp/><sp/>H5Dclose(dataset_id);</highlight></codeline>
<codeline lineno="281"><highlight class="normal"><sp/><sp/>H5Sclose(dataspace_id);</highlight></codeline>
<codeline lineno="282"><highlight class="normal"></highlight></codeline>
<codeline lineno="283"><highlight class="normal">}</highlight></codeline>
<codeline lineno="284"><highlight class="normal"></highlight></codeline>
<codeline lineno="285"><highlight class="normal"></highlight></codeline>
<codeline lineno="286"><highlight class="normal"></highlight></codeline>
<codeline lineno="287"><highlight class="normal"></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/><ref refid="classFichierHDF_1a5731b503f5e1472ad9ab934f759dcf7b" kindref="member">FichierHDF::exists</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal">*<sp/>dataset_name)</highlight></codeline>
<codeline lineno="288"><highlight class="normal">{</highlight></codeline>
<codeline lineno="289"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>H5Lexists(<sp/>file_id_,<sp/>dataset_name,<sp/>H5P_DEFAULT<sp/>)&gt;0;</highlight></codeline>
<codeline lineno="290"><highlight class="normal">}</highlight></codeline>
<codeline lineno="291"><highlight class="normal"></highlight></codeline>
<codeline lineno="292"><highlight class="normal"></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/><ref refid="classFichierHDF_1a0ad22bc624e64d0fecd33abb64b4881a" kindref="member">FichierHDF::is_hdf5</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>*<sp/>file_name)</highlight></codeline>
<codeline lineno="293"><highlight class="normal">{</highlight></codeline>
<codeline lineno="294"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>H5Fis_hdf5(file_name)&gt;0;</highlight></codeline>
<codeline lineno="295"><highlight class="normal">}</highlight></codeline>
<codeline lineno="296"><highlight class="normal"></highlight></codeline>
<codeline lineno="297"><highlight class="normal"></highlight></codeline>
<codeline lineno="298"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="classFichierHDF_1a7d5bffb599ec7d2053ca95b3aeb23a2f" kindref="member">FichierHDF::set_int_size</ref>()</highlight></codeline>
<codeline lineno="299"><highlight class="normal">{</highlight></codeline>
<codeline lineno="300"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>Create<sp/>attribute<sp/>specifying<sp/>whether<sp/>ints<sp/>are<sp/>32<sp/>or<sp/>64<sp/>bits</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="301"><highlight class="normal"><sp/><sp/>hid_t<sp/>space_id<sp/>=<sp/>H5Screate(H5S_SCALAR);</highlight></codeline>
<codeline lineno="302"><highlight class="normal"><sp/><sp/>hid_t<sp/>attr_id<sp/>=<sp/>H5Acreate(file_id_,<sp/></highlight><highlight class="stringliteral">&quot;int_size_in_bits&quot;</highlight><highlight class="normal">,<sp/>H5T_NATIVE_INT32,<sp/>space_id,<sp/>H5P_DEFAULT,<sp/>H5P_DEFAULT);</highlight></codeline>
<codeline lineno="303"><highlight class="normal"></highlight><highlight class="preprocessor">#ifdef<sp/>INT_is_64_</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="304"><highlight class="normal"><sp/><sp/>True_int<sp/>int_size<sp/>=<sp/>64;</highlight></codeline>
<codeline lineno="305"><highlight class="normal"></highlight><highlight class="preprocessor">#else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="306"><highlight class="normal"><sp/><sp/>True_int<sp/>int_size<sp/>=<sp/>32;</highlight></codeline>
<codeline lineno="307"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="308"><highlight class="normal"><sp/><sp/>H5Awrite(attr_id,<sp/>H5T_NATIVE_INT32,<sp/>&amp;int_size);</highlight></codeline>
<codeline lineno="309"><highlight class="normal"><sp/><sp/>H5Aclose(attr_id);</highlight></codeline>
<codeline lineno="310"><highlight class="normal"><sp/><sp/>H5Sclose(space_id);</highlight></codeline>
<codeline lineno="311"><highlight class="normal"></highlight></codeline>
<codeline lineno="312"><highlight class="normal">}</highlight></codeline>
<codeline lineno="313"><highlight class="normal"></highlight></codeline>
<codeline lineno="314"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><sp/><ref refid="classFichierHDF_1a0871fd1d5218ab377e48f4d69f34e092" kindref="member">FichierHDF::check_int_size</ref>(<ref refid="classNom" kindref="compound">Nom</ref><sp/>filename)</highlight></codeline>
<codeline lineno="315"><highlight class="normal">{</highlight></codeline>
<codeline lineno="316"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>TRUST_int_type_exists_in_file<sp/>=<sp/>H5Aexists(file_id_,<sp/></highlight><highlight class="stringliteral">&quot;int_size_in_bits&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="317"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(TRUST_int_type_exists_in_file<sp/>&lt;<sp/>0)</highlight></codeline>
<codeline lineno="318"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="319"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>Cerr<sp/>&lt;&lt;<sp/></highlight><highlight class="stringliteral">&quot;Error<sp/>&quot;</highlight><highlight class="normal"><sp/>&lt;&lt;<sp/>(int)<sp/>TRUST_int_type_exists_in_file;</highlight></codeline>
<codeline lineno="320"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>Cerr<sp/>&lt;&lt;<sp/></highlight><highlight class="stringliteral">&quot;<sp/>while<sp/>getting<sp/>the<sp/>attribute<sp/>&apos;int_size_in_bits&apos;<sp/>in<sp/>the<sp/>&quot;</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="321"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>Cerr<sp/>&lt;&lt;<sp/>filename<sp/>&lt;&lt;<sp/></highlight><highlight class="stringliteral">&quot;<sp/>HDF<sp/>file&quot;</highlight><highlight class="normal"><sp/>&lt;&lt;<sp/>finl;</highlight></codeline>
<codeline lineno="322"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classProcess_1acc2fbbe761e08e5870ae605c0705491c" kindref="member">Process::exit</ref>(-1);</highlight></codeline>
<codeline lineno="323"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="324"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(TRUST_int_type_exists_in_file<sp/>==<sp/>0)</highlight></codeline>
<codeline lineno="325"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="326"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>Cerr<sp/>&lt;&lt;<sp/></highlight><highlight class="stringliteral">&quot;Warning,<sp/>we<sp/>can&apos;t<sp/>find<sp/>whether<sp/>the<sp/>&quot;</highlight><highlight class="normal"><sp/>&lt;&lt;<sp/>filename<sp/>&lt;&lt;<sp/></highlight><highlight class="stringliteral">&quot;<sp/>HDF<sp/>file<sp/>was<sp/>written<sp/>with<sp/>-int32<sp/>or<sp/>-int64&quot;</highlight><highlight class="normal"><sp/>&lt;&lt;<sp/>finl;</highlight></codeline>
<codeline lineno="327"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>Cerr<sp/>&lt;&lt;<sp/></highlight><highlight class="stringliteral">&quot;Possibly<sp/>old<sp/>files<sp/>created<sp/>before<sp/>1.8.4<sp/>version&quot;</highlight><highlight class="normal"><sp/>&lt;&lt;<sp/>finl;</highlight></codeline>
<codeline lineno="328"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>Cerr<sp/>&lt;&lt;<sp/></highlight><highlight class="stringliteral">&quot;If<sp/>an<sp/>error<sp/>occurs,<sp/>or<sp/>results<sp/>seem<sp/>weird,<sp/>try<sp/>opening<sp/>it<sp/>with<sp/>&quot;</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="329"><highlight class="normal"></highlight><highlight class="preprocessor">#ifdef<sp/>INT_is_64_</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="330"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>Cerr<sp/>&lt;&lt;<sp/></highlight><highlight class="stringliteral">&quot;an<sp/>-int32<sp/>TRUST<sp/>version.&quot;</highlight><highlight class="normal"><sp/>&lt;&lt;<sp/>finl;</highlight></codeline>
<codeline lineno="331"><highlight class="normal"></highlight><highlight class="preprocessor">#else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="332"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>Cerr<sp/>&lt;&lt;<sp/></highlight><highlight class="stringliteral">&quot;an<sp/>-int64<sp/>TRUST<sp/>version.&quot;</highlight><highlight class="normal"><sp/>&lt;&lt;<sp/>finl;</highlight></codeline>
<codeline lineno="333"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="334"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>Cerr<sp/>&lt;&lt;<sp/></highlight><highlight class="stringliteral">&quot;Or<sp/>set<sp/>environment<sp/>variable<sp/>TRUST_FORCE_DIFFERENT_INT_SIZE<sp/>to<sp/>1<sp/>to<sp/>try&quot;</highlight><highlight class="normal"><sp/>&lt;&lt;<sp/>finl;</highlight></codeline>
<codeline lineno="335"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>Cerr<sp/>&lt;&lt;<sp/></highlight><highlight class="stringliteral">&quot;reading<sp/>the<sp/>int32<sp/>(or<sp/>int64)<sp/>file<sp/>by<sp/>a<sp/>int64<sp/>(or<sp/>int32)<sp/>TRUST<sp/>binary.&quot;</highlight><highlight class="normal"><sp/>&lt;&lt;<sp/>finl;</highlight></codeline>
<codeline lineno="336"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(getenv(</highlight><highlight class="stringliteral">&quot;TRUST_FORCE_DIFFERENT_INT_SIZE&quot;</highlight><highlight class="normal">)!=</highlight><highlight class="keyword">nullptr</highlight><highlight class="normal">)<sp/>is_different_int_size_<sp/>=<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="337"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="338"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="339"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="340"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>hid_t<sp/>attr_id<sp/>=<sp/>H5Aopen(file_id_,<sp/></highlight><highlight class="stringliteral">&quot;int_size_in_bits&quot;</highlight><highlight class="normal">,<sp/>H5P_DEFAULT);</highlight></codeline>
<codeline lineno="341"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>True_int<sp/>int_size_in_bits;</highlight></codeline>
<codeline lineno="342"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>H5Aread(attr_id,<sp/>H5T_NATIVE_INT32,<sp/>&amp;int_size_in_bits);</highlight></codeline>
<codeline lineno="343"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>Cerr<sp/>&lt;&lt;<sp/></highlight><highlight class="stringliteral">&quot;[HDF5]<sp/>We<sp/>read<sp/>that<sp/>&quot;</highlight><highlight class="normal">&lt;&lt;<sp/>filename<sp/>&lt;&lt;<sp/></highlight><highlight class="stringliteral">&quot;<sp/>was<sp/>written<sp/>in<sp/>-int&quot;</highlight><highlight class="normal"><sp/>&lt;&lt;<sp/>(int)int_size_in_bits<sp/>&lt;&lt;<sp/>finl;</highlight></codeline>
<codeline lineno="344"><highlight class="normal"></highlight></codeline>
<codeline lineno="345"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!(int_size_in_bits<sp/>==<sp/>32<sp/>||<sp/>int_size_in_bits<sp/>==<sp/>64))</highlight></codeline>
<codeline lineno="346"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="347"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Cerr<sp/>&lt;&lt;<sp/></highlight><highlight class="stringliteral">&quot;[HDF5]<sp/>We<sp/>read<sp/>-int&quot;</highlight><highlight class="normal">&lt;&lt;<sp/>(int)int_size_in_bits<sp/>&lt;&lt;<sp/></highlight><highlight class="stringliteral">&quot;<sp/>in<sp/>&quot;</highlight><highlight class="normal"><sp/>&lt;&lt;<sp/>filename<sp/>&lt;&lt;<sp/></highlight><highlight class="stringliteral">&quot;<sp/>which<sp/>is<sp/>abnormal.&quot;</highlight><highlight class="normal"><sp/>&lt;&lt;<sp/>finl;</highlight></codeline>
<codeline lineno="348"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>H5Aclose(attr_id);</highlight></codeline>
<codeline lineno="349"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classProcess_1acc2fbbe761e08e5870ae605c0705491c" kindref="member">Process::exit</ref>(-1);</highlight></codeline>
<codeline lineno="350"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="351"><highlight class="normal"></highlight></codeline>
<codeline lineno="352"><highlight class="normal"></highlight><highlight class="preprocessor">#ifdef<sp/>INT_is_64_</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="353"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(int_size_in_bits<sp/>==<sp/>32)<sp/>is_different_int_size_<sp/>=<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="354"><highlight class="normal"></highlight><highlight class="preprocessor">#else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="355"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(int_size_in_bits<sp/>==<sp/>64)</highlight></codeline>
<codeline lineno="356"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="357"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>is_different_int_size_<sp/>=<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="358"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Cerr<sp/>&lt;&lt;<sp/></highlight><highlight class="stringliteral">&quot;Warning,<sp/>HDF<sp/>file<sp/>&quot;</highlight><highlight class="normal"><sp/>&lt;&lt;<sp/>filename<sp/>&lt;&lt;<sp/></highlight><highlight class="stringliteral">&quot;<sp/>was<sp/>written<sp/>with<sp/>an<sp/>-int64<sp/>version<sp/>and<sp/>you<sp/>are<sp/>reading<sp/>it<sp/>with<sp/>an<sp/>-int32<sp/>version.&quot;</highlight><highlight class="normal">&lt;&lt;<sp/>finl;</highlight></codeline>
<codeline lineno="359"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Cerr<sp/>&lt;&lt;<sp/></highlight><highlight class="stringliteral">&quot;Make<sp/>sure<sp/>your<sp/>mesh<sp/>doesn&apos;t<sp/>contain<sp/>more<sp/>than<sp/>2^32<sp/>elements,<sp/>nodes<sp/>or<sp/>faces.&quot;</highlight><highlight class="normal"><sp/>&lt;&lt;<sp/>finl;</highlight></codeline>
<codeline lineno="360"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="361"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="362"><highlight class="normal"></highlight></codeline>
<codeline lineno="363"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>H5Aclose(attr_id);</highlight></codeline>
<codeline lineno="364"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="365"><highlight class="normal">}</highlight></codeline>
<codeline lineno="366"><highlight class="normal"></highlight></codeline>
<codeline lineno="367"><highlight class="normal"></highlight><highlight class="comment">//<sp/>void<sp/>FichierHDF::get_chunking(hsize_t<sp/>datasetLen)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="368"><highlight class="normal"></highlight><highlight class="comment">//<sp/>{</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="369"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/><sp/>hsize_t<sp/>FourGB<sp/>=<sp/>4294967296;<sp/>//maximum<sp/>limit<sp/>tolerated<sp/>by<sp/>HDF5</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="370"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/><sp/>//if<sp/>the<sp/>dataset<sp/>is<sp/>not<sp/>big<sp/>enough,<sp/>there&apos;s<sp/>no<sp/>need<sp/>for<sp/>chunking</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="371"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/><sp/>if(datasetLen<sp/>&gt;<sp/>FourGB)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="372"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/>chunk_size_<sp/>=<sp/>FourGB;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="373"><highlight class="normal"></highlight><highlight class="comment">//<sp/>}</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="374"><highlight class="normal"></highlight></codeline>
<codeline lineno="375"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight></codeline>
    </programlisting>
    <location file="/volatile/catA/gj277443/TRUST/sync-doc/src/Kernel/Utilitaires/FichierHDF.cpp"/>
  </compounddef>
</doxygen>
