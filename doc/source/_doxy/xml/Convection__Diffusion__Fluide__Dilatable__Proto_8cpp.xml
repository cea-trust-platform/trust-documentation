<?xml version='1.0' encoding='UTF-8' standalone='no'?>
<doxygen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="compound.xsd" version="1.9.1" xml:lang="en-US">
  <compounddef id="Convection__Diffusion__Fluide__Dilatable__Proto_8cpp" kind="file" language="C++">
    <compoundname>Convection_Diffusion_Fluide_Dilatable_Proto.cpp</compoundname>
    <includes refid="Convection__Diffusion__Fluide__Dilatable__base_8h" local="no">Convection_Diffusion_Fluide_Dilatable_base.h</includes>
    <includes refid="Convection__Diffusion__Fluide__Dilatable__Proto_8h" local="no">Convection_Diffusion_Fluide_Dilatable_Proto.h</includes>
    <includes refid="Navier__Stokes__Fluide__Dilatable__base_8h" local="no">Navier_Stokes_Fluide_Dilatable_base.h</includes>
    <includes refid="Fluide__Weakly__Compressible_8h" local="no">Fluide_Weakly_Compressible.h</includes>
    <includes refid="Convection__Diffusion__std_8h" local="no">Convection_Diffusion_std.h</includes>
    <includes refid="EcritureLectureSpecial_8h" local="no">EcritureLectureSpecial.h</includes>
    <includes refid="Op__Conv__negligeable_8h" local="no">Op_Conv_negligeable.h</includes>
    <includes refid="Discretisation__base_8h" local="no">Discretisation_base.h</includes>
    <includes refid="Schema__Temps__base_8h" local="no">Schema_Temps_base.h</includes>
    <includes refid="Champ__Uniforme_8h" local="no">Champ_Uniforme.h</includes>
    <includes refid="Probleme__base_8h" local="no">Probleme_base.h</includes>
    <includes refid="Matrice__Morse_8h" local="no">Matrice_Morse.h</includes>
    <includes refid="TRUST__2__PDI_8h" local="no">TRUST_2_PDI.h</includes>
    <includes refid="TRUSTTrav_8h" local="no">TRUSTTrav.h</includes>
    <includes refid="Operateur_8h" local="no">Operateur.h</includes>
    <includes refid="Domaine_8h" local="no">Domaine.h</includes>
    <includes refid="Avanc_8h" local="no">Avanc.h</includes>
    <includes refid="Device_8h" local="no">Device.h</includes>
    <includes refid="Perf__counters_8h" local="no">Perf_counters.h</includes>
    <briefdescription>
    </briefdescription>
    <detaileddescription>
    </detaileddescription>
    <programlisting>
<codeline lineno="1"><highlight class="comment">/****************************************************************************</highlight></codeline>
<codeline lineno="2"><highlight class="comment">*<sp/>Copyright<sp/>(c)<sp/>2025,<sp/>CEA</highlight></codeline>
<codeline lineno="3"><highlight class="comment">*<sp/>All<sp/>rights<sp/>reserved.</highlight></codeline>
<codeline lineno="4"><highlight class="comment">*</highlight></codeline>
<codeline lineno="5"><highlight class="comment">*<sp/>Redistribution<sp/>and<sp/>use<sp/>in<sp/>source<sp/>and<sp/>binary<sp/>forms,<sp/>with<sp/>or<sp/>without<sp/>modification,<sp/>are<sp/>permitted<sp/>provided<sp/>that<sp/>the<sp/>following<sp/>conditions<sp/>are<sp/>met:</highlight></codeline>
<codeline lineno="6"><highlight class="comment">*<sp/>1.<sp/>Redistributions<sp/>of<sp/>source<sp/>code<sp/>must<sp/>retain<sp/>the<sp/>above<sp/>copyright<sp/>notice,<sp/>this<sp/>list<sp/>of<sp/>conditions<sp/>and<sp/>the<sp/>following<sp/>disclaimer.</highlight></codeline>
<codeline lineno="7"><highlight class="comment">*<sp/>2.<sp/>Redistributions<sp/>in<sp/>binary<sp/>form<sp/>must<sp/>reproduce<sp/>the<sp/>above<sp/>copyright<sp/>notice,<sp/>this<sp/>list<sp/>of<sp/>conditions<sp/>and<sp/>the<sp/>following<sp/>disclaimer<sp/>in<sp/>the<sp/>documentation<sp/>and/or<sp/>other<sp/>materials<sp/>provided<sp/>with<sp/>the<sp/>distribution.</highlight></codeline>
<codeline lineno="8"><highlight class="comment">*<sp/>3.<sp/>Neither<sp/>the<sp/>name<sp/>of<sp/>the<sp/>copyright<sp/>holder<sp/>nor<sp/>the<sp/>names<sp/>of<sp/>its<sp/>contributors<sp/>may<sp/>be<sp/>used<sp/>to<sp/>endorse<sp/>or<sp/>promote<sp/>products<sp/>derived<sp/>from<sp/>this<sp/>software<sp/>without<sp/>specific<sp/>prior<sp/>written<sp/>permission.</highlight></codeline>
<codeline lineno="9"><highlight class="comment">*</highlight></codeline>
<codeline lineno="10"><highlight class="comment">*<sp/>THIS<sp/>SOFTWARE<sp/>IS<sp/>PROVIDED<sp/>BY<sp/>THE<sp/>COPYRIGHT<sp/>HOLDERS<sp/>AND<sp/>CONTRIBUTORS<sp/>&quot;AS<sp/>IS&quot;<sp/>AND<sp/>ANY<sp/>EXPRESS<sp/>OR<sp/>IMPLIED<sp/>WARRANTIES,<sp/>INCLUDING,<sp/>BUT<sp/>NOT<sp/>LIMITED<sp/>TO,<sp/>THE<sp/>IMPLIED<sp/>WARRANTIES<sp/>OF<sp/>MERCHANTABILITY<sp/>AND<sp/>FITNESS<sp/>FOR<sp/>A<sp/>PARTICULAR<sp/>PURPOSE<sp/>ARE<sp/>DISCLAIMED.</highlight></codeline>
<codeline lineno="11"><highlight class="comment">*<sp/>IN<sp/>NO<sp/>EVENT<sp/>SHALL<sp/>THE<sp/>COPYRIGHT<sp/>HOLDER<sp/>OR<sp/>CONTRIBUTORS<sp/>BE<sp/>LIABLE<sp/>FOR<sp/>ANY<sp/>DIRECT,<sp/>INDIRECT,<sp/>INCIDENTAL,<sp/>SPECIAL,<sp/>EXEMPLARY,<sp/>OR<sp/>CONSEQUENTIAL<sp/>DAMAGES<sp/>(INCLUDING,<sp/>BUT<sp/>NOT<sp/>LIMITED<sp/>TO,<sp/>PROCUREMENT<sp/>OF<sp/>SUBSTITUTE<sp/>GOODS<sp/>OR<sp/>SERVICES;<sp/>LOSS<sp/>OF<sp/>USE,<sp/>DATA,<sp/>OR<sp/>PROFITS;</highlight></codeline>
<codeline lineno="12"><highlight class="comment">*<sp/>OR<sp/>BUSINESS<sp/>INTERRUPTION)<sp/>HOWEVER<sp/>CAUSED<sp/>AND<sp/>ON<sp/>ANY<sp/>THEORY<sp/>OF<sp/>LIABILITY,<sp/>WHETHER<sp/>IN<sp/>CONTRACT,<sp/>STRICT<sp/>LIABILITY,<sp/>OR<sp/>TORT<sp/>(INCLUDING<sp/>NEGLIGENCE<sp/>OR<sp/>OTHERWISE)<sp/>ARISING<sp/>IN<sp/>ANY<sp/>WAY<sp/>OUT<sp/>OF<sp/>THE<sp/>USE<sp/>OF<sp/>THIS<sp/>SOFTWARE,<sp/>EVEN<sp/>IF<sp/>ADVISED<sp/>OF<sp/>THE<sp/>POSSIBILITY<sp/>OF<sp/>SUCH<sp/>DAMAGE.</highlight></codeline>
<codeline lineno="13"><highlight class="comment">*</highlight></codeline>
<codeline lineno="14"><highlight class="comment">*****************************************************************************/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="15"><highlight class="normal"></highlight></codeline>
<codeline lineno="16"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;Convection_Diffusion_Fluide_Dilatable_base.h&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="17"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;Convection_Diffusion_Fluide_Dilatable_Proto.h&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="18"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;Navier_Stokes_Fluide_Dilatable_base.h&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="19"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;Fluide_Weakly_Compressible.h&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="20"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;Convection_Diffusion_std.h&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="21"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;EcritureLectureSpecial.h&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="22"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;Op_Conv_negligeable.h&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="23"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;Discretisation_base.h&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="24"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;Schema_Temps_base.h&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="25"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;Champ_Uniforme.h&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="26"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;Probleme_base.h&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="27"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;Matrice_Morse.h&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="28"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;TRUST_2_PDI.h&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="29"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;TRUSTTrav.h&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="30"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;Operateur.h&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="31"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;Domaine.h&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="32"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;Avanc.h&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="33"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;Device.h&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="34"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;Perf_counters.h&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="35"><highlight class="normal"></highlight></codeline>
<codeline lineno="36" refid="classConvection__Diffusion__Fluide__Dilatable__Proto_1a121d891b16222913346f02b786fbf945" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="classConvection__Diffusion__Fluide__Dilatable__Proto_1a121d891b16222913346f02b786fbf945" kindref="member">Convection_Diffusion_Fluide_Dilatable_Proto::calculer_div_rho_u_impl</ref></highlight></codeline>
<codeline lineno="37"><highlight class="normal">(<ref refid="classTRUSTTab" kindref="compound">DoubleTab</ref>&amp;<sp/>Div,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="classConvection__Diffusion__Fluide__Dilatable__base" kindref="compound">Convection_Diffusion_Fluide_Dilatable_base</ref>&amp;<sp/>eqn)</highlight><highlight class="keyword"><sp/>const</highlight></codeline>
<codeline lineno="38"><highlight class="keyword"></highlight><highlight class="normal">{</highlight></codeline>
<codeline lineno="39"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="classOperateur" kindref="compound">Operateur</ref>&amp;<sp/>op_conv<sp/>=<sp/>eqn.<ref refid="classConvection__Diffusion__std_1acfb3e5da249873b1f878c2aa5868e534" kindref="member">operateur</ref>(1);</highlight></codeline>
<codeline lineno="40"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>No<sp/>convective<sp/>operator:</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="41"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(sub_type(<ref refid="classOp__Conv__negligeable" kindref="compound">Op_Conv_negligeable</ref>,op_conv.<ref refid="classOperateur_1a1f3e24efd9b54d05821e731fe4bd6027" kindref="member">l_op_base</ref>()))</highlight></codeline>
<codeline lineno="42"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="43"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>Div=0;</highlight></codeline>
<codeline lineno="44"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="45"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="46"><highlight class="normal"></highlight></codeline>
<codeline lineno="47"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>on<sp/>cherche<sp/>a<sp/>changer<sp/>temporairement<sp/>le<sp/>domaine_cl</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="48"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(ch_unite_.est_nul())</highlight></codeline>
<codeline lineno="49"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="50"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>ch_unite_<sp/>=<sp/>eqn.<ref refid="classConvection__Diffusion__Fluide__Dilatable__base_1ad0099f5dcff25353df74331eefab5e86" kindref="member">inconnue</ref>();</highlight></codeline>
<codeline lineno="51"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>ch_unite_-&gt;<ref refid="classChamp__Inc__base_1af36cd0a3fe8ed6bc529a263261a0f5a8" kindref="member">valeurs</ref>()<sp/>=<sp/>1.0;</highlight></codeline>
<codeline lineno="52"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="53"><highlight class="normal"><sp/><sp/>ref_cast_non_const(<ref refid="classOperateur__Conv__base" kindref="compound">Operateur_Conv_base</ref>,op_conv.<ref refid="classOperateur_1a1f3e24efd9b54d05821e731fe4bd6027" kindref="member">l_op_base</ref>()).associer_champ_temp(ch_unite_,<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="54"><highlight class="normal"></highlight></codeline>
<codeline lineno="55"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(eqn.<ref refid="classEquation__base_1a440fc95363315082eddbef26dc76024e" kindref="member">discretisation</ref>().<ref refid="classObjet__U_1a58289bb63283588d31dc69b87b3f1d55" kindref="member">que_suis_je</ref>()<sp/>!=<sp/></highlight><highlight class="stringliteral">&quot;VDF&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="56"><highlight class="normal"><sp/><sp/><sp/><sp/>ref_cast_non_const(<ref refid="classOperateur__base" kindref="compound">Operateur_base</ref>,op_conv.<ref refid="classOperateur_1a1f3e24efd9b54d05821e731fe4bd6027" kindref="member">l_op_base</ref>()).associer_domaine_cl_dis(eqn.<ref refid="classConvection__Diffusion__Fluide__Dilatable__base_1a214006a5a5b74cc667aca6a66b161462" kindref="member">domaine_cl_modif</ref>());</highlight></codeline>
<codeline lineno="57"><highlight class="normal"></highlight></codeline>
<codeline lineno="58"><highlight class="normal"><sp/><sp/>op_conv.<ref refid="classOperateur_1accdf61cf1e33fb42e9eb06f1c501422b" kindref="member">ajouter</ref>(ch_unite_-&gt;valeurs(),<sp/>Div);</highlight></codeline>
<codeline lineno="59"><highlight class="normal"><sp/><sp/>ref_cast_non_const(<ref refid="classOperateur__Conv__base" kindref="compound">Operateur_Conv_base</ref>,op_conv.<ref refid="classOperateur_1a1f3e24efd9b54d05821e731fe4bd6027" kindref="member">l_op_base</ref>()).associer_champ_temp(eqn.<ref refid="classConvection__Diffusion__Fluide__Dilatable__base_1ad0099f5dcff25353df74331eefab5e86" kindref="member">inconnue</ref>(),<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="60"><highlight class="normal"></highlight></codeline>
<codeline lineno="61"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(eqn.<ref refid="classEquation__base_1a440fc95363315082eddbef26dc76024e" kindref="member">discretisation</ref>().<ref refid="classObjet__U_1a58289bb63283588d31dc69b87b3f1d55" kindref="member">que_suis_je</ref>()<sp/>!=<sp/></highlight><highlight class="stringliteral">&quot;VDF&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="62"><highlight class="normal"><sp/><sp/><sp/><sp/>ref_cast_non_const(<ref refid="classOperateur__base" kindref="compound">Operateur_base</ref>,op_conv.<ref refid="classOperateur_1a1f3e24efd9b54d05821e731fe4bd6027" kindref="member">l_op_base</ref>()).associer_domaine_cl_dis(eqn.<ref refid="classEquation__base_1a9dd19036ab6bf1d01b103c6f609b8efe" kindref="member">domaine_Cl_dis</ref>());</highlight></codeline>
<codeline lineno="63"><highlight class="normal">}</highlight></codeline>
<codeline lineno="64"><highlight class="normal"></highlight><highlight class="comment"></highlight></codeline>
<codeline lineno="65"><highlight class="comment">/*!<sp/>@brief<sp/>Renvoie<sp/>la<sp/>derivee<sp/>en<sp/>temps<sp/>de<sp/>l&apos;inconnue<sp/>de<sp/>l&apos;equation.</highlight></codeline>
<codeline lineno="66"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="67"><highlight class="comment"><sp/>*<sp/>Le<sp/>calcul<sp/>est<sp/>le<sp/>suivant:</highlight></codeline>
<codeline lineno="68"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>d(inconnue)/dt<sp/>=<sp/>M^{-1}<sp/>*<sp/>(sources<sp/>-<sp/>somme(Op_{i}(inconnue)))<sp/>/<sp/>rho</highlight></codeline>
<codeline lineno="69"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="70"><highlight class="comment"><sp/>*<sp/>@param<sp/>(DoubleTab&amp;<sp/>derivee)<sp/>le<sp/>tableau<sp/>des<sp/>valeurs<sp/>de<sp/>la<sp/>derivee<sp/>en<sp/>temps<sp/>du<sp/>champ<sp/>inconnu</highlight></codeline>
<codeline lineno="71"><highlight class="comment"><sp/>*<sp/>@return<sp/>(DoubleTab&amp;)<sp/>le<sp/>tableau<sp/>des<sp/>valeurs<sp/>de<sp/>la<sp/>derivee<sp/>en<sp/>temps<sp/>du<sp/>champ<sp/>inconnu</highlight></codeline>
<codeline lineno="72"><highlight class="comment"><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="73" refid="classConvection__Diffusion__Fluide__Dilatable__Proto_1a2f09516e23af998bef35700d625abb50" refkind="member"><highlight class="normal"><ref refid="classTRUSTTab" kindref="compound">DoubleTab</ref>&amp;<sp/><ref refid="classConvection__Diffusion__Fluide__Dilatable__Proto_1a2f09516e23af998bef35700d625abb50" kindref="member">Convection_Diffusion_Fluide_Dilatable_Proto::derivee_en_temps_inco_sans_solveur_masse_impl</ref></highlight></codeline>
<codeline lineno="74"><highlight class="normal">(<ref refid="classConvection__Diffusion__Fluide__Dilatable__base" kindref="compound">Convection_Diffusion_Fluide_Dilatable_base</ref>&amp;<sp/>eqn,<sp/><ref refid="classTRUSTTab" kindref="compound">DoubleTab</ref>&amp;<sp/>derivee,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>is_expl)</highlight></codeline>
<codeline lineno="75"><highlight class="normal">{</highlight></codeline>
<codeline lineno="76"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">/*</highlight></codeline>
<codeline lineno="77"><highlight class="comment"><sp/><sp/><sp/>*<sp/>ATTENTION<sp/>:<sp/>THIS<sp/>IS<sp/>A<sp/>GENERIC<sp/>METHOD<sp/>THAT<sp/>IS<sp/>USED<sp/>TO<sp/>SOLVE<sp/>EXPLICITLY<sp/>(OR<sp/>DIFFUSION<sp/>IMPLICIT)</highlight></codeline>
<codeline lineno="78"><highlight class="comment"><sp/><sp/><sp/>*<sp/>A<sp/>THERMAL<sp/>OR<sp/>SPECIES<sp/>CONV/DIFF<sp/>EQUATION.<sp/>SO<sp/>THE<sp/>VARIABLE<sp/>CAN<sp/>EITHER<sp/>BE<sp/>THE<sp/>TEMPERATURE<sp/>T<sp/>OR</highlight></codeline>
<codeline lineno="79"><highlight class="comment"><sp/><sp/><sp/>*<sp/>THE<sp/>MASS<sp/>FRACTION<sp/>Y.</highlight></codeline>
<codeline lineno="80"><highlight class="comment"><sp/><sp/><sp/>*</highlight></codeline>
<codeline lineno="81"><highlight class="comment"><sp/><sp/><sp/>*<sp/>For<sp/>the<sp/>species<sp/>equation<sp/>for<sp/>example,<sp/>we<sp/>have<sp/>:</highlight></codeline>
<codeline lineno="82"><highlight class="comment"><sp/><sp/><sp/>*<sp/>d(rho<sp/>Y)/dt<sp/>+<sp/>div(<sp/>rho*u*Y<sp/>)<sp/>=<sp/>div(<sp/>rho*D*grad(Y)<sp/>)</highlight></codeline>
<codeline lineno="83"><highlight class="comment"><sp/><sp/><sp/>*</highlight></codeline>
<codeline lineno="84"><highlight class="comment"><sp/><sp/><sp/>*<sp/>With<sp/>a<sp/>non<sp/>conservative<sp/>formulation<sp/>we<sp/>write:</highlight></codeline>
<codeline lineno="85"><highlight class="comment"><sp/><sp/><sp/>*<sp/>rho<sp/>d(Y)/dt<sp/>+<sp/>Y<sp/>d(rho)/dt<sp/>+<sp/>Y<sp/>div<sp/>(rho*u)<sp/>+<sp/>rho*u<sp/>grad(Y)<sp/>=<sp/>div(<sp/>rho*D*grad(Y)<sp/>)</highlight></codeline>
<codeline lineno="86"><highlight class="comment"><sp/><sp/><sp/>*</highlight></codeline>
<codeline lineno="87"><highlight class="comment"><sp/><sp/><sp/>*<sp/>Using<sp/>the<sp/>mass<sp/>equation,<sp/>we<sp/>get<sp/>:</highlight></codeline>
<codeline lineno="88"><highlight class="comment"><sp/><sp/><sp/>*<sp/>rho<sp/>d(Y)/dt<sp/>+<sp/>rho*u<sp/>grad(Y)<sp/>=<sp/>div(<sp/>rho*D*grad(Y)<sp/>)</highlight></codeline>
<codeline lineno="89"><highlight class="comment"><sp/><sp/><sp/>*</highlight></codeline>
<codeline lineno="90"><highlight class="comment"><sp/><sp/><sp/>*<sp/>divide<sp/>by<sp/>rho<sp/>=&gt;<sp/>d(Y)/dt<sp/>=<sp/>(<sp/>div(<sp/>rho*D*grad(Y)<sp/>)<sp/>+<sp/>S<sp/>)<sp/>/<sp/>rho<sp/>-<sp/>u<sp/>grad(Y)</highlight></codeline>
<codeline lineno="91"><highlight class="comment"><sp/><sp/><sp/>*</highlight></codeline>
<codeline lineno="92"><highlight class="comment"><sp/><sp/><sp/>*<sp/>This<sp/>is<sp/>what<sp/>we<sp/>code<sp/>here<sp/>with<sp/>derivee<sp/>=<sp/>d(Y)/dt</highlight></codeline>
<codeline lineno="93"><highlight class="comment"><sp/><sp/><sp/>*</highlight></codeline>
<codeline lineno="94"><highlight class="comment"><sp/><sp/><sp/>*</highlight></codeline>
<codeline lineno="95"><highlight class="comment"><sp/><sp/><sp/>*<sp/>Similarly<sp/>for<sp/>the<sp/>temperature<sp/>equation,<sp/>we<sp/>code</highlight></codeline>
<codeline lineno="96"><highlight class="comment"><sp/><sp/><sp/>*</highlight></codeline>
<codeline lineno="97"><highlight class="comment"><sp/><sp/><sp/>*<sp/>derivee<sp/>=<sp/>d(T)/dt<sp/>=<sp/>(<sp/>div(<sp/>lambda*grad(T)<sp/>)<sp/>+<sp/>S<sp/>)<sp/>/<sp/>(rho*Cp)<sp/>-<sp/>u<sp/>grad(T)</highlight></codeline>
<codeline lineno="98"><highlight class="comment"><sp/><sp/><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="99"><highlight class="normal"></highlight></codeline>
<codeline lineno="100"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="classSchema__Temps__base" kindref="compound">Schema_Temps_base</ref>&amp;<sp/>sch<sp/>=<sp/>eqn.<ref refid="classEquation__base_1abc11e51aa75b4c7aa55c27f71eb2f2c4" kindref="member">schema_temps</ref>();</highlight></codeline>
<codeline lineno="101"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>diffusion_implicite=sch.<ref refid="classSchema__Temps__base_1a0be8720b74beaac1deafa7fed4e1975b" kindref="member">diffusion_implicite</ref>();</highlight></codeline>
<codeline lineno="102"><highlight class="normal"><sp/><sp/>eqn.<ref refid="classEquation__base_1a9dd19036ab6bf1d01b103c6f609b8efe" kindref="member">domaine_Cl_dis</ref>().<ref refid="classDomaine__Cl__dis__base_1ac61cb62c82e3db6c4b4553538d7a6b61" kindref="member">les_conditions_limites</ref>().set_modifier_val_imp(0);</highlight></codeline>
<codeline lineno="103"><highlight class="normal"></highlight></codeline>
<codeline lineno="104"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">/*</highlight></codeline>
<codeline lineno="105"><highlight class="comment"><sp/><sp/><sp/>*<sp/>FIRST<sp/>TERM<sp/>:<sp/>diffusive</highlight></codeline>
<codeline lineno="106"><highlight class="comment"><sp/><sp/><sp/>*<sp/>derivee<sp/>=<sp/>div(<sp/>rho*D*grad(Y)<sp/>)<sp/>or<sp/>div(<sp/>lambda*grad(T)<sp/>)</highlight></codeline>
<codeline lineno="107"><highlight class="comment"><sp/><sp/><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="108"><highlight class="normal"><sp/><sp/><ref refid="classFluide__Dilatable__base" kindref="compound">Fluide_Dilatable_base</ref>&amp;<sp/>fluide_dil<sp/>=<sp/>eqn.<ref refid="classConvection__Diffusion__Fluide__Dilatable__base_1a6d7cf454d1eb069395626618326290e3" kindref="member">fluide</ref>();</highlight></codeline>
<codeline lineno="109"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<sp/>!<ref refid="classConvection__Diffusion__Fluide__Dilatable__Proto_1a3cc3059c8760b4df630b37cb928c34eb" kindref="member">is_thermal</ref>()<sp/></highlight><highlight class="comment">/*<sp/>species<sp/>equation<sp/>*/</highlight><highlight class="normal"><sp/>||<sp/>(<ref refid="classConvection__Diffusion__Fluide__Dilatable__Proto_1a3cc3059c8760b4df630b37cb928c34eb" kindref="member">is_thermal</ref>()<sp/>&amp;&amp;<sp/>fluide_dil.<ref refid="classFluide__Dilatable__base_1ae343729fcb0eed11da2aef064d747033" kindref="member">type_fluide</ref>()==</highlight><highlight class="stringliteral">&quot;Gaz_Parfait&quot;</highlight><highlight class="normal"><sp/>))</highlight></codeline>
<codeline lineno="110"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="111"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!diffusion_implicite)<sp/>eqn.<ref refid="classConvection__Diffusion__std_1acfb3e5da249873b1f878c2aa5868e534" kindref="member">operateur</ref>(0).<ref refid="classOperateur_1accdf61cf1e33fb42e9eb06f1c501422b" kindref="member">ajouter</ref>(derivee);</highlight></codeline>
<codeline lineno="112"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="113"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="comment">//<sp/>Thermal<sp/>equation<sp/>+<sp/>Gaz<sp/>reel<sp/>=&gt;<sp/>No<sp/>diffusion<sp/>implicit<sp/>...</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="114"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="115"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>eqn.<ref refid="classConvection__Diffusion__std_1acfb3e5da249873b1f878c2aa5868e534" kindref="member">operateur</ref>(0).<ref refid="classOperateur_1accdf61cf1e33fb42e9eb06f1c501422b" kindref="member">ajouter</ref>(fluide_dil.<ref refid="classFluide__Dilatable__base_1a2f3ef3e8df7c640c8751a301b8d5ba92" kindref="member">temperature</ref>(),derivee);</highlight></codeline>
<codeline lineno="116"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(diffusion_implicite)</highlight></codeline>
<codeline lineno="117"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="118"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Cerr<sp/>&lt;&lt;<sp/></highlight><highlight class="stringliteral">&quot;Error:<sp/>diffusion<sp/>implicit<sp/>not<sp/>implemented<sp/>in<sp/>Convection_Diffusion_Chaleur_Fluide_Dilatable_base&quot;</highlight><highlight class="normal"><sp/>&lt;&lt;<sp/>finl;</highlight></codeline>
<codeline lineno="119"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classProcess_1acc2fbbe761e08e5870ae605c0705491c" kindref="member">Process::exit</ref>();</highlight></codeline>
<codeline lineno="120"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="121"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="122"><highlight class="normal"></highlight></codeline>
<codeline lineno="123"><highlight class="normal"><sp/><sp/>eqn.<ref refid="classEquation__base_1a9dd19036ab6bf1d01b103c6f609b8efe" kindref="member">domaine_Cl_dis</ref>().<ref refid="classDomaine__Cl__dis__base_1ac61cb62c82e3db6c4b4553538d7a6b61" kindref="member">les_conditions_limites</ref>().set_modifier_val_imp(1);</highlight></codeline>
<codeline lineno="124"><highlight class="normal"><sp/><sp/>derivee.<ref refid="classTRUSTVect_1a17969227082b6532c960a56745facfd8" kindref="member">echange_espace_virtuel</ref>();</highlight></codeline>
<codeline lineno="125"><highlight class="normal"></highlight></codeline>
<codeline lineno="126"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>Add<sp/>source<sp/>term<sp/>(if<sp/>any,<sp/>but<sp/>for<sp/>temperatur<sp/>eit<sp/>is<sp/>sure<sp/>!!!<sp/>)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="127"><highlight class="normal"><sp/><sp/>eqn.<ref refid="classEquation__base_1a3c8ac50e3e7b6ed29024a43e828a5396" kindref="member">sources</ref>().<ref refid="classSources_1aee196746a5ec214061c0a84814e68117" kindref="member">ajouter</ref>(derivee);</highlight></codeline>
<codeline lineno="128"><highlight class="normal"></highlight></codeline>
<codeline lineno="129"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>On<sp/>divise<sp/>derivee<sp/>par<sp/>rho<sp/>si<sp/>espece<sp/>ou<sp/>gaz<sp/>reel...<sp/>sinon<sp/>par<sp/>rho*Cp<sp/>!</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="130"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>flag<sp/>=<sp/><ref refid="classConvection__Diffusion__Fluide__Dilatable__Proto_1a3cc3059c8760b4df630b37cb928c34eb" kindref="member">is_thermal</ref>()<sp/>&amp;&amp;<sp/>fluide_dil.<ref refid="classFluide__Dilatable__base_1ae343729fcb0eed11da2aef064d747033" kindref="member">type_fluide</ref>()==</highlight><highlight class="stringliteral">&quot;Gaz_Parfait&quot;</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="131"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(flag)<sp/>fluide_dil.<ref refid="classFluide__Dilatable__base_1abd50eacc971f7afab19a87adde5f38f7" kindref="member">update_rho_cp</ref>(sch.<ref refid="classSchema__Temps__base_1a1e573b93ad40c737ecb2da65b68f968a" kindref="member">temps_courant</ref>());</highlight></codeline>
<codeline lineno="132"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="classTRUSTTab" kindref="compound">DoubleTab</ref>&amp;<sp/>array<sp/>=<sp/>flag<sp/>?<sp/>eqn.<ref refid="classEquation__base_1a57ba60a2c32601e3441c838ab2d74332" kindref="member">get_champ</ref>(</highlight><highlight class="stringliteral">&quot;rho_cp_comme_T&quot;</highlight><highlight class="normal">).<ref refid="classChamp__Proto_1a9d8c69f11d1b0a8e378cc6ca41793614" kindref="member">valeurs</ref>()<sp/>:<sp/>fluide_dil.<ref refid="classMilieu__base_1ab8ce0742ed6681306999931dca88a5b9" kindref="member">masse_volumique</ref>().<ref refid="classChamp__Proto_1a9d8c69f11d1b0a8e378cc6ca41793614" kindref="member">valeurs</ref>();</highlight></codeline>
<codeline lineno="133"><highlight class="normal"><sp/><sp/>tab_divide_any_shape(derivee,<sp/>array);</highlight></codeline>
<codeline lineno="134"><highlight class="normal"><sp/><sp/>derivee.<ref refid="classTRUSTVect_1a17969227082b6532c960a56745facfd8" kindref="member">echange_espace_virtuel</ref>();</highlight></codeline>
<codeline lineno="135"><highlight class="normal"></highlight></codeline>
<codeline lineno="136"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">/*</highlight></codeline>
<codeline lineno="137"><highlight class="comment"><sp/><sp/><sp/>*<sp/>SECOND<sp/>TERM<sp/>:<sp/>convective</highlight></codeline>
<codeline lineno="138"><highlight class="comment"><sp/><sp/><sp/>*<sp/>=<sp/>-<sp/>u<sp/>grad(Y)<sp/>=<sp/>[<sp/>Y<sp/>div<sp/>(rho*u)<sp/>-<sp/>div(<sp/>rho*u*Y<sp/>)<sp/>]<sp/>/<sp/>rho</highlight></codeline>
<codeline lineno="139"><highlight class="comment"><sp/><sp/><sp/>*<sp/>or</highlight></codeline>
<codeline lineno="140"><highlight class="comment"><sp/><sp/><sp/>*<sp/>=<sp/>-<sp/>u<sp/>grad(T)<sp/>=<sp/>[<sp/>T<sp/>div<sp/>(rho*u)<sp/>-<sp/>div(<sp/>rho*u*T<sp/>)<sp/>]<sp/>/<sp/>rho*Cp</highlight></codeline>
<codeline lineno="141"><highlight class="comment"><sp/><sp/><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="142"><highlight class="normal"><sp/><sp/><ref refid="classTRUSTTrav" kindref="compound">DoubleTrav</ref><sp/>convection(derivee);</highlight></codeline>
<codeline lineno="143"><highlight class="normal"></highlight></codeline>
<codeline lineno="144"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>Add<sp/>Y<sp/>div<sp/>(rho*u)<sp/>or<sp/>T<sp/>div<sp/>(rho*u)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="145"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="classTRUSTTab" kindref="compound">DoubleTab</ref>&amp;<sp/>inco<sp/>=<sp/>eqn.<ref refid="classConvection__Diffusion__Fluide__Dilatable__base_1ad0099f5dcff25353df74331eefab5e86" kindref="member">inconnue</ref>().<ref refid="classChamp__Inc__base_1af36cd0a3fe8ed6bc529a263261a0f5a8" kindref="member">valeurs</ref>();</highlight></codeline>
<codeline lineno="146"><highlight class="normal"><sp/><sp/><ref refid="classConvection__Diffusion__Fluide__Dilatable__Proto_1ac654cf15f0945a632fdca7d6b972c1c1" kindref="member">calculer_div_u_ou_div_rhou</ref>(convection);</highlight></codeline>
<codeline lineno="147"><highlight class="normal"></highlight></codeline>
<codeline lineno="148"><highlight class="normal"><sp/><sp/>tab_multiply_any_shape(convection,<sp/>inco);</highlight></codeline>
<codeline lineno="149"><highlight class="normal"><sp/><sp/>convection*=-1;</highlight></codeline>
<codeline lineno="150"><highlight class="normal"></highlight></codeline>
<codeline lineno="151"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>Add<sp/>convection<sp/>operator:<sp/>-<sp/>div(<sp/>rho*u*Y<sp/>)<sp/>or<sp/>-div<sp/>(<sp/>rho*u*T<sp/>)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="152"><highlight class="normal"><sp/><sp/>eqn.<ref refid="classConvection__Diffusion__std_1acfb3e5da249873b1f878c2aa5868e534" kindref="member">operateur</ref>(1).<ref refid="classOperateur_1accdf61cf1e33fb42e9eb06f1c501422b" kindref="member">ajouter</ref>(convection);</highlight></codeline>
<codeline lineno="153"><highlight class="normal"></highlight></codeline>
<codeline lineno="154"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>Divide<sp/>by<sp/>rho<sp/>if<sp/>necessary</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="155"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="classConvection__Diffusion__Fluide__Dilatable__Proto_1a1cb4fa5d4798eb6a58fa3791fbe4546d" kindref="member">is_generic</ref>())</highlight></codeline>
<codeline lineno="156"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="157"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="classTRUSTTab" kindref="compound">DoubleTab</ref>&amp;<sp/>tab_rho<sp/>=<sp/>fluide_dil.<ref refid="classMilieu__base_1ab8ce0742ed6681306999931dca88a5b9" kindref="member">masse_volumique</ref>().<ref refid="classChamp__Proto_1a9d8c69f11d1b0a8e378cc6ca41793614" kindref="member">valeurs</ref>();</highlight></codeline>
<codeline lineno="158"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>tab_divide_any_shape(convection,<sp/>tab_rho);</highlight></codeline>
<codeline lineno="159"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="160"><highlight class="normal"></highlight></codeline>
<codeline lineno="161"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>Complete<sp/>with<sp/>special<sp/>source<sp/>terms<sp/>from<sp/>mass<sp/>equation<sp/>(if<sp/>any)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="162"><highlight class="normal"><sp/><sp/><ref refid="classTRUSTTrav" kindref="compound">DoubleTrav</ref><sp/>mass_source_term(derivee);</highlight></codeline>
<codeline lineno="163"><highlight class="normal"><sp/><sp/>mass_source_term<sp/>=<sp/>0.0;</highlight></codeline>
<codeline lineno="164"><highlight class="normal"></highlight></codeline>
<codeline lineno="165"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>has_mass_flux<sp/>=<sp/>(sub_type(<ref refid="classNavier__Stokes__Fluide__Dilatable__base" kindref="compound">Navier_Stokes_Fluide_Dilatable_base</ref>,<sp/>fluide_dil.<ref refid="classFluide__Dilatable__base_1a810998758d5b95492a5ffa323f99ba6b" kindref="member">vitesse</ref>().<ref refid="classMorEqn_1a233c714209593acce7aec1f55640bca2" kindref="member">equation</ref>()))<sp/>?</highlight></codeline>
<codeline lineno="166"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ref_cast(<ref refid="classNavier__Stokes__Fluide__Dilatable__base" kindref="compound">Navier_Stokes_Fluide_Dilatable_base</ref>,<sp/>fluide_dil.<ref refid="classFluide__Dilatable__base_1a810998758d5b95492a5ffa323f99ba6b" kindref="member">vitesse</ref>().<ref refid="classMorEqn_1a233c714209593acce7aec1f55640bca2" kindref="member">equation</ref>()).has_source_masse()<sp/>:<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="167"><highlight class="normal"></highlight></codeline>
<codeline lineno="168"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!<ref refid="classConvection__Diffusion__Fluide__Dilatable__Proto_1a3cc3059c8760b4df630b37cb928c34eb" kindref="member">is_thermal</ref>()<sp/>&amp;&amp;<sp/>has_mass_flux)<sp/></highlight><highlight class="comment">/*<sp/>species<sp/>equation<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="169"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="170"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="classSource__Masse__Fluide__Dilatable__base" kindref="compound">Source_Masse_Fluide_Dilatable_base</ref>&amp;<sp/>src_masse<sp/>=<sp/>ref_cast(<ref refid="classNavier__Stokes__Fluide__Dilatable__base" kindref="compound">Navier_Stokes_Fluide_Dilatable_base</ref>,<sp/>fluide_dil.<ref refid="classFluide__Dilatable__base_1a810998758d5b95492a5ffa323f99ba6b" kindref="member">vitesse</ref>().<ref refid="classMorEqn_1a233c714209593acce7aec1f55640bca2" kindref="member">equation</ref>()).source_masse();</highlight></codeline>
<codeline lineno="171"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>src_masse.<ref refid="classSource__Masse__Fluide__Dilatable__base_1a099b19d69ceb86edc883ddf83cb390b2" kindref="member">ajouter_eq_espece</ref>(eqn,<sp/>fluide_dil,<sp/>is_expl,<sp/>mass_source_term);</highlight></codeline>
<codeline lineno="172"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="173"><highlight class="normal"></highlight></codeline>
<codeline lineno="174"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">/*</highlight></codeline>
<codeline lineno="175"><highlight class="comment"><sp/><sp/><sp/>*<sp/>TOTAL<sp/>TERM<sp/>:<sp/>diffusive<sp/>+<sp/>convective<sp/>+<sp/>sources</highlight></codeline>
<codeline lineno="176"><highlight class="comment"><sp/><sp/><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="177"><highlight class="normal"><sp/><sp/>derivee+=convection;</highlight></codeline>
<codeline lineno="178"><highlight class="normal"></highlight></codeline>
<codeline lineno="179"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>si<sp/>schema<sp/>implicite</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="180"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!is_expl<sp/>&amp;&amp;<sp/>has_mass_flux)</highlight></codeline>
<codeline lineno="181"><highlight class="normal"><sp/><sp/><sp/><sp/>derivee<sp/>+=<sp/>mass_source_term;<sp/></highlight><highlight class="comment">//<sp/>pour<sp/>ca<sp/>on<sp/>traite<sp/>le<sp/>volume<sp/>par<sp/>le<sp/>solveur<sp/>de<sp/>masse<sp/>plus<sp/>tard<sp/>...</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="182"><highlight class="normal"></highlight></codeline>
<codeline lineno="183"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(diffusion_implicite)</highlight></codeline>
<codeline lineno="184"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="185"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="classTRUSTTab" kindref="compound">DoubleTab</ref>&amp;<sp/>Tfutur=eqn.<ref refid="classConvection__Diffusion__Fluide__Dilatable__base_1ad0099f5dcff25353df74331eefab5e86" kindref="member">inconnue</ref>().<ref refid="classChamp__Inc__base_1a7e193bf93bcd4bf88bf4fd6c54e0469a" kindref="member">futur</ref>();</highlight></codeline>
<codeline lineno="186"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classTRUSTTrav" kindref="compound">DoubleTrav</ref><sp/>secmem(derivee);</highlight></codeline>
<codeline lineno="187"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>secmem=derivee;<sp/></highlight><highlight class="comment">//<sp/>sans<sp/>contribution<sp/>terme<sp/>source</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="188"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>eqn.<ref refid="classEquation__base_1a4b4effb48f1841ec8c743d6eb29f8a51" kindref="member">solv_masse</ref>().<ref refid="classSolveur__Masse__base_1acb67cf99305704c37379cda2d3a2358a" kindref="member">appliquer</ref>(secmem);</highlight></codeline>
<codeline lineno="189"><highlight class="normal"></highlight></codeline>
<codeline lineno="190"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(has_mass_flux)</highlight></codeline>
<codeline lineno="191"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>secmem<sp/>+=<sp/>mass_source_term<sp/>;<sp/></highlight><highlight class="comment">//<sp/>ajoute<sp/>contribution<sp/>terme<sp/>source<sp/>(deja<sp/>divise<sp/>par<sp/>V)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="192"><highlight class="normal"></highlight></codeline>
<codeline lineno="193"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>derivee<sp/>=<sp/>Tfutur;</highlight></codeline>
<codeline lineno="194"><highlight class="normal"></highlight></codeline>
<codeline lineno="195"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classConvection__Diffusion__Fluide__Dilatable__Proto_1a3cc3059c8760b4df630b37cb928c34eb" kindref="member">is_thermal</ref>()<sp/>?<sp/>eqn.<ref refid="classEquation__base_1a4b4effb48f1841ec8c743d6eb29f8a51" kindref="member">solv_masse</ref>().<ref refid="classSolveur__Masse__base_1ae4ff14e481fd81ada32d8e93304f375f" kindref="member">set_name_of_coefficient_temporel</ref>(</highlight><highlight class="stringliteral">&quot;rho_cp_comme_T&quot;</highlight><highlight class="normal">)<sp/>:</highlight></codeline>
<codeline lineno="196"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>eqn.<ref refid="classEquation__base_1a4b4effb48f1841ec8c743d6eb29f8a51" kindref="member">solv_masse</ref>().<ref refid="classSolveur__Masse__base_1ae4ff14e481fd81ada32d8e93304f375f" kindref="member">set_name_of_coefficient_temporel</ref>(</highlight><highlight class="stringliteral">&quot;masse_volumique&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="197"><highlight class="normal"></highlight></codeline>
<codeline lineno="198"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>eqn.<ref refid="classEquation__base_1abd67532530f67b3305703a130a5d823a" kindref="member">Gradient_conjugue_diff_impl</ref>(secmem,derivee);</highlight></codeline>
<codeline lineno="199"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>eqn.<ref refid="classEquation__base_1a4b4effb48f1841ec8c743d6eb29f8a51" kindref="member">solv_masse</ref>().<ref refid="classSolveur__Masse__base_1ae4ff14e481fd81ada32d8e93304f375f" kindref="member">set_name_of_coefficient_temporel</ref>(</highlight><highlight class="stringliteral">&quot;no_coeff&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="200"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="201"><highlight class="normal"></highlight></codeline>
<codeline lineno="202"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>100%<sp/>explicite</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="203"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!sch.<ref refid="classSchema__Temps__base_1a0be8720b74beaac1deafa7fed4e1975b" kindref="member">diffusion_implicite</ref>()<sp/>&amp;&amp;<sp/>is_expl)</highlight></codeline>
<codeline lineno="204"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="205"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>eqn.<ref refid="classEquation__base_1a4b4effb48f1841ec8c743d6eb29f8a51" kindref="member">solv_masse</ref>().<ref refid="classSolveur__Masse__base_1acb67cf99305704c37379cda2d3a2358a" kindref="member">appliquer</ref>(derivee);</highlight></codeline>
<codeline lineno="206"><highlight class="normal"></highlight></codeline>
<codeline lineno="207"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(has_mass_flux)</highlight></codeline>
<codeline lineno="208"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>derivee<sp/>+=<sp/>mass_source_term;<sp/></highlight><highlight class="comment">//<sp/>ajoute<sp/>contribution<sp/>terme<sp/>source<sp/>(deja<sp/>divise<sp/>par<sp/>V)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="209"><highlight class="normal"></highlight></codeline>
<codeline lineno="210"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>derivee.<ref refid="classTRUSTVect_1a17969227082b6532c960a56745facfd8" kindref="member">echange_espace_virtuel</ref>();</highlight></codeline>
<codeline lineno="211"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="212"><highlight class="normal"></highlight></codeline>
<codeline lineno="213"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>derivee;</highlight></codeline>
<codeline lineno="214"><highlight class="normal">}<sp/></highlight><highlight class="comment">/*<sp/>END<sp/>derivee_en_temps_inco_sans_solveur_masse_impl<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="215"><highlight class="normal"></highlight></codeline>
<codeline lineno="216" refid="classConvection__Diffusion__Fluide__Dilatable__Proto_1a6726448816aaa2898df58d670a1a9704" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="classConvection__Diffusion__Fluide__Dilatable__Proto_1a6726448816aaa2898df58d670a1a9704" kindref="member">Convection_Diffusion_Fluide_Dilatable_Proto::assembler_impl</ref></highlight></codeline>
<codeline lineno="217"><highlight class="normal">(<sp/><ref refid="classConvection__Diffusion__Fluide__Dilatable__base" kindref="compound">Convection_Diffusion_Fluide_Dilatable_base</ref>&amp;<sp/>eqn,</highlight></codeline>
<codeline lineno="218"><highlight class="normal"><sp/><sp/><ref refid="classMatrice__Morse" kindref="compound">Matrice_Morse</ref>&amp;<sp/>matrice_morse,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="classTRUSTTab" kindref="compound">DoubleTab</ref>&amp;<sp/>inco,<sp/><ref refid="classTRUSTTab" kindref="compound">DoubleTab</ref>&amp;<sp/>resu)</highlight></codeline>
<codeline lineno="219"><highlight class="normal">{</highlight></codeline>
<codeline lineno="220"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">/*</highlight></codeline>
<codeline lineno="221"><highlight class="comment"><sp/><sp/><sp/>*<sp/>ATEENTION<sp/>:<sp/>THIS<sp/>IS<sp/>A<sp/>GENERIC<sp/>METHOD<sp/>THAT<sp/>IS<sp/>USED<sp/>TO<sp/>SOLVE<sp/>IMPLICITLY<sp/>A<sp/>THERMAL<sp/>OR<sp/>SPECIES</highlight></codeline>
<codeline lineno="222"><highlight class="comment"><sp/><sp/><sp/>*<sp/><sp/>CONV/DIFF<sp/>EQUATION.<sp/>SO<sp/>THE<sp/>VARIABLE<sp/>CAN<sp/>EITHER<sp/>BE<sp/>THE<sp/>TEMPERATURE<sp/>T<sp/>OR<sp/>THE<sp/>MASS<sp/>FRACTION<sp/>Y.</highlight></codeline>
<codeline lineno="223"><highlight class="comment"><sp/><sp/><sp/>*</highlight></codeline>
<codeline lineno="224"><highlight class="comment"><sp/><sp/><sp/>*<sp/>See<sp/>the<sp/>previous<sp/>method<sp/>derivee_en_temps_inco_sans_solveur_masse_impl<sp/>for<sp/>more<sp/>description</highlight></codeline>
<codeline lineno="225"><highlight class="comment"><sp/><sp/><sp/>*<sp/>of<sp/>the<sp/>treated<sp/>equations.</highlight></codeline>
<codeline lineno="226"><highlight class="comment"><sp/><sp/><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="227"><highlight class="normal"></highlight></codeline>
<codeline lineno="228"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>Elie<sp/>Saikali</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="229"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>Je<sp/>garde<sp/>ce<sp/>test<sp/>pour<sp/>debug<sp/>...<sp/>TODO<sp/>:<sp/>a<sp/>voir<sp/>si<sp/>on<sp/>peut<sp/>virer<sp/>tout<sp/>ca...</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="230"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>test_op=0;</highlight></codeline>
<codeline lineno="231"><highlight class="normal"><sp/><sp/>{</highlight></codeline>
<codeline lineno="232"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal">*<sp/>theValue<sp/>=<sp/>getenv(</highlight><highlight class="stringliteral">&quot;TRUST_TEST_OPERATEUR_IMPLICITE&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="233"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(theValue<sp/>!=<sp/></highlight><highlight class="keyword">nullptr</highlight><highlight class="normal">)<sp/>test_op=2;</highlight></codeline>
<codeline lineno="234"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="235"><highlight class="normal"><sp/><sp/>{</highlight></codeline>
<codeline lineno="236"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal">*<sp/>theValue<sp/>=<sp/>getenv(</highlight><highlight class="stringliteral">&quot;TRUST_TEST_OPERATEUR_IMPLICITE_BLOQUANT&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="237"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(theValue<sp/>!=<sp/></highlight><highlight class="keyword">nullptr</highlight><highlight class="normal">)<sp/>test_op=1;</highlight></codeline>
<codeline lineno="238"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="239"><highlight class="normal"></highlight></codeline>
<codeline lineno="240"><highlight class="normal"><sp/><sp/><ref refid="classFluide__Dilatable__base" kindref="compound">Fluide_Dilatable_base</ref>&amp;<sp/>fluide_dil<sp/>=<sp/>eqn.<ref refid="classConvection__Diffusion__Fluide__Dilatable__base_1a6d7cf454d1eb069395626618326290e3" kindref="member">fluide</ref>();</highlight></codeline>
<codeline lineno="241"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="classTRUSTTab" kindref="compound">DoubleTab</ref>&amp;<sp/>tab_rho<sp/>=<sp/>fluide_dil.<ref refid="classMilieu__base_1ab8ce0742ed6681306999931dca88a5b9" kindref="member">masse_volumique</ref>().<ref refid="classChamp__Proto_1a9d8c69f11d1b0a8e378cc6ca41793614" kindref="member">valeurs</ref>();</highlight></codeline>
<codeline lineno="242"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>n<sp/>=<sp/>tab_rho.<ref refid="classTRUSTTab_1aee55d6851cd43d179ec3c46262fa0aad" kindref="member">dimension</ref>(0);</highlight></codeline>
<codeline lineno="243"><highlight class="normal"></highlight></codeline>
<codeline lineno="244"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>ajout<sp/>diffusion<sp/>(avec<sp/>rho,<sp/>D<sp/>et<sp/>Y<sp/>/<sp/>ou<sp/>lambda<sp/>et<sp/>T)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="245"><highlight class="normal"><sp/><sp/>eqn.<ref refid="classConvection__Diffusion__std_1acfb3e5da249873b1f878c2aa5868e534" kindref="member">operateur</ref>(0).<ref refid="classOperateur_1a1f3e24efd9b54d05821e731fe4bd6027" kindref="member">l_op_base</ref>().<ref refid="classOperateur__base_1a2fbd607fd187f87ef8b72dec73cf51aa" kindref="member">contribuer_a_avec</ref>(inco,<sp/>matrice_morse);</highlight></codeline>
<codeline lineno="246"><highlight class="normal"></highlight></codeline>
<codeline lineno="247"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>Add<sp/>source<sp/>term<sp/>(if<sp/>any)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="248"><highlight class="normal"><sp/><sp/>eqn.<ref refid="classEquation__base_1a3c8ac50e3e7b6ed29024a43e828a5396" kindref="member">sources</ref>().<ref refid="classSources_1a2c4bb87930a1893ee0a11a509771cfc1" kindref="member">contribuer_a_avec</ref>(inco,matrice_morse);</highlight></codeline>
<codeline lineno="249"><highlight class="normal"></highlight></codeline>
<codeline lineno="250"><highlight class="normal"><sp/><sp/><ref refid="classTRUSTTrav" kindref="compound">DoubleTrav</ref><sp/>tab_coeff_diffusif(matrice_morse.<ref refid="classMatrice__Morse_1a3a016f4b3995a58b313cb47e66ebefd1" kindref="member">get_set_coeff</ref>());</highlight></codeline>
<codeline lineno="251"><highlight class="normal"><sp/><sp/>tab_coeff_diffusif<sp/>=<sp/>matrice_morse.<ref refid="classMatrice__Morse_1a3a016f4b3995a58b313cb47e66ebefd1" kindref="member">get_set_coeff</ref>();</highlight></codeline>
<codeline lineno="252"><highlight class="normal"></highlight></codeline>
<codeline lineno="253"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>on<sp/>calcule<sp/>les<sp/>coefficients<sp/>de<sp/>l&apos;op<sp/>de<sp/>convection<sp/>on<sp/>obtient<sp/>les<sp/>coeff<sp/>de<sp/>div<sp/>(rho*u*Y)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="254"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>ou<sp/>div(rho*u*T).<sp/>dans<sp/>le<sp/>cas<sp/>thermique,<sp/>il<sp/>faudrait<sp/>multiplier<sp/>par<sp/>cp<sp/>puis<sp/>divisier<sp/>par<sp/>rho<sp/>cp</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="255"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>on<sp/>le<sp/>fera<sp/>d&apos;un<sp/>coup...</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="256"><highlight class="normal"><sp/><sp/>matrice_morse.<ref refid="classMatrice__Morse_1a3a016f4b3995a58b313cb47e66ebefd1" kindref="member">get_set_coeff</ref>()=0.;</highlight></codeline>
<codeline lineno="257"><highlight class="normal"><sp/><sp/>eqn.<ref refid="classConvection__Diffusion__std_1acfb3e5da249873b1f878c2aa5868e534" kindref="member">operateur</ref>(1).<ref refid="classOperateur_1a1f3e24efd9b54d05821e731fe4bd6027" kindref="member">l_op_base</ref>().<ref refid="classOperateur__base_1a2fbd607fd187f87ef8b72dec73cf51aa" kindref="member">contribuer_a_avec</ref>(inco,<sp/>matrice_morse);</highlight></codeline>
<codeline lineno="258"><highlight class="normal"></highlight></codeline>
<codeline lineno="259"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>on<sp/>calcule<sp/>div(rho<sp/>*<sp/>u)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="260"><highlight class="normal"><sp/><sp/><ref refid="classTRUSTTrav" kindref="compound">DoubleTrav</ref><sp/>tab_derivee2(resu);</highlight></codeline>
<codeline lineno="261"><highlight class="normal"><sp/><sp/><ref refid="classConvection__Diffusion__Fluide__Dilatable__Proto_1ac654cf15f0945a632fdca7d6b972c1c1" kindref="member">calculer_div_u_ou_div_rhou</ref>(tab_derivee2);</highlight></codeline>
<codeline lineno="262"><highlight class="normal"></highlight></codeline>
<codeline lineno="263"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!<ref refid="classConvection__Diffusion__Fluide__Dilatable__Proto_1a3cc3059c8760b4df630b37cb928c34eb" kindref="member">is_thermal</ref>())<sp/></highlight><highlight class="comment">//espece</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="264"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="265"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>ToDo_Kokkos(</highlight><highlight class="stringliteral">&quot;critical&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="266"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="classTRUSTVect" kindref="compound">IntVect</ref>&amp;<sp/>tab1=<sp/>matrice_morse.<ref refid="classMatrice__Morse_1adad29fc3bee7ca6ad5f023006aae7104" kindref="member">get_tab1</ref>();</highlight></codeline>
<codeline lineno="267"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classTRUSTVect" kindref="compound">DoubleVect</ref>&amp;<sp/>coeff=matrice_morse.<ref refid="classMatrice__Morse_1a3a016f4b3995a58b313cb47e66ebefd1" kindref="member">get_set_coeff</ref>();</highlight></codeline>
<codeline lineno="268"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>som=0<sp/>;<sp/>som&lt;n<sp/>;<sp/>som++)</highlight></codeline>
<codeline lineno="269"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="270"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>inv_rho<sp/>=<sp/>1.<sp/>/<sp/>tab_rho(som);</highlight></codeline>
<codeline lineno="271"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>k=tab1(som)-1;<sp/>k&lt;tab1(som+1)-1;<sp/>k++)</highlight></codeline>
<codeline lineno="272"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>coeff(k)=<sp/>(coeff(k)*inv_rho+tab_coeff_diffusif(k)*inv_rho);</highlight></codeline>
<codeline lineno="273"><highlight class="normal"></highlight></codeline>
<codeline lineno="274"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>matrice_morse(som,som)+=tab_derivee2(som)*inv_rho;</highlight></codeline>
<codeline lineno="275"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="276"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="277"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="classConvection__Diffusion__Fluide__Dilatable__Proto_1a3cc3059c8760b4df630b37cb928c34eb" kindref="member">is_thermal</ref>()<sp/>&amp;&amp;<sp/>fluide_dil.<ref refid="classFluide__Dilatable__base_1ae343729fcb0eed11da2aef064d747033" kindref="member">type_fluide</ref>()==</highlight><highlight class="stringliteral">&quot;Gaz_Parfait&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="278"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="279"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>fluide_dil.<ref refid="classFluide__Dilatable__base_1abd50eacc971f7afab19a87adde5f38f7" kindref="member">update_rho_cp</ref>(eqn.<ref refid="classEquation__base_1abc11e51aa75b4c7aa55c27f71eb2f2c4" kindref="member">schema_temps</ref>().<ref refid="classSchema__Temps__base_1a1e573b93ad40c737ecb2da65b68f968a" kindref="member">temps_courant</ref>());</highlight></codeline>
<codeline lineno="280"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>ToDo<sp/>add<sp/>tab1,<sp/>tab2,<sp/>coeff()<sp/>methods<sp/>to<sp/>Matrice_morse_View<sp/>avoid<sp/>list<sp/>of<sp/>accessors...</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="281"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>CDoubleArrView<sp/>rhoCp<sp/>=<sp/></highlight><highlight class="keyword">static_cast&lt;</highlight><highlight class="keyword">const<sp/></highlight><highlight class="normal"><ref refid="classTRUSTArray" kindref="compound">ArrOfDouble</ref>&amp;</highlight><highlight class="keyword">&gt;</highlight><highlight class="normal">(eqn.<ref refid="classEquation__base_1a57ba60a2c32601e3441c838ab2d74332" kindref="member">get_champ</ref>(</highlight><highlight class="stringliteral">&quot;rho_cp_comme_T&quot;</highlight><highlight class="normal">).<ref refid="classChamp__Proto_1a9d8c69f11d1b0a8e378cc6ca41793614" kindref="member">valeurs</ref>()).view_ro();</highlight></codeline>
<codeline lineno="282"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>CDoubleArrView<sp/>rho<sp/>=<sp/></highlight><highlight class="keyword">static_cast&lt;</highlight><highlight class="keyword">const<sp/></highlight><highlight class="normal"><ref refid="classTRUSTArray" kindref="compound">ArrOfDouble</ref>&amp;</highlight><highlight class="keyword">&gt;</highlight><highlight class="normal">(tab_rho).view_ro();</highlight></codeline>
<codeline lineno="283"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>CDoubleArrView<sp/>derivee2<sp/>=<sp/></highlight><highlight class="keyword">static_cast&lt;</highlight><highlight class="keyword">const<sp/></highlight><highlight class="normal"><ref refid="classTRUSTArray" kindref="compound">ArrOfDouble</ref>&amp;</highlight><highlight class="keyword">&gt;</highlight><highlight class="normal">(tab_derivee2).view_ro();</highlight></codeline>
<codeline lineno="284"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>CIntArrView<sp/>tab1<sp/>=<sp/>matrice_morse.<ref refid="classMatrice__Morse_1adad29fc3bee7ca6ad5f023006aae7104" kindref="member">get_tab1</ref>().view_ro();</highlight></codeline>
<codeline lineno="285"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>CDoubleArrView<sp/>coeff_diffusif<sp/>=<sp/></highlight><highlight class="keyword">static_cast&lt;</highlight><highlight class="keyword">const<sp/></highlight><highlight class="normal"><ref refid="classTRUSTArray" kindref="compound">ArrOfDouble</ref>&amp;</highlight><highlight class="keyword">&gt;</highlight><highlight class="normal">(tab_coeff_diffusif).view_ro();</highlight></codeline>
<codeline lineno="286"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>DoubleArrView<sp/>coeff<sp/>=<sp/>matrice_morse.<ref refid="classMatrice__Morse_1a3a016f4b3995a58b313cb47e66ebefd1" kindref="member">get_set_coeff</ref>().view_wo();</highlight></codeline>
<codeline lineno="287"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>is_not_generic<sp/>=<sp/>!<ref refid="classConvection__Diffusion__Fluide__Dilatable__Proto_1a1cb4fa5d4798eb6a58fa3791fbe4546d" kindref="member">is_generic</ref>();</highlight></codeline>
<codeline lineno="288"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>Matrice_Morse_View<sp/>matrice;</highlight></codeline>
<codeline lineno="289"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>matrice.set(matrice_morse);</highlight></codeline>
<codeline lineno="290"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>Kokkos::parallel_for(start_gpu_timer(__KERNEL_NAME__),<sp/>range_1D(0,<sp/>n),<sp/>KOKKOS_LAMBDA(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>som)</highlight></codeline>
<codeline lineno="291"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="292"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>inv_rho<sp/>=<sp/>1.<sp/>/<sp/>rho(som);</highlight></codeline>
<codeline lineno="293"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(is_not_generic)<sp/>inv_rho<sp/>=<sp/>1.;</highlight></codeline>
<codeline lineno="294"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>rapport<sp/>=<sp/>1.<sp/>/<sp/>rhoCp(som);</highlight></codeline>
<codeline lineno="295"><highlight class="normal"></highlight></codeline>
<codeline lineno="296"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>il<sp/>faut<sp/>multiplier<sp/>toute<sp/>la<sp/>ligne<sp/>de<sp/>la<sp/>matrice<sp/>par<sp/>rapport</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="297"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>k=tab1(som)-1;<sp/>k&lt;tab1(som+1)-1;<sp/>k++)</highlight></codeline>
<codeline lineno="298"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>coeff(k)=<sp/>(coeff(k)*inv_rho+coeff_diffusif(k)*rapport);</highlight></codeline>
<codeline lineno="299"><highlight class="normal"></highlight></codeline>
<codeline lineno="300"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>ajout<sp/>de<sp/>Tdiv(rhou<sp/>)/rho</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="301"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>matrice.add(som,som,derivee2(som)*inv_rho);</highlight></codeline>
<codeline lineno="302"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>});</highlight></codeline>
<codeline lineno="303"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>end_gpu_timer(__KERNEL_NAME__);</highlight></codeline>
<codeline lineno="304"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="305"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="306"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="307"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>Cerr&lt;&lt;</highlight><highlight class="stringliteral">&quot;The<sp/>implicit<sp/>algorithm<sp/>is<sp/>available<sp/>only<sp/>for<sp/>perfect<sp/>gas.&quot;</highlight><highlight class="normal">&lt;&lt;finl;</highlight></codeline>
<codeline lineno="308"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classProcess_1acc2fbbe761e08e5870ae605c0705491c" kindref="member">Process::exit</ref>();</highlight></codeline>
<codeline lineno="309"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="310"><highlight class="normal"></highlight></codeline>
<codeline lineno="311"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>on<sp/>a<sp/>la<sp/>matrice<sp/>approchee<sp/>on<sp/>recalcule<sp/>le<sp/>residu;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="312"><highlight class="normal"><sp/><sp/>resu=0;</highlight></codeline>
<codeline lineno="313"><highlight class="normal"><sp/><sp/><ref refid="classConvection__Diffusion__Fluide__Dilatable__Proto_1a2f09516e23af998bef35700d625abb50" kindref="member">derivee_en_temps_inco_sans_solveur_masse_impl</ref>(eqn,resu,</highlight><highlight class="keyword">false</highlight><highlight class="normal"><sp/></highlight><highlight class="comment">/*<sp/>implicit<sp/>*/</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="314"><highlight class="normal"><sp/><sp/>matrice_morse.<ref refid="classMatrice__Base_1aed652de189a541ffa30f802e407696cd" kindref="member">ajouter_multvect</ref>(inco,resu);</highlight></codeline>
<codeline lineno="315"><highlight class="normal"></highlight></codeline>
<codeline lineno="316"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(test_op)</highlight></codeline>
<codeline lineno="317"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="318"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classTRUSTTrav" kindref="compound">DoubleTrav</ref><sp/>diff(resu),<sp/>conv(resu);</highlight></codeline>
<codeline lineno="319"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>eqn.<ref refid="classConvection__Diffusion__std_1acfb3e5da249873b1f878c2aa5868e534" kindref="member">operateur</ref>(0).<ref refid="classOperateur_1a1f3e24efd9b54d05821e731fe4bd6027" kindref="member">l_op_base</ref>().<ref refid="classOperateur__base_1abbebdc80dad39b8a5ec3058379113a52" kindref="member">contribuer_au_second_membre</ref>(diff);</highlight></codeline>
<codeline lineno="320"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>eqn.<ref refid="classConvection__Diffusion__std_1acfb3e5da249873b1f878c2aa5868e534" kindref="member">operateur</ref>(1).<ref refid="classOperateur_1a1f3e24efd9b54d05821e731fe4bd6027" kindref="member">l_op_base</ref>().<ref refid="classOperateur__base_1abbebdc80dad39b8a5ec3058379113a52" kindref="member">contribuer_au_second_membre</ref>(conv);</highlight></codeline>
<codeline lineno="321"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>eqn.<ref refid="classEquation__base_1a3c8ac50e3e7b6ed29024a43e828a5396" kindref="member">sources</ref>().<ref refid="classSources_1aee196746a5ec214061c0a84814e68117" kindref="member">ajouter</ref>(diff);</highlight></codeline>
<codeline lineno="322"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>Cp<sp/>=<sp/>-5.;</highlight></codeline>
<codeline lineno="323"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>is_cp_unif=<sp/>sub_type(<ref refid="classChamp__Uniforme" kindref="compound">Champ_Uniforme</ref>,fluide_dil.<ref refid="classMilieu__base_1a5f213810b7fa8ec62690f5112d7e4529" kindref="member">capacite_calorifique</ref>());</highlight></codeline>
<codeline lineno="324"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="classTRUSTTab" kindref="compound">DoubleTab</ref>&amp;<sp/>tab_cp<sp/>=<sp/>fluide_dil.<ref refid="classMilieu__base_1a5f213810b7fa8ec62690f5112d7e4529" kindref="member">capacite_calorifique</ref>().<ref refid="classChamp__Don__base_1a4aa2e32a7db15b66f4118f279e1633db" kindref="member">valeurs</ref>();</highlight></codeline>
<codeline lineno="325"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(is_cp_unif)<sp/>Cp=tab_cp(0,0);</highlight></codeline>
<codeline lineno="326"><highlight class="normal"></highlight></codeline>
<codeline lineno="327"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>som=0<sp/>;<sp/>som&lt;n<sp/>;<sp/>som++)</highlight></codeline>
<codeline lineno="328"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="329"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!is_cp_unif)<sp/>Cp=tab_cp(som);</highlight></codeline>
<codeline lineno="330"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>inv_rho=1./tab_rho(som);</highlight></codeline>
<codeline lineno="331"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!<ref refid="classConvection__Diffusion__Fluide__Dilatable__Proto_1a1cb4fa5d4798eb6a58fa3791fbe4546d" kindref="member">is_generic</ref>())<sp/>inv_rho=1;</highlight></codeline>
<codeline lineno="332"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>rapport=1./(tab_rho(som)*Cp);</highlight></codeline>
<codeline lineno="333"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>diff(som)=resu(som)-conv(som)*inv_rho-diff(som)*rapport;</highlight></codeline>
<codeline lineno="334"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="335"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>eqn.<ref refid="classEquation__base_1a4b4effb48f1841ec8c743d6eb29f8a51" kindref="member">solv_masse</ref>().<ref refid="classSolveur__Masse__base_1acb67cf99305704c37379cda2d3a2358a" kindref="member">appliquer</ref>(diff);</highlight></codeline>
<codeline lineno="336"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>err=mp_max_abs_vect(diff);</highlight></codeline>
<codeline lineno="337"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>Cerr<sp/>&lt;&lt;<sp/>eqn.<ref refid="classObjet__U_1a58289bb63283588d31dc69b87b3f1d55" kindref="member">que_suis_je</ref>()<sp/>&lt;&lt;</highlight><highlight class="stringliteral">&quot;<sp/>:<sp/>Erreur<sp/>assemblage<sp/>=<sp/>&quot;</highlight><highlight class="normal"><sp/>&lt;&lt;<sp/>err<sp/>&lt;&lt;<sp/>finl;;</highlight></codeline>
<codeline lineno="338"><highlight class="normal"></highlight></codeline>
<codeline lineno="339"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(err<sp/>&gt;<sp/>1.e-5)</highlight></codeline>
<codeline lineno="340"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="341"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classTRUSTVect" kindref="compound">DoubleVect</ref>&amp;<sp/>diff_=diff;</highlight></codeline>
<codeline lineno="342"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Cerr&lt;&lt;</highlight><highlight class="stringliteral">&quot;<sp/>size<sp/>&quot;</highlight><highlight class="normal">&lt;&lt;<sp/>diff_.<ref refid="classTRUSTVect_1a0a3b16fb39def99371b91ec218ef138b" kindref="member">size</ref>()&lt;&lt;finl;</highlight></codeline>
<codeline lineno="343"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>i=0;<sp/>i&lt;diff_.<ref refid="classTRUSTVect_1a0a3b16fb39def99371b91ec218ef138b" kindref="member">size</ref>();<sp/>i++)</highlight></codeline>
<codeline lineno="344"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(std::fabs(diff_(i))&gt;1e-5)<sp/>Cerr&lt;&lt;i<sp/>&lt;&lt;<sp/></highlight><highlight class="stringliteral">&quot;<sp/>&quot;</highlight><highlight class="normal">&lt;&lt;<sp/>diff_(i)&lt;&lt;<sp/></highlight><highlight class="stringliteral">&quot;<sp/>&quot;</highlight><highlight class="normal">&lt;&lt;finl;</highlight></codeline>
<codeline lineno="345"><highlight class="normal"></highlight></codeline>
<codeline lineno="346"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(test_op==1)</highlight></codeline>
<codeline lineno="347"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="348"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Cerr&lt;&lt;</highlight><highlight class="stringliteral">&quot;<sp/>pb<sp/>max<sp/>case<sp/>&quot;</highlight><highlight class="normal">&lt;&lt;imin_array(diff)&lt;&lt;</highlight><highlight class="stringliteral">&quot;<sp/>ou<sp/>&quot;</highlight><highlight class="normal"><sp/>&lt;&lt;imax_array(diff)&lt;&lt;finl;</highlight></codeline>
<codeline lineno="349"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classProcess_1acc2fbbe761e08e5870ae605c0705491c" kindref="member">Process::exit</ref>();</highlight></codeline>
<codeline lineno="350"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="351"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="352"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="353"><highlight class="normal">}<sp/></highlight><highlight class="comment">/*<sp/>END<sp/>assembler_impl<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="354"><highlight class="normal"></highlight></codeline>
<codeline lineno="355" refid="classConvection__Diffusion__Fluide__Dilatable__Proto_1aef65ca43a14dca55ea4a7b038a49f884" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="classConvection__Diffusion__Fluide__Dilatable__Proto_1aef65ca43a14dca55ea4a7b038a49f884" kindref="member">Convection_Diffusion_Fluide_Dilatable_Proto::assembler_blocs</ref>(<ref refid="classConvection__Diffusion__Fluide__Dilatable__base" kindref="compound">Convection_Diffusion_Fluide_Dilatable_base</ref>&amp;<sp/>eqn,matrices_t<sp/>matrices,<sp/><ref refid="classTRUSTTab" kindref="compound">DoubleTab</ref>&amp;<sp/>secmem,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>tabs_t&amp;<sp/>semi_impl)</highlight></codeline>
<codeline lineno="356"><highlight class="normal">{</highlight></codeline>
<codeline lineno="357"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>std::string&amp;<sp/>nom_inco<sp/>=<sp/>eqn.<ref refid="classConvection__Diffusion__Fluide__Dilatable__base_1ad0099f5dcff25353df74331eefab5e86" kindref="member">inconnue</ref>().<ref refid="classField__base_1a1a644c094b32b3923219f3afd6bcc075" kindref="member">le_nom</ref>().<ref refid="classNom_1a48e315ae2bd7856306802f9de2a13e52" kindref="member">getString</ref>();</highlight></codeline>
<codeline lineno="358"><highlight class="normal"><sp/><sp/><ref refid="classMatrice__Morse" kindref="compound">Matrice_Morse</ref><sp/>*mat<sp/>=<sp/>matrices.count(nom_inco)?matrices.at(nom_inco):</highlight><highlight class="keyword">nullptr</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="359"><highlight class="normal"></highlight></codeline>
<codeline lineno="360"><highlight class="normal"><sp/><sp/><ref refid="classFluide__Dilatable__base" kindref="compound">Fluide_Dilatable_base</ref>&amp;<sp/>fluide_dil<sp/>=<sp/>eqn.<ref refid="classConvection__Diffusion__Fluide__Dilatable__base_1a6d7cf454d1eb069395626618326290e3" kindref="member">fluide</ref>();</highlight></codeline>
<codeline lineno="361"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="classTRUSTTab" kindref="compound">DoubleTab</ref>&amp;<sp/>tab_rho<sp/>=<sp/>fluide_dil.<ref refid="classMilieu__base_1ab8ce0742ed6681306999931dca88a5b9" kindref="member">masse_volumique</ref>().<ref refid="classChamp__Proto_1a9d8c69f11d1b0a8e378cc6ca41793614" kindref="member">valeurs</ref>();</highlight></codeline>
<codeline lineno="362"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>n<sp/>=<sp/>tab_rho.<ref refid="classTRUSTTab_1aee55d6851cd43d179ec3c46262fa0aad" kindref="member">dimension</ref>(0);</highlight></codeline>
<codeline lineno="363"><highlight class="normal"></highlight></codeline>
<codeline lineno="364"><highlight class="normal"><sp/><sp/><ref refid="classMatrice__Morse" kindref="compound">Matrice_Morse</ref><sp/>mat_diff(*mat);</highlight></codeline>
<codeline lineno="365"><highlight class="normal"><sp/><sp/><ref refid="classTRUSTTab" kindref="compound">DoubleTab</ref><sp/>secmem_tmp(secmem);</highlight></codeline>
<codeline lineno="366"><highlight class="normal"><sp/><sp/>eqn.<ref refid="classConvection__Diffusion__std_1acfb3e5da249873b1f878c2aa5868e534" kindref="member">operateur</ref>(0).<ref refid="classOperateur_1a1f3e24efd9b54d05821e731fe4bd6027" kindref="member">l_op_base</ref>().<ref refid="classOperateur__base_1aec5922f1a3a0a064dbc94b8d371ad92d" kindref="member">ajouter_blocs</ref>({{nom_inco,<sp/>&amp;mat_diff}},<sp/>secmem_tmp,<sp/>semi_impl);</highlight></codeline>
<codeline lineno="367"><highlight class="normal"><sp/><sp/>statistics().<ref refid="classPerf__counters_1ad528e593c4ea8c18b317fef30632b053" kindref="member">end_count</ref>(STD_COUNTERS::matrix_assembly);</highlight></codeline>
<codeline lineno="368"><highlight class="normal"></highlight></codeline>
<codeline lineno="369"><highlight class="normal"><sp/><sp/>statistics().<ref refid="classPerf__counters_1a8234efa62abcd428fe3df51699090290" kindref="member">begin_count</ref>(STD_COUNTERS::rhs,statistics().get_last_opened_counter_level()+1);</highlight></codeline>
<codeline lineno="370"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>i<sp/>=<sp/>0;<sp/>i<sp/>&lt;<sp/>eqn.<ref refid="classEquation__base_1a3c8ac50e3e7b6ed29024a43e828a5396" kindref="member">sources</ref>().size();<sp/>i++)</highlight></codeline>
<codeline lineno="371"><highlight class="normal"><sp/><sp/><sp/><sp/>eqn.<ref refid="classEquation__base_1a3c8ac50e3e7b6ed29024a43e828a5396" kindref="member">sources</ref>()(i)-&gt;ajouter_blocs({{nom_inco,<sp/>&amp;mat_diff}},<sp/>secmem_tmp,<sp/>semi_impl);</highlight></codeline>
<codeline lineno="372"><highlight class="normal"><sp/><sp/>statistics().<ref refid="classPerf__counters_1ad528e593c4ea8c18b317fef30632b053" kindref="member">end_count</ref>(STD_COUNTERS::rhs);</highlight></codeline>
<codeline lineno="373"><highlight class="normal"></highlight></codeline>
<codeline lineno="374"><highlight class="normal"><sp/><sp/>statistics().<ref refid="classPerf__counters_1a8234efa62abcd428fe3df51699090290" kindref="member">begin_count</ref>(STD_COUNTERS::matrix_assembly,statistics().get_last_opened_counter_level()+1);</highlight></codeline>
<codeline lineno="375"><highlight class="normal"><sp/><sp/><ref refid="classTRUSTVect" kindref="compound">DoubleVect</ref>&amp;<sp/>coeff_diffusif=mat_diff.<ref refid="classMatrice__Morse_1a3a016f4b3995a58b313cb47e66ebefd1" kindref="member">get_set_coeff</ref>();</highlight></codeline>
<codeline lineno="376"><highlight class="normal"></highlight></codeline>
<codeline lineno="377"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="classTRUSTVect" kindref="compound">IntVect</ref>&amp;<sp/>tab1=<sp/>mat-&gt;<ref refid="classMatrice__Morse_1adad29fc3bee7ca6ad5f023006aae7104" kindref="member">get_tab1</ref>();</highlight></codeline>
<codeline lineno="378"><highlight class="normal"><sp/><sp/><ref refid="classTRUSTVect" kindref="compound">DoubleVect</ref>&amp;<sp/>coeff=mat-&gt;<ref refid="classMatrice__Morse_1a3a016f4b3995a58b313cb47e66ebefd1" kindref="member">get_set_coeff</ref>();</highlight></codeline>
<codeline lineno="379"><highlight class="normal"><sp/><sp/>coeff<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="380"><highlight class="normal"><sp/><sp/>eqn.<ref refid="classConvection__Diffusion__std_1acfb3e5da249873b1f878c2aa5868e534" kindref="member">operateur</ref>(1).<ref refid="classOperateur_1a1f3e24efd9b54d05821e731fe4bd6027" kindref="member">l_op_base</ref>().<ref refid="classOperateur__base_1aec5922f1a3a0a064dbc94b8d371ad92d" kindref="member">ajouter_blocs</ref>(matrices,<sp/>secmem_tmp,<sp/>semi_impl);</highlight></codeline>
<codeline lineno="381"><highlight class="normal"></highlight></codeline>
<codeline lineno="382"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>on<sp/>calcule<sp/>div(rho<sp/>*<sp/>u)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="383"><highlight class="normal"><sp/><sp/><ref refid="classConvection__Diffusion__Fluide__Dilatable__Proto_1ac654cf15f0945a632fdca7d6b972c1c1" kindref="member">calculer_div_u_ou_div_rhou</ref>(secmem);</highlight></codeline>
<codeline lineno="384"><highlight class="normal"></highlight></codeline>
<codeline lineno="385"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!<ref refid="classConvection__Diffusion__Fluide__Dilatable__Proto_1a3cc3059c8760b4df630b37cb928c34eb" kindref="member">is_thermal</ref>())<sp/></highlight><highlight class="comment">//espece</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="386"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="387"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>som=0<sp/>;<sp/>som&lt;n<sp/>;<sp/>som++)</highlight></codeline>
<codeline lineno="388"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="389"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>inv_rho<sp/>=<sp/>1.<sp/>/<sp/>tab_rho(som);</highlight></codeline>
<codeline lineno="390"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>k=tab1(som)-1;<sp/>k&lt;tab1(som+1)-1;<sp/>k++)<sp/>coeff(k)=<sp/>(coeff(k)*inv_rho+coeff_diffusif(k)*inv_rho);</highlight></codeline>
<codeline lineno="391"><highlight class="normal"></highlight></codeline>
<codeline lineno="392"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(mat)<sp/>(*mat)(som,som)+=secmem(som)*inv_rho;</highlight></codeline>
<codeline lineno="393"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="394"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="395"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="classConvection__Diffusion__Fluide__Dilatable__Proto_1a3cc3059c8760b4df630b37cb928c34eb" kindref="member">is_thermal</ref>()<sp/>&amp;&amp;<sp/>fluide_dil.<ref refid="classFluide__Dilatable__base_1ae343729fcb0eed11da2aef064d747033" kindref="member">type_fluide</ref>()==</highlight><highlight class="stringliteral">&quot;Gaz_Parfait&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="396"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="397"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>fluide_dil.<ref refid="classFluide__Dilatable__base_1abd50eacc971f7afab19a87adde5f38f7" kindref="member">update_rho_cp</ref>(eqn.<ref refid="classEquation__base_1abc11e51aa75b4c7aa55c27f71eb2f2c4" kindref="member">schema_temps</ref>().<ref refid="classSchema__Temps__base_1a1e573b93ad40c737ecb2da65b68f968a" kindref="member">temps_courant</ref>());</highlight></codeline>
<codeline lineno="398"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="classTRUSTTab" kindref="compound">DoubleTab</ref>&amp;<sp/>rhoCp<sp/>=<sp/>eqn.<ref refid="classEquation__base_1a57ba60a2c32601e3441c838ab2d74332" kindref="member">get_champ</ref>(</highlight><highlight class="stringliteral">&quot;rho_cp_comme_T&quot;</highlight><highlight class="normal">).<ref refid="classChamp__Proto_1a9d8c69f11d1b0a8e378cc6ca41793614" kindref="member">valeurs</ref>();</highlight></codeline>
<codeline lineno="399"><highlight class="normal"></highlight></codeline>
<codeline lineno="400"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>som=0<sp/>;<sp/>som&lt;n<sp/>;<sp/>som++)</highlight></codeline>
<codeline lineno="401"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="402"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>inv_rho<sp/>=<sp/>1.<sp/>/<sp/>tab_rho(som);</highlight></codeline>
<codeline lineno="403"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!<ref refid="classConvection__Diffusion__Fluide__Dilatable__Proto_1a1cb4fa5d4798eb6a58fa3791fbe4546d" kindref="member">is_generic</ref>())<sp/>inv_rho<sp/>=<sp/>1.;</highlight></codeline>
<codeline lineno="404"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>rapport<sp/>=<sp/>1.<sp/>/<sp/>rhoCp(som);</highlight></codeline>
<codeline lineno="405"><highlight class="normal"></highlight></codeline>
<codeline lineno="406"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>il<sp/>faut<sp/>multiplier<sp/>toute<sp/>la<sp/>ligne<sp/>de<sp/>la<sp/>matrice<sp/>par<sp/>rapport</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="407"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>k=tab1(som)-1;<sp/>k&lt;tab1(som+1)-1;<sp/>k++)<sp/>coeff(k)=<sp/>(coeff(k)*inv_rho+coeff_diffusif(k)*rapport);</highlight></codeline>
<codeline lineno="408"><highlight class="normal"></highlight></codeline>
<codeline lineno="409"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>ajout<sp/>de<sp/>Tdiv(rhou<sp/>)/rho</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="410"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(mat)<sp/>(*mat)(som,som)<sp/>+=<sp/>secmem(som)*inv_rho;</highlight></codeline>
<codeline lineno="411"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="412"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="413"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="414"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="415"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>Cerr&lt;&lt;</highlight><highlight class="stringliteral">&quot;The<sp/>implicit<sp/>algorithm<sp/>is<sp/>available<sp/>only<sp/>for<sp/>perfect<sp/>gas.&quot;</highlight><highlight class="normal">&lt;&lt;finl;</highlight></codeline>
<codeline lineno="416"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classProcess_1acc2fbbe761e08e5870ae605c0705491c" kindref="member">Process::exit</ref>();</highlight></codeline>
<codeline lineno="417"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="418"><highlight class="normal"></highlight></codeline>
<codeline lineno="419"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>on<sp/>a<sp/>la<sp/>matrice<sp/>approchee<sp/>on<sp/>recalcule<sp/>le<sp/>residu;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="420"><highlight class="normal"><sp/><sp/>secmem=0;</highlight></codeline>
<codeline lineno="421"><highlight class="normal"><sp/><sp/><ref refid="classConvection__Diffusion__Fluide__Dilatable__Proto_1a2f09516e23af998bef35700d625abb50" kindref="member">derivee_en_temps_inco_sans_solveur_masse_impl</ref>(eqn,secmem,</highlight><highlight class="keyword">false</highlight><highlight class="normal"><sp/></highlight><highlight class="comment">/*<sp/>implicit<sp/>*/</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="422"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(mat)<sp/>mat-&gt;<ref refid="classMatrice__Base_1aed652de189a541ffa30f802e407696cd" kindref="member">ajouter_multvect</ref>(eqn.<ref refid="classConvection__Diffusion__Fluide__Dilatable__base_1ad0099f5dcff25353df74331eefab5e86" kindref="member">inconnue</ref>().<ref refid="classChamp__Inc__base_1af36cd0a3fe8ed6bc529a263261a0f5a8" kindref="member">valeurs</ref>(),secmem);</highlight></codeline>
<codeline lineno="423"><highlight class="normal">}</highlight></codeline>
<codeline lineno="424"><highlight class="normal"></highlight></codeline>
<codeline lineno="425"><highlight class="normal"></highlight><highlight class="comment">/*</highlight></codeline>
<codeline lineno="426"><highlight class="comment"><sp/>*<sp/>Methodes<sp/>statiques</highlight></codeline>
<codeline lineno="427"><highlight class="comment"><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="428"><highlight class="normal"></highlight></codeline>
<codeline lineno="429" refid="classConvection__Diffusion__Fluide__Dilatable__Proto_1a216d7310d623f3131b285bf59debe23d" refkind="member"><highlight class="normal">std::vector&lt;YAML_data&gt;<sp/><ref refid="classConvection__Diffusion__Fluide__Dilatable__Proto_1a216d7310d623f3131b285bf59debe23d" kindref="member">Convection_Diffusion_Fluide_Dilatable_Proto::data_a_sauvegarder</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="classConvection__Diffusion__std" kindref="compound">Convection_Diffusion_std</ref>&amp;<sp/>eq,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="classFluide__Dilatable__base" kindref="compound">Fluide_Dilatable_base</ref>&amp;<sp/>fld)</highlight></codeline>
<codeline lineno="430"><highlight class="normal">{</highlight></codeline>
<codeline lineno="431"><highlight class="normal"><sp/><sp/>std::vector&lt;YAML_data&gt;<sp/>data<sp/>=<sp/>eq.<ref refid="classConvection__Diffusion__std_1a03a8ea82b9f455bfdcabdfd1ab16a94a" kindref="member">data_a_sauvegarder_base</ref>();</highlight></codeline>
<codeline lineno="432"><highlight class="normal"></highlight></codeline>
<codeline lineno="433"><highlight class="normal"><sp/><sp/><ref refid="classFluide__Weakly__Compressible" kindref="compound">Fluide_Weakly_Compressible</ref>&amp;<sp/>FWC<sp/>=<sp/>ref_cast_non_const(<ref refid="classFluide__Weakly__Compressible" kindref="compound">Fluide_Weakly_Compressible</ref>,fld);</highlight></codeline>
<codeline lineno="434"><highlight class="normal"><sp/><sp/><ref refid="classConvection__Diffusion__Fluide__Dilatable__Proto_1a74da8be6404e7dedb6e25f56a2a3fc91" kindref="member">OWN_PTR</ref>(<ref refid="classChamp__Inc__base" kindref="compound">Champ_Inc_base</ref>)<sp/>p_tab<sp/>=<sp/>FWC.<ref refid="classFluide__Dilatable__base_1a6a7f25adfa719aa90aaaa585f830ed6a" kindref="member">inco_chaleur</ref>();<sp/></highlight><highlight class="comment">//<sp/>Initialize<sp/>with<sp/>same<sp/>discretization</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="435"><highlight class="normal"><sp/><sp/>std::string<sp/>name<sp/>=<sp/>eq.<ref refid="classEquation__base_1aa8151a96f63719523bf50ddd832e0f8f" kindref="member">probleme</ref>().<ref refid="classProbleme__U_1a6b88bc3049405b56bc32ce2afb68ef0a" kindref="member">le_nom</ref>().<ref refid="classNom_1a48e315ae2bd7856306802f9de2a13e52" kindref="member">getString</ref>()<sp/>+<sp/></highlight><highlight class="stringliteral">&quot;_Pression_EOS&quot;</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="436"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>nb_dim<sp/>=<sp/>p_tab-&gt;valeurs().nb_dim();</highlight></codeline>
<codeline lineno="437"><highlight class="normal"><sp/><sp/><ref refid="classYAML__data" kindref="compound">YAML_data</ref><sp/>pressure(name,<sp/></highlight><highlight class="stringliteral">&quot;double&quot;</highlight><highlight class="normal">,<sp/>nb_dim);</highlight></codeline>
<codeline lineno="438"><highlight class="normal"><sp/><sp/>data.push_back(pressure);</highlight></codeline>
<codeline lineno="439"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>data;</highlight></codeline>
<codeline lineno="440"><highlight class="normal">}</highlight></codeline>
<codeline lineno="441"><highlight class="normal"></highlight></codeline>
<codeline lineno="442" refid="classConvection__Diffusion__Fluide__Dilatable__Proto_1acb0976593376c9f67b7a9fa2b837e7c2" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="classConvection__Diffusion__Fluide__Dilatable__Proto_1acb0976593376c9f67b7a9fa2b837e7c2" kindref="member">Convection_Diffusion_Fluide_Dilatable_Proto::Sauvegarder_WC</ref>(<ref refid="classSortie" kindref="compound">Sortie</ref>&amp;<sp/>os,</highlight></codeline>
<codeline lineno="443"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="classConvection__Diffusion__std" kindref="compound">Convection_Diffusion_std</ref>&amp;<sp/>eq,</highlight></codeline>
<codeline lineno="444"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="classFluide__Dilatable__base" kindref="compound">Fluide_Dilatable_base</ref>&amp;<sp/>fld)</highlight></codeline>
<codeline lineno="445"><highlight class="normal">{</highlight></codeline>
<codeline lineno="446"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>bytes=0,a_faire,special;</highlight></codeline>
<codeline lineno="447"><highlight class="normal"><sp/><sp/>bytes<sp/>+=<sp/>eq.<ref refid="classConvection__Diffusion__std_1a8d505acd31c2defd6ae53d3e09468547" kindref="member">sauvegarder_base</ref>(os);<sp/></highlight><highlight class="comment">//<sp/>XXX<sp/>:<sp/>voir<sp/>Convection_Diffusion_std</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="448"><highlight class="normal"><sp/><sp/><ref refid="classEcritureLectureSpecial_1a449e40a68eeabf8e552f23d8e4c32bcf" kindref="member">EcritureLectureSpecial::is_ecriture_special</ref>(special,a_faire);</highlight></codeline>
<codeline lineno="449"><highlight class="normal"></highlight></codeline>
<codeline lineno="450"><highlight class="normal"><sp/><sp/><ref refid="classFluide__Weakly__Compressible" kindref="compound">Fluide_Weakly_Compressible</ref>&amp;<sp/>FWC<sp/>=<sp/>ref_cast_non_const(<ref refid="classFluide__Weakly__Compressible" kindref="compound">Fluide_Weakly_Compressible</ref>,fld);</highlight></codeline>
<codeline lineno="451"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(a_faire)</highlight></codeline>
<codeline lineno="452"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="453"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classConvection__Diffusion__Fluide__Dilatable__Proto_1a74da8be6404e7dedb6e25f56a2a3fc91" kindref="member">OWN_PTR</ref>(<ref refid="classChamp__Inc__base" kindref="compound">Champ_Inc_base</ref>)<sp/>p_tab<sp/>=<sp/>FWC.<ref refid="classFluide__Dilatable__base_1a6a7f25adfa719aa90aaaa585f830ed6a" kindref="member">inco_chaleur</ref>();<sp/></highlight><highlight class="comment">//<sp/>Initialize<sp/>with<sp/>same<sp/>discretization</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="454"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>p_tab-&gt;<ref refid="classField__base_1a517704cb3a892cbe30c12e0d744277c7" kindref="member">nommer</ref>(</highlight><highlight class="stringliteral">&quot;Pression_EOS&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="455"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>p_tab-&gt;valeurs()<sp/>=<sp/>FWC.<ref refid="classFluide__Weakly__Compressible_1a761c72eb30b77a52bf6b079c8aff6356" kindref="member">pression_th_tab</ref>();<sp/></highlight><highlight class="comment">//<sp/>Use<sp/>good<sp/>values</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="456"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(special<sp/>&amp;&amp;<sp/><ref refid="classProcess_1a48ea49c199fc8961be575e571038b79a" kindref="member">Process::is_parallel</ref>())</highlight></codeline>
<codeline lineno="457"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Cerr<sp/>&lt;&lt;<sp/></highlight><highlight class="stringliteral">&quot;ATTENTION<sp/>:<sp/>For<sp/>a<sp/>parallel<sp/>calculation,<sp/>the<sp/>field<sp/>Pression_EOS<sp/>is<sp/>not<sp/>saved<sp/>in<sp/>xyz<sp/>format<sp/>...<sp/>&quot;</highlight><highlight class="normal"><sp/>&lt;&lt;<sp/>finl;</highlight></codeline>
<codeline lineno="458"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="459"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>bytes<sp/>+=<sp/>p_tab-&gt;sauvegarder(os);</highlight></codeline>
<codeline lineno="460"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="461"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="classTRUST__2__PDI_1aa24ab9abbbef571f8654d6b61b03cce7" kindref="member">TRUST_2_PDI::is_PDI_checkpoint</ref>())</highlight></codeline>
<codeline lineno="462"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="463"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Different<sp/>treatment<sp/>with<sp/>PDI<sp/>as<sp/>the<sp/>backup<sp/>will<sp/>be<sp/>triggered<sp/>later,<sp/>so<sp/>we<sp/>can&apos;t<sp/>share<sp/>a<sp/>temporary<sp/>pointer...</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="464"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="classTRUSTTab" kindref="compound">DoubleTab</ref>&amp;<sp/>p_th_tab<sp/>=<sp/>FWC.<ref refid="classFluide__Weakly__Compressible_1a761c72eb30b77a52bf6b079c8aff6356" kindref="member">pression_th_tab</ref>();</highlight></codeline>
<codeline lineno="465"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>std::string<sp/>name<sp/>=<sp/>eq.<ref refid="classEquation__base_1aa8151a96f63719523bf50ddd832e0f8f" kindref="member">probleme</ref>().<ref refid="classProbleme__U_1a6b88bc3049405b56bc32ce2afb68ef0a" kindref="member">le_nom</ref>().<ref refid="classNom_1a48e315ae2bd7856306802f9de2a13e52" kindref="member">getString</ref>()<sp/>+<sp/></highlight><highlight class="stringliteral">&quot;_Pression_EOS&quot;</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="466"><highlight class="normal"></highlight></codeline>
<codeline lineno="467"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Sharing<sp/>the<sp/>dimensions<sp/>of<sp/>the<sp/>unknown<sp/>field<sp/>with<sp/>PDI</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="468"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classTRUST__2__PDI" kindref="compound">TRUST_2_PDI</ref><sp/>pdi_interface;</highlight></codeline>
<codeline lineno="469"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>pdi_interface.<ref refid="classTRUST__2__PDI_1acffa8ee29b7c14e122539985ae8e34ad" kindref="member">share_TRUSTTab_dimensions</ref>(p_th_tab,<sp/>name,<sp/>1<sp/></highlight><highlight class="comment">/*write<sp/>mode*/</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="470"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Sharing<sp/>the<sp/>unknown<sp/>field<sp/>with<sp/>PDI</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="471"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>p_th_tab.<ref refid="classTRUSTTab_1ab6a60d41799bf143fad6ff74c6bb7253" kindref="member">dimension_tot</ref>(0)<sp/>)</highlight></codeline>
<codeline lineno="472"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pdi_interface.<ref refid="classTRUST__2__PDI_1af3f396ed40ada35bc9f4315828fbc017" kindref="member">TRUST_start_sharing</ref>(name,<sp/>p_th_tab.<ref refid="classTRUSTArray_1a62f5eeb66939850d54464bb1e9c34d3d" kindref="member">addr</ref>());</highlight></codeline>
<codeline lineno="473"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="474"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="475"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classTRUSTArray" kindref="compound">ArrOfDouble</ref><sp/>garbage(<sp/>p_th_tab.<ref refid="classTRUSTTab_1a829be3686b4cf6f076d1dc92870e18f9" kindref="member">nb_dim</ref>()<sp/>);</highlight></codeline>
<codeline lineno="476"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pdi_interface.<ref refid="classTRUST__2__PDI_1af3f396ed40ada35bc9f4315828fbc017" kindref="member">TRUST_start_sharing</ref>(name,<sp/>garbage.<ref refid="classTRUSTArray_1a62f5eeb66939850d54464bb1e9c34d3d" kindref="member">addr</ref>());</highlight></codeline>
<codeline lineno="477"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="478"><highlight class="normal"></highlight></codeline>
<codeline lineno="479"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>bytes<sp/>=<sp/>8<sp/>*<sp/>p_th_tab.<ref refid="classTRUSTArray_1a48b5aa02624ffdc0bad44ca38ddd1a1c" kindref="member">size_array</ref>();</highlight></codeline>
<codeline lineno="480"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="481"><highlight class="normal"></highlight></codeline>
<codeline lineno="482"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>bytes;</highlight></codeline>
<codeline lineno="483"><highlight class="normal">}</highlight></codeline>
<codeline lineno="484"><highlight class="normal"></highlight></codeline>
<codeline lineno="485" refid="classConvection__Diffusion__Fluide__Dilatable__Proto_1abfafe8aec90e12871145dfd2849bf278" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="classConvection__Diffusion__Fluide__Dilatable__Proto_1abfafe8aec90e12871145dfd2849bf278" kindref="member">Convection_Diffusion_Fluide_Dilatable_Proto::Reprendre_WC</ref>(<ref refid="classEntree" kindref="compound">Entree</ref>&amp;<sp/>is,</highlight></codeline>
<codeline lineno="486"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>temps,</highlight></codeline>
<codeline lineno="487"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classConvection__Diffusion__std" kindref="compound">Convection_Diffusion_std</ref>&amp;<sp/>eq,</highlight></codeline>
<codeline lineno="488"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classFluide__Dilatable__base" kindref="compound">Fluide_Dilatable_base</ref>&amp;<sp/>fld,</highlight></codeline>
<codeline lineno="489"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classChamp__Inc__base" kindref="compound">Champ_Inc_base</ref>&amp;<sp/>inco,</highlight></codeline>
<codeline lineno="490"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classProbleme__base" kindref="compound">Probleme_base</ref>&amp;<sp/>pb)</highlight></codeline>
<codeline lineno="491"><highlight class="normal">{</highlight></codeline>
<codeline lineno="492"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>start<sp/>resuming</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="493"><highlight class="normal"><sp/><sp/>eq.<ref refid="classConvection__Diffusion__std_1a87cba2432b9aa0215de377777fdf9e0f" kindref="member">reprendre_base</ref>(is);<sp/></highlight><highlight class="comment">//<sp/>XXX<sp/>:<sp/>voir<sp/>Convection_Diffusion_std</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="494"><highlight class="normal"></highlight></codeline>
<codeline lineno="495"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>XXX<sp/>:<sp/>should<sp/>be<sp/>set<sp/>so<sp/>that<sp/>Pression_EOS<sp/>is<sp/>read<sp/>and<sp/>not<sp/>initialized<sp/>from<sp/>data<sp/>file</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="496"><highlight class="normal"><sp/><sp/><ref refid="classFluide__Weakly__Compressible" kindref="compound">Fluide_Weakly_Compressible</ref>&amp;<sp/>FWC<sp/>=<sp/>ref_cast(<ref refid="classFluide__Weakly__Compressible" kindref="compound">Fluide_Weakly_Compressible</ref>,fld);</highlight></codeline>
<codeline lineno="497"><highlight class="normal"><sp/><sp/>FWC.<ref refid="classFluide__Weakly__Compressible_1a143eec89aa24e7b24e2fbdc3604e05e3" kindref="member">set_resume_flag</ref>();</highlight></codeline>
<codeline lineno="498"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>resume<sp/>EOS<sp/>pressure<sp/>field</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="499"><highlight class="normal"><sp/><sp/><ref refid="classConvection__Diffusion__Fluide__Dilatable__Proto_1a74da8be6404e7dedb6e25f56a2a3fc91" kindref="member">OWN_PTR</ref>(<ref refid="classChamp__Inc__base" kindref="compound">Champ_Inc_base</ref>)<sp/>p_tab<sp/>=<sp/>FWC.<ref refid="classFluide__Dilatable__base_1a6a7f25adfa719aa90aaaa585f830ed6a" kindref="member">inco_chaleur</ref>();<sp/></highlight><highlight class="comment">//<sp/>Initialize<sp/>with<sp/>same<sp/>discretization</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="500"><highlight class="normal"></highlight></codeline>
<codeline lineno="501"><highlight class="normal"><sp/><sp/>p_tab-&gt;<ref refid="classField__base_1a517704cb3a892cbe30c12e0d744277c7" kindref="member">nommer</ref>(</highlight><highlight class="stringliteral">&quot;Pression_EOS&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="502"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="classEcritureLectureSpecial_1a5fa89017be05d6f062f210e24e00361c" kindref="member">EcritureLectureSpecial::is_lecture_special</ref>()<sp/>&amp;&amp;<sp/><ref refid="classProcess_1a48ea49c199fc8961be575e571038b79a" kindref="member">Process::is_parallel</ref>())</highlight></codeline>
<codeline lineno="503"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="504"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>Cerr<sp/>&lt;&lt;<sp/></highlight><highlight class="stringliteral">&quot;Error<sp/>in<sp/>Convection_Diffusion_Espece_Binaire_WC::reprendre<sp/>!&quot;</highlight><highlight class="normal"><sp/>&lt;&lt;<sp/>finl;</highlight></codeline>
<codeline lineno="505"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>Cerr<sp/>&lt;&lt;<sp/></highlight><highlight class="stringliteral">&quot;Use<sp/>the<sp/>sauv<sp/>file<sp/>to<sp/>resume<sp/>a<sp/>parallel<sp/>WC<sp/>calculation<sp/>(Pression_EOS<sp/>is<sp/>required)<sp/>...<sp/>&quot;</highlight><highlight class="normal"><sp/>&lt;&lt;<sp/>finl;</highlight></codeline>
<codeline lineno="506"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classProcess_1acc2fbbe761e08e5870ae605c0705491c" kindref="member">Process::exit</ref>();</highlight></codeline>
<codeline lineno="507"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="508"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="509"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="510"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(!<ref refid="classTRUST__2__PDI_1abf2cc0e15286e61cc1506bda28cea966" kindref="member">TRUST_2_PDI::is_PDI_restart</ref>())</highlight></codeline>
<codeline lineno="511"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="512"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classNom" kindref="compound">Nom</ref><sp/>field_tag(p_tab-&gt;le_nom());</highlight></codeline>
<codeline lineno="513"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>field_tag<sp/>+=<sp/>p_tab-&gt;<ref refid="classObjet__U_1a58289bb63283588d31dc69b87b3f1d55" kindref="member">que_suis_je</ref>();</highlight></codeline>
<codeline lineno="514"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>field_tag<sp/>+=<sp/>pb.<ref refid="classProbleme__base_1a568d2900df6cf99cfe0cb15e92e2f08d" kindref="member">domaine</ref>().<ref refid="classDomaine__base_1a4d471628f422b28f513b30f45998de67" kindref="member">le_nom</ref>();</highlight></codeline>
<codeline lineno="515"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>field_tag<sp/>+=<sp/><ref refid="classNom" kindref="compound">Nom</ref>(temps,pb.<ref refid="classProbleme__base_1a3483a6a22897093d93aa0d6cf8363af9" kindref="member">reprise_format_temps</ref>());</highlight></codeline>
<codeline lineno="516"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>avancer_fichier(is,<sp/>field_tag);</highlight></codeline>
<codeline lineno="517"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="518"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>p_tab-&gt;reprendre(is);</highlight></codeline>
<codeline lineno="519"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="520"><highlight class="normal"></highlight></codeline>
<codeline lineno="521"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>set<sp/>good<sp/>field</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="522"><highlight class="normal"><sp/><sp/>FWC.<ref refid="classFluide__Weakly__Compressible_1aa872e7b99faaa01b2eda7a209714006f" kindref="member">set_pression_th_tab</ref>(p_tab-&gt;valeurs());</highlight></codeline>
<codeline lineno="523"><highlight class="normal"></highlight></codeline>
<codeline lineno="524"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>1;</highlight></codeline>
<codeline lineno="525"><highlight class="normal">}</highlight></codeline>
    </programlisting>
    <location file="/volatile/catA/gj277443/TRUST/sync-doc/src/ThHyd/Dilatable/Common/Equations/Convection_Diffusion_Fluide_Dilatable_Proto.cpp"/>
  </compounddef>
</doxygen>
