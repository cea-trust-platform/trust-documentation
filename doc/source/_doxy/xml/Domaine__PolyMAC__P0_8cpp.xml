<?xml version='1.0' encoding='UTF-8' standalone='no'?>
<doxygen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="compound.xsd" version="1.9.1" xml:lang="en-US">
  <compounddef id="Domaine__PolyMAC__P0_8cpp" kind="file" language="C++">
    <compoundname>Domaine_PolyMAC_P0.cpp</compoundname>
    <includes refid="Echange__contact__PolyMAC__P0_8h" local="no">Echange_contact_PolyMAC_P0.h</includes>
    <includes refid="Frottement__externe__impose_8h" local="no">Frottement_externe_impose.h</includes>
    <includes refid="Linear__algebra__tools__impl_8h" local="no">Linear_algebra_tools_impl.h</includes>
    <includes refid="Frottement__global__impose_8h" local="no">Frottement_global_impose.h</includes>
    <includes refid="Champ__implementation__P1_8h" local="no">Champ_implementation_P1.h</includes>
    <includes refid="Connectivite__som__elem_8h" local="no">Connectivite_som_elem.h</includes>
    <includes refid="MD__Vector__composite_8h" local="no">MD_Vector_composite.h</includes>
    <includes refid="Dirichlet__homogene_8h" local="no">Dirichlet_homogene.h</includes>
    <includes refid="MD__Vector__tools_8h" local="no">MD_Vector_tools.h</includes>
    <includes refid="Domaine__PolyMAC__P0_8h" local="no">Domaine_PolyMAC_P0.h</includes>
    <includes refid="Domaine__Cl__PolyMAC_8h" local="no">Domaine_Cl_PolyMAC.h</includes>
    <includes refid="TRUSTTab__parts_8h" local="no">TRUSTTab_parts.h</includes>
    <includes refid="Comm__Group__MPI_8h" local="no">Comm_Group_MPI.h</includes>
    <includes refid="Quadrangle__VEF_8h" local="no">Quadrangle_VEF.h</includes>
    <includes refid="communications_8h" local="no">communications.h</includes>
    <includes refid="Hexaedre__VEF_8h" local="no">Hexaedre_VEF.h</includes>
    <includes refid="Matrix__tools_8h" local="no">Matrix_tools.h</includes>
    <includes local="no">unordered_map</includes>
    <includes refid="Array__tools_8h" local="no">Array_tools.h</includes>
    <includes refid="TRUSTLists_8h" local="no">TRUSTLists.h</includes>
    <includes refid="Tetraedre_8h" local="no">Tetraedre.h</includes>
    <includes refid="Rectangle_8h" local="no">Rectangle.h</includes>
    <includes refid="PE__Groups_8h" local="no">PE_Groups.h</includes>
    <includes refid="Hexaedre_8h" local="no">Hexaedre.h</includes>
    <includes refid="Triangle_8h" local="no">Triangle.h</includes>
    <includes refid="EFichier_8h" local="no">EFichier.h</includes>
    <includes refid="SFichier_8h" local="no">SFichier.h</includes>
    <includes refid="Segment_8h" local="no">Segment.h</includes>
    <includes refid="Domaine_8h" local="no">Domaine.h</includes>
    <includes refid="Scatter_8h" local="no">Scatter.h</includes>
    <includes refid="EChaine_8h" local="no">EChaine.h</includes>
    <includes refid="LireMED_8h" local="no">LireMED.h</includes>
    <includes refid="Ecrire__MED_8h" local="no">Ecrire_MED.h</includes>
    <includes local="no">unistd.h</includes>
    <includes refid="Lapack_8h" local="no">Lapack.h</includes>
    <includes local="no">numeric</includes>
    <includes local="no">vector</includes>
    <includes local="no">cfloat</includes>
    <includes local="no">tuple</includes>
    <includes local="no">cmath</includes>
    <includes local="no">cfenv</includes>
    <includes local="no">set</includes>
    <includes local="no">map</includes>
    <incdepgraph>
      <node id="8">
        <label>cmath</label>
      </node>
      <node id="4">
        <label>numeric</label>
      </node>
      <node id="11">
        <label>map</label>
      </node>
      <node id="6">
        <label>cfloat</label>
      </node>
      <node id="7">
        <label>tuple</label>
      </node>
      <node id="3">
        <label>unistd.h</label>
      </node>
      <node id="5">
        <label>vector</label>
      </node>
      <node id="9">
        <label>cfenv</label>
      </node>
      <node id="2">
        <label>unordered_map</label>
      </node>
      <node id="10">
        <label>set</label>
      </node>
      <node id="1">
        <label>Domaine_PolyMAC_P0.cpp</label>
        <link refid="Domaine__PolyMAC__P0_8cpp"/>
        <childnode refid="2" relation="include">
        </childnode>
        <childnode refid="3" relation="include">
        </childnode>
        <childnode refid="4" relation="include">
        </childnode>
        <childnode refid="5" relation="include">
        </childnode>
        <childnode refid="6" relation="include">
        </childnode>
        <childnode refid="7" relation="include">
        </childnode>
        <childnode refid="8" relation="include">
        </childnode>
        <childnode refid="9" relation="include">
        </childnode>
        <childnode refid="10" relation="include">
        </childnode>
        <childnode refid="11" relation="include">
        </childnode>
      </node>
    </incdepgraph>
      <sectiondef kind="func">
      <memberdef kind="function" id="Domaine__PolyMAC__P0_8cpp_1ad76a475b36c9c86455a7a02495d7114b" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type></type>
        <definition>Implemente_instanciable</definition>
        <argsstring>(Domaine_PolyMAC_P0, &quot;Domaine_PolyMAC_P0&quot;, Domaine_PolyMAC_P0P1NC)</argsstring>
        <name>Implemente_instanciable</name>
        <param>
          <type><ref refid="classDomaine__PolyMAC__P0" kindref="compound">Domaine_PolyMAC_P0</ref></type>
        </param>
        <param>
          <type>&quot;Domaine_PolyMAC_P0&quot;</type>
        </param>
        <param>
          <type><ref refid="classDomaine__PolyMAC__P0P1NC" kindref="compound">Domaine_PolyMAC_P0P1NC</ref></type>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/volatile/catA/gj277443/TRUST/sync-doc/src/PolyMAC/Geometrie/Domaine_PolyMAC_P0.cpp" line="60" column="1" declfile="/volatile/catA/gj277443/TRUST/sync-doc/src/PolyMAC/Geometrie/Domaine_PolyMAC_P0.cpp" declline="60" declcolumn="1"/>
      </memberdef>
      </sectiondef>
    <briefdescription>
    </briefdescription>
    <detaileddescription>
    </detaileddescription>
    <programlisting>
<codeline lineno="1"><highlight class="comment">/****************************************************************************</highlight></codeline>
<codeline lineno="2"><highlight class="comment">*<sp/>Copyright<sp/>(c)<sp/>2025,<sp/>CEA</highlight></codeline>
<codeline lineno="3"><highlight class="comment">*<sp/>All<sp/>rights<sp/>reserved.</highlight></codeline>
<codeline lineno="4"><highlight class="comment">*</highlight></codeline>
<codeline lineno="5"><highlight class="comment">*<sp/>Redistribution<sp/>and<sp/>use<sp/>in<sp/>source<sp/>and<sp/>binary<sp/>forms,<sp/>with<sp/>or<sp/>without<sp/>modification,<sp/>are<sp/>permitted<sp/>provided<sp/>that<sp/>the<sp/>following<sp/>conditions<sp/>are<sp/>met:</highlight></codeline>
<codeline lineno="6"><highlight class="comment">*<sp/>1.<sp/>Redistributions<sp/>of<sp/>source<sp/>code<sp/>must<sp/>retain<sp/>the<sp/>above<sp/>copyright<sp/>notice,<sp/>this<sp/>list<sp/>of<sp/>conditions<sp/>and<sp/>the<sp/>following<sp/>disclaimer.</highlight></codeline>
<codeline lineno="7"><highlight class="comment">*<sp/>2.<sp/>Redistributions<sp/>in<sp/>binary<sp/>form<sp/>must<sp/>reproduce<sp/>the<sp/>above<sp/>copyright<sp/>notice,<sp/>this<sp/>list<sp/>of<sp/>conditions<sp/>and<sp/>the<sp/>following<sp/>disclaimer<sp/>in<sp/>the<sp/>documentation<sp/>and/or<sp/>other<sp/>materials<sp/>provided<sp/>with<sp/>the<sp/>distribution.</highlight></codeline>
<codeline lineno="8"><highlight class="comment">*<sp/>3.<sp/>Neither<sp/>the<sp/>name<sp/>of<sp/>the<sp/>copyright<sp/>holder<sp/>nor<sp/>the<sp/>names<sp/>of<sp/>its<sp/>contributors<sp/>may<sp/>be<sp/>used<sp/>to<sp/>endorse<sp/>or<sp/>promote<sp/>products<sp/>derived<sp/>from<sp/>this<sp/>software<sp/>without<sp/>specific<sp/>prior<sp/>written<sp/>permission.</highlight></codeline>
<codeline lineno="9"><highlight class="comment">*</highlight></codeline>
<codeline lineno="10"><highlight class="comment">*<sp/>THIS<sp/>SOFTWARE<sp/>IS<sp/>PROVIDED<sp/>BY<sp/>THE<sp/>COPYRIGHT<sp/>HOLDERS<sp/>AND<sp/>CONTRIBUTORS<sp/>&quot;AS<sp/>IS&quot;<sp/>AND<sp/>ANY<sp/>EXPRESS<sp/>OR<sp/>IMPLIED<sp/>WARRANTIES,<sp/>INCLUDING,<sp/>BUT<sp/>NOT<sp/>LIMITED<sp/>TO,<sp/>THE<sp/>IMPLIED<sp/>WARRANTIES<sp/>OF<sp/>MERCHANTABILITY<sp/>AND<sp/>FITNESS<sp/>FOR<sp/>A<sp/>PARTICULAR<sp/>PURPOSE<sp/>ARE<sp/>DISCLAIMED.</highlight></codeline>
<codeline lineno="11"><highlight class="comment">*<sp/>IN<sp/>NO<sp/>EVENT<sp/>SHALL<sp/>THE<sp/>COPYRIGHT<sp/>HOLDER<sp/>OR<sp/>CONTRIBUTORS<sp/>BE<sp/>LIABLE<sp/>FOR<sp/>ANY<sp/>DIRECT,<sp/>INDIRECT,<sp/>INCIDENTAL,<sp/>SPECIAL,<sp/>EXEMPLARY,<sp/>OR<sp/>CONSEQUENTIAL<sp/>DAMAGES<sp/>(INCLUDING,<sp/>BUT<sp/>NOT<sp/>LIMITED<sp/>TO,<sp/>PROCUREMENT<sp/>OF<sp/>SUBSTITUTE<sp/>GOODS<sp/>OR<sp/>SERVICES;<sp/>LOSS<sp/>OF<sp/>USE,<sp/>DATA,<sp/>OR<sp/>PROFITS;</highlight></codeline>
<codeline lineno="12"><highlight class="comment">*<sp/>OR<sp/>BUSINESS<sp/>INTERRUPTION)<sp/>HOWEVER<sp/>CAUSED<sp/>AND<sp/>ON<sp/>ANY<sp/>THEORY<sp/>OF<sp/>LIABILITY,<sp/>WHETHER<sp/>IN<sp/>CONTRACT,<sp/>STRICT<sp/>LIABILITY,<sp/>OR<sp/>TORT<sp/>(INCLUDING<sp/>NEGLIGENCE<sp/>OR<sp/>OTHERWISE)<sp/>ARISING<sp/>IN<sp/>ANY<sp/>WAY<sp/>OUT<sp/>OF<sp/>THE<sp/>USE<sp/>OF<sp/>THIS<sp/>SOFTWARE,<sp/>EVEN<sp/>IF<sp/>ADVISED<sp/>OF<sp/>THE<sp/>POSSIBILITY<sp/>OF<sp/>SUCH<sp/>DAMAGE.</highlight></codeline>
<codeline lineno="13"><highlight class="comment">*</highlight></codeline>
<codeline lineno="14"><highlight class="comment">*****************************************************************************/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="15"><highlight class="normal"></highlight></codeline>
<codeline lineno="16"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;Echange_contact_PolyMAC_P0.h&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="17"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;Frottement_externe_impose.h&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="18"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;Linear_algebra_tools_impl.h&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="19"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;Frottement_global_impose.h&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="20"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;Champ_implementation_P1.h&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="21"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;Connectivite_som_elem.h&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="22"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;MD_Vector_composite.h&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="23"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;Dirichlet_homogene.h&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="24"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;MD_Vector_tools.h&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="25"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;Domaine_PolyMAC_P0.h&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="26"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;Domaine_Cl_PolyMAC.h&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="27"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;TRUSTTab_parts.h&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="28"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;Comm_Group_MPI.h&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="29"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;Quadrangle_VEF.h&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="30"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;communications.h&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="31"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;Hexaedre_VEF.h&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="32"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;Matrix_tools.h&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="33"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;unordered_map&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="34"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;Array_tools.h&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="35"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;TRUSTLists.h&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="36"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;Tetraedre.h&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="37"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;Rectangle.h&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="38"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;PE_Groups.h&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="39"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;Hexaedre.h&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="40"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;Triangle.h&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="41"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;EFichier.h&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="42"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;SFichier.h&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="43"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;Segment.h&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="44"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;Domaine.h&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="45"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;Scatter.h&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="46"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;EChaine.h&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="47"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;LireMED.h&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="48"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;Ecrire_MED.h&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="49"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;unistd.h&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="50"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;Lapack.h&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="51"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;numeric&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="52"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;vector&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="53"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;cfloat&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="54"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;tuple&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="55"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;cmath&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="56"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;cfenv&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="57"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;set&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="58"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;map&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="59"><highlight class="normal"></highlight></codeline>
<codeline lineno="60"><highlight class="normal">Implemente_instanciable(<ref refid="classDomaine__PolyMAC__P0" kindref="compound">Domaine_PolyMAC_P0</ref>,<sp/></highlight><highlight class="stringliteral">&quot;Domaine_PolyMAC_P0&quot;</highlight><highlight class="normal">,<sp/><ref refid="classDomaine__PolyMAC__P0P1NC" kindref="compound">Domaine_PolyMAC_P0P1NC</ref>);</highlight></codeline>
<codeline lineno="61"><highlight class="normal"></highlight></codeline>
<codeline lineno="62"><highlight class="normal"><ref refid="classSortie" kindref="compound">Sortie</ref>&amp;<sp/><ref refid="classObjet__U_1af73113dc3d3e0dc9709e33ae566f5130" kindref="member">Domaine_PolyMAC_P0::printOn</ref>(<ref refid="classSortie" kindref="compound">Sortie</ref>&amp;<sp/>os)</highlight><highlight class="keyword"><sp/>const<sp/></highlight><highlight class="normal">{<sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="classObjet__U_1af73113dc3d3e0dc9709e33ae566f5130" kindref="member">Domaine_Poly_base::printOn</ref>(os);<sp/>}</highlight></codeline>
<codeline lineno="63"><highlight class="normal"></highlight></codeline>
<codeline lineno="64"><highlight class="normal"><ref refid="classEntree" kindref="compound">Entree</ref>&amp;<sp/><ref refid="classObjet__U_1a6f4c7788efee2dce629ebd1628b73288" kindref="member">Domaine_PolyMAC_P0::readOn</ref>(<ref refid="classEntree" kindref="compound">Entree</ref>&amp;<sp/>is)<sp/>{<sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="classObjet__U_1a6f4c7788efee2dce629ebd1628b73288" kindref="member">Domaine_Poly_base::readOn</ref>(is);<sp/>}</highlight></codeline>
<codeline lineno="65"><highlight class="normal"></highlight></codeline>
<codeline lineno="66" refid="classDomaine__PolyMAC__P0_1a81f5297954d333134b02b31e10fb4db6" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="classDomaine__PolyMAC__P0_1a81f5297954d333134b02b31e10fb4db6" kindref="member">Domaine_PolyMAC_P0::discretiser</ref>()</highlight></codeline>
<codeline lineno="67"><highlight class="normal">{</highlight></codeline>
<codeline lineno="68"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">/*<sp/>on<sp/>saut<sp/>le<sp/>discretiser()<sp/>de<sp/>Domaine_PolyMAC_P0P1NC<sp/>pour<sp/>eviter<sp/>d&apos;initialiser<sp/>les<sp/>variables<sp/>de<sp/>PolyMAC_P0P1NC_V1<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="69"><highlight class="normal"><sp/><sp/><ref refid="classDomaine__Poly__base_1aa2205bf4507a01372a8394ee1a164429" kindref="member">Domaine_Poly_base::discretiser</ref>();</highlight></codeline>
<codeline lineno="70"><highlight class="normal"></highlight></codeline>
<codeline lineno="71"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//MD_vector<sp/>pour<sp/>Champ_Face_PolyMAC_P0<sp/>(faces<sp/>+<sp/>dimension<sp/>*<sp/>champ_p0)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="72"><highlight class="normal"><sp/><sp/><ref refid="classMD__Vector__composite" kindref="compound">MD_Vector_composite</ref><sp/>mdc_ch_face;</highlight></codeline>
<codeline lineno="73"><highlight class="normal"><sp/><sp/>mdc_ch_face.<ref refid="classMD__Vector__composite_1a60bb667b9518bfa40252acd57fc99078" kindref="member">add_part</ref>(<ref refid="classDomaine__VF_1abe4ebe41b8a88e487c74998e9225d712" kindref="member">md_vector_faces</ref>());</highlight></codeline>
<codeline lineno="74"><highlight class="normal"><sp/><sp/>mdc_ch_face.<ref refid="classMD__Vector__composite_1a60bb667b9518bfa40252acd57fc99078" kindref="member">add_part</ref>(<ref refid="classDomaine__dis__base_1ad6c6511ebab85dea90d4d5320fee7ae2" kindref="member">domaine</ref>().md_vector_elements(),<sp/><ref refid="classObjet__U_1a3e23491c01f2f39245fb6f3b6d6d9b17" kindref="member">dimension</ref>);</highlight></codeline>
<codeline lineno="75"><highlight class="normal"><sp/><sp/><ref refid="classDomaine__PolyMAC__P0_1a900aaca5b696e893315485a7a81d4bb0" kindref="member">mdv_ch_face</ref>.<ref refid="classMD__Vector_1a063644dd8ca62e707a2d059eedeb58a7" kindref="member">copy</ref>(mdc_ch_face);</highlight></codeline>
<codeline lineno="76"><highlight class="normal">}</highlight></codeline>
<codeline lineno="77"><highlight class="normal"></highlight><highlight class="comment"></highlight></codeline>
<codeline lineno="78"><highlight class="comment">/*!<sp/>@brief<sp/>Initializes<sp/>the<sp/>face<sp/>stencils<sp/>for<sp/>gradient<sp/>computation</highlight></codeline>
<codeline lineno="79"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="80"><highlight class="comment"><sp/>*<sp/>This<sp/>method<sp/>builds<sp/>the<sp/>connectivity<sp/>stencils<sp/>required<sp/>for<sp/>face-based<sp/>gradient<sp/>calculations</highlight></codeline>
<codeline lineno="81"><highlight class="comment"><sp/>*<sp/>in<sp/>the<sp/>PolyMAC<sp/>P0<sp/>discretization<sp/>scheme.<sp/>It<sp/>establishes<sp/>the<sp/>relationship<sp/>between<sp/>faces</highlight></codeline>
<codeline lineno="82"><highlight class="comment"><sp/>*<sp/>and<sp/>all<sp/>elements/boundary<sp/>faces<sp/>that<sp/>are<sp/>connected<sp/>through<sp/>shared<sp/>vertices.</highlight></codeline>
<codeline lineno="83"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="84"><highlight class="comment"><sp/>*<sp/>The<sp/>stencil<sp/>for<sp/>each<sp/>face<sp/>includes:</highlight></codeline>
<codeline lineno="85"><highlight class="comment"><sp/>*<sp/>-<sp/>All<sp/>elements<sp/>connected<sp/>to<sp/>the<sp/>face<sp/>through<sp/>any<sp/>of<sp/>its<sp/>vertices</highlight></codeline>
<codeline lineno="86"><highlight class="comment"><sp/>*<sp/>-<sp/>All<sp/>boundary<sp/>faces<sp/>connected<sp/>to<sp/>the<sp/>face<sp/>through<sp/>shared<sp/>vertices</highlight></codeline>
<codeline lineno="87"><highlight class="comment"><sp/>*<sp/>-<sp/>The<sp/>face&apos;s<sp/>direct<sp/>neighboring<sp/>elements</highlight></codeline>
<codeline lineno="88"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="89"><highlight class="comment"><sp/>*<sp/>@note<sp/>This<sp/>method<sp/>is<sp/>called<sp/>lazily<sp/>-<sp/>it<sp/>only<sp/>performs<sp/>initialization<sp/>if<sp/>stencils</highlight></codeline>
<codeline lineno="90"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/>haven&apos;t<sp/>been<sp/>built<sp/>yet<sp/>(checked<sp/>via<sp/>fsten_d.size())</highlight></codeline>
<codeline lineno="91"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="92"><highlight class="comment"><sp/>*<sp/>@note<sp/>The<sp/>method<sp/>populates<sp/>two<sp/>main<sp/>data<sp/>structures:</highlight></codeline>
<codeline lineno="93"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/>-<sp/>fsten_d:<sp/>Index<sp/>array<sp/>for<sp/>stencil<sp/>boundaries</highlight></codeline>
<codeline lineno="94"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/>-<sp/>fsten_eb:<sp/>Flat<sp/>array<sp/>containing<sp/>all<sp/>stencil<sp/>elements/boundary<sp/>faces</highlight></codeline>
<codeline lineno="95"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="96"><highlight class="comment"><sp/>*<sp/>@details<sp/>Algorithm<sp/>overview:</highlight></codeline>
<codeline lineno="97"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>1.<sp/>Build<sp/>vertex-to-element<sp/>connectivity<sp/>(som_eb)</highlight></codeline>
<codeline lineno="98"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>2.<sp/>Add<sp/>boundary<sp/>faces<sp/>to<sp/>vertex<sp/>connectivity</highlight></codeline>
<codeline lineno="99"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>3.<sp/>For<sp/>each<sp/>face,<sp/>collect<sp/>all<sp/>elements/boundary<sp/>faces<sp/>connected<sp/>via<sp/>vertices</highlight></codeline>
<codeline lineno="100"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>4.<sp/>Store<sp/>results<sp/>in<sp/>compressed<sp/>sparse<sp/>format</highlight></codeline>
<codeline lineno="101"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="102"><highlight class="comment"><sp/>*<sp/>@post<sp/>After<sp/>execution:</highlight></codeline>
<codeline lineno="103"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/>-<sp/>fsten_d(f)<sp/>gives<sp/>the<sp/>starting<sp/>index<sp/>in<sp/>fsten_eb<sp/>for<sp/>face<sp/>f&apos;s<sp/>stencil</highlight></codeline>
<codeline lineno="104"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/>-<sp/>fsten_d(f+1)<sp/>gives<sp/>the<sp/>ending<sp/>index<sp/>(exclusive)<sp/>for<sp/>face<sp/>f&apos;s<sp/>stencil</highlight></codeline>
<codeline lineno="105"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/>-<sp/>fsten_eb<sp/>contains<sp/>the<sp/>actual<sp/>element/boundary<sp/>face<sp/>indices</highlight></codeline>
<codeline lineno="106"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/>-<sp/>Boundary<sp/>faces<sp/>are<sp/>represented<sp/>as<sp/>(ne_tot<sp/>+<sp/>face_index)</highlight></codeline>
<codeline lineno="107"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="108"><highlight class="comment"><sp/>*<sp/>@note<sp/>Memory<sp/>is<sp/>optimized<sp/>using<sp/>CRIMP()<sp/>to<sp/>reduce<sp/>storage<sp/>overhead</highlight></codeline>
<codeline lineno="109"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="110"><highlight class="comment"><sp/>*<sp/>@note<sp/>Only<sp/>processes<sp/>faces<sp/>that<sp/>have<sp/>at<sp/>least<sp/>one<sp/>valid<sp/>neighbor:</highlight></codeline>
<codeline lineno="111"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/>-<sp/>Internal<sp/>faces:<sp/>both<sp/>neighbors<sp/>must<sp/>be<sp/>valid</highlight></codeline>
<codeline lineno="112"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/>-<sp/>Boundary<sp/>faces:<sp/>at<sp/>least<sp/>one<sp/>neighbor<sp/>must<sp/>be<sp/>valid</highlight></codeline>
<codeline lineno="113"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="114"><highlight class="comment"><sp/>*<sp/>@see<sp/>fgrad()<sp/>which<sp/>uses<sp/>these<sp/>stencils<sp/>for<sp/>gradient<sp/>computation</highlight></codeline>
<codeline lineno="115"><highlight class="comment"><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="116" refid="classDomaine__PolyMAC__P0_1abf7f95be8390a773d2868b53391ce9d4" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="classDomaine__PolyMAC__P0_1abf7f95be8390a773d2868b53391ce9d4" kindref="member">Domaine_PolyMAC_P0::init_stencils</ref>()</highlight><highlight class="keyword"><sp/>const</highlight></codeline>
<codeline lineno="117"><highlight class="keyword"></highlight><highlight class="normal">{</highlight></codeline>
<codeline lineno="118"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="classDomaine__PolyMAC__P0_1af6cdf6aa2e97688740c497eb277486cb" kindref="member">fsten_d</ref>.<ref refid="classTRUSTVect_1a0a3b16fb39def99371b91ec218ef138b" kindref="member">size</ref>())</highlight></codeline>
<codeline lineno="119"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="120"><highlight class="normal"></highlight></codeline>
<codeline lineno="121"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="classTRUSTTab" kindref="compound">IntTab</ref>&amp;<sp/>f_s<sp/>=<sp/><ref refid="classDomaine__VF_1a1b186007308d9ffdab7536ecc4b376bd" kindref="member">face_sommets</ref>(),<sp/>&amp;f_e<sp/>=<sp/><ref refid="classDomaine__VF_1afd20cfa68ee7df4a932b135a9543fc9f" kindref="member">face_voisins</ref>(),<sp/>&amp;e_s<sp/>=<sp/><ref refid="classDomaine__dis__base_1ad6c6511ebab85dea90d4d5320fee7ae2" kindref="member">domaine</ref>().<ref refid="classDomaine__32__64_1a8d4770d77b73b3580c52ea6271a48318" kindref="member">les_elems</ref>();</highlight></codeline>
<codeline lineno="122"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>ne_tot<sp/>=<sp/><ref refid="classDomaine__dis__base_1a33e55ca05b2a53a3a5e1f844e2551824" kindref="member">nb_elem_tot</ref>(),<sp/>ns_tot<sp/>=<sp/><ref refid="classDomaine__dis__base_1ad6c6511ebab85dea90d4d5320fee7ae2" kindref="member">domaine</ref>().<ref refid="classDomaine__32__64_1ae3b29af56d930eb26c6abb514fc33fac" kindref="member">nb_som_tot</ref>();</highlight></codeline>
<codeline lineno="123"><highlight class="normal"><sp/><sp/><ref refid="classDomaine__PolyMAC__P0_1af6cdf6aa2e97688740c497eb277486cb" kindref="member">fsten_d</ref>.<ref refid="classTRUSTTab_1a9b2632fe559a20c048cbfddc5c40ed16" kindref="member">resize</ref>(1);</highlight></codeline>
<codeline lineno="124"><highlight class="normal"></highlight></codeline>
<codeline lineno="125"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">/*<sp/>connectivite<sp/>sommets<sp/>-&gt;<sp/>elems<sp/>/<sp/>faces<sp/>de<sp/>bord<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="126"><highlight class="normal"><sp/><sp/>std::vector&lt;std::set&lt;int&gt;&gt;<sp/>som_eb(ns_tot);</highlight></codeline>
<codeline lineno="127"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>e<sp/>=<sp/>0;<sp/>e<sp/>&lt;<sp/><ref refid="classDomaine__dis__base_1a33e55ca05b2a53a3a5e1f844e2551824" kindref="member">nb_elem_tot</ref>();<sp/>e++)</highlight></codeline>
<codeline lineno="128"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>i<sp/>=<sp/>0;<sp/>i<sp/>&lt;<sp/>e_s.dimension(1);<sp/>i++)</highlight></codeline>
<codeline lineno="129"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="130"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>s<sp/>=<sp/>e_s(e,<sp/>i);</highlight></codeline>
<codeline lineno="131"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(s<sp/>&lt;<sp/>0)<sp/></highlight><highlight class="keywordflow">continue</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="132"><highlight class="normal"></highlight></codeline>
<codeline lineno="133"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>som_eb[s].insert(e);</highlight></codeline>
<codeline lineno="134"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="135"><highlight class="normal"></highlight></codeline>
<codeline lineno="136"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>f<sp/>=<sp/>0;<sp/>f<sp/>&lt;<sp/><ref refid="classDomaine__VF_1a419a6173248d7516a6a36ffcc2835cf0" kindref="member">nb_faces_tot</ref>();<sp/>f++)</highlight></codeline>
<codeline lineno="137"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="classDomaine__VF_1acfab03002f8750be840b0946171c1010" kindref="member">fbord</ref>(f)<sp/>&gt;=<sp/>0)</highlight></codeline>
<codeline lineno="138"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>i<sp/>=<sp/>0;<sp/>i<sp/>&lt;<sp/>f_s.<ref refid="classTRUSTTab_1aee55d6851cd43d179ec3c46262fa0aad" kindref="member">dimension</ref>(1);<sp/>i++)</highlight></codeline>
<codeline lineno="139"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="140"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>s<sp/>=<sp/>f_s(f,<sp/>i);</highlight></codeline>
<codeline lineno="141"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(s<sp/>&lt;<sp/>0)<sp/></highlight><highlight class="keywordflow">continue</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="142"><highlight class="normal"></highlight></codeline>
<codeline lineno="143"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>som_eb[s].insert(ne_tot<sp/>+<sp/>f);</highlight></codeline>
<codeline lineno="144"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="145"><highlight class="normal"></highlight></codeline>
<codeline lineno="146"><highlight class="normal"><sp/><sp/>std::set&lt;int&gt;<sp/>f_eb;<sp/></highlight><highlight class="comment">//sommets<sp/>de<sp/>la<sp/>face<sp/>f,<sp/>elems<sp/>connectes<sp/>a<sp/>e<sp/>par<sp/>soms,<sp/>sommets<sp/>/<sp/>faces<sp/>connectes<sp/>par<sp/>une<sp/>face<sp/>commune</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="147"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>f<sp/>=<sp/>0;<sp/>f<sp/>&lt;<sp/><ref refid="classDomaine__VF_1a419a6173248d7516a6a36ffcc2835cf0" kindref="member">nb_faces_tot</ref>();<sp/><ref refid="classDomaine__PolyMAC__P0_1af6cdf6aa2e97688740c497eb277486cb" kindref="member">fsten_d</ref>.<ref refid="classTRUSTTab_1ae0e0535c0974963efe25af45497a9c0d" kindref="member">append_line</ref>(<ref refid="classDomaine__PolyMAC__P0_1a96d3d935dedc7028d07466d995339b85" kindref="member">fsten_eb</ref>.<ref refid="classTRUSTVect_1a0a3b16fb39def99371b91ec218ef138b" kindref="member">size</ref>()),<sp/>f++)</highlight></codeline>
<codeline lineno="148"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(f_e(f,<sp/>0)<sp/>&gt;=<sp/>0<sp/>&amp;&amp;<sp/>(<ref refid="classDomaine__VF_1acfab03002f8750be840b0946171c1010" kindref="member">fbord</ref>(f)<sp/>&gt;=<sp/>0<sp/>||<sp/>f_e(f,<sp/>1)<sp/>&gt;=<sp/>0))</highlight></codeline>
<codeline lineno="149"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="150"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>connectivite<sp/>par<sp/>un<sp/>sommet<sp/>de<sp/>f<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="151"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>f_eb.clear();</highlight></codeline>
<codeline lineno="152"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>i<sp/>=<sp/>0;<sp/>i<sp/>&lt;<sp/>f_s.<ref refid="classTRUSTTab_1aee55d6851cd43d179ec3c46262fa0aad" kindref="member">dimension</ref>(1);<sp/>i++)</highlight></codeline>
<codeline lineno="153"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="154"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>s<sp/>=<sp/>f_s(f,<sp/>i);</highlight></codeline>
<codeline lineno="155"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(s<sp/>&lt;<sp/>0)<sp/></highlight><highlight class="keywordflow">continue</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="156"><highlight class="normal"></highlight></codeline>
<codeline lineno="157"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keyword">auto</highlight><highlight class="normal"><sp/>&amp;&amp;el<sp/>:<sp/>som_eb[s])</highlight></codeline>
<codeline lineno="158"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>f_eb.insert(el);</highlight></codeline>
<codeline lineno="159"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="160"><highlight class="normal"></highlight></codeline>
<codeline lineno="161"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>remplissage<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="162"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keyword">auto</highlight><highlight class="normal"><sp/>&amp;&amp;el<sp/>:<sp/>f_eb)</highlight></codeline>
<codeline lineno="163"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classDomaine__PolyMAC__P0_1a96d3d935dedc7028d07466d995339b85" kindref="member">fsten_eb</ref>.<ref refid="classTRUSTTab_1ae0e0535c0974963efe25af45497a9c0d" kindref="member">append_line</ref>(el);</highlight></codeline>
<codeline lineno="164"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="165"><highlight class="normal"></highlight></codeline>
<codeline lineno="166"><highlight class="normal"><sp/><sp/>CRIMP(<ref refid="classDomaine__PolyMAC__P0_1af6cdf6aa2e97688740c497eb277486cb" kindref="member">fsten_d</ref>);</highlight></codeline>
<codeline lineno="167"><highlight class="normal"><sp/><sp/>CRIMP(<ref refid="classDomaine__PolyMAC__P0_1a96d3d935dedc7028d07466d995339b85" kindref="member">fsten_eb</ref>);</highlight></codeline>
<codeline lineno="168"><highlight class="normal">}</highlight></codeline>
<codeline lineno="169"><highlight class="normal"></highlight><highlight class="comment"></highlight></codeline>
<codeline lineno="170"><highlight class="comment">/*!<sp/>@brief<sp/>Computes<sp/>field<sp/>gradient<sp/>interpolation<sp/>at<sp/>faces<sp/>while<sp/>preserving<sp/>constant<sp/>fields</highlight></codeline>
<codeline lineno="171"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="172"><highlight class="comment"><sp/>*<sp/>This<sp/>method<sp/>computes<sp/>the<sp/>interpolation<sp/>[n_f.grad<sp/>T]_f<sp/>(if<sp/>nu_grad<sp/>=<sp/>0)<sp/>or<sp/>[n_f.nu.grad<sp/>T]_f</highlight></codeline>
<codeline lineno="173"><highlight class="comment"><sp/>*<sp/>while<sp/>exactly<sp/>preserving<sp/>fields<sp/>satisfying<sp/>[nu<sp/>grad<sp/>T]_e<sp/>=<sp/>constant.</highlight></codeline>
<codeline lineno="174"><highlight class="comment"><sp/>*<sp/>It<sp/>uses<sp/>MPFA<sp/>(Multi-Point<sp/>Flux<sp/>Approximation)<sp/>methods<sp/>with<sp/>three<sp/>strategies:</highlight></codeline>
<codeline lineno="175"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/>-<sp/>Attempt<sp/>0:<sp/>Standard<sp/>MPFA-O</highlight></codeline>
<codeline lineno="176"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/>-<sp/>Attempt<sp/>1:<sp/>MPFA-eta:<sp/>variant<sp/>of<sp/>MPFA-O<sp/>where<sp/>auxiliary<sp/>variables<sp/>are<sp/>not<sp/>in<sp/>the<sp/>barycenter<sp/>of<sp/>the<sp/>face</highlight></codeline>
<codeline lineno="177"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/>-<sp/>Attempt<sp/>2:<sp/>Symmetric<sp/>MPFA<sp/>if<sp/>previous<sp/>attempts<sp/>fail<sp/>(coercive<sp/>but<sp/>not<sp/>always<sp/>consistent,<sp/>especially<sp/>on<sp/>complex<sp/>meshes)</highlight></codeline>
<codeline lineno="178"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="179"><highlight class="comment"><sp/>*<sp/>@param<sp/>N<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Number<sp/>of<sp/>field<sp/>components</highlight></codeline>
<codeline lineno="180"><highlight class="comment"><sp/>*<sp/>@param<sp/>is_p<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Pressure<sp/>field<sp/>indicator<sp/>(1<sp/>for<sp/>pressure,<sp/>0<sp/>otherwise)</highlight></codeline>
<codeline lineno="181"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Controls<sp/>Neumann/Dirichlet<sp/>inversion<sp/>for<sp/>boundary<sp/>conditions</highlight></codeline>
<codeline lineno="182"><highlight class="comment"><sp/>*<sp/>@param<sp/>cls<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Domain<sp/>boundary<sp/>conditions</highlight></codeline>
<codeline lineno="183"><highlight class="comment"><sp/>*<sp/>@param<sp/>fcl<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Boundary<sp/>condition<sp/>data</highlight></codeline>
<codeline lineno="184"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fcl(f,<sp/>0/1/2):<sp/>(BC<sp/>type,<sp/>BC<sp/>index,<sp/>index<sp/>within<sp/>BC)</highlight></codeline>
<codeline lineno="185"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>See<sp/>Champ_{P0,Face}_PolyMAC_P0<sp/>for<sp/>format</highlight></codeline>
<codeline lineno="186"><highlight class="comment"><sp/>*<sp/>@param<sp/>nu<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Element<sp/>diffusivity<sp/>(optional,<sp/>can<sp/>be<sp/>nullptr)</highlight></codeline>
<codeline lineno="187"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Array<sp/>nu(e,<sp/>n,<sp/>..)<sp/>for<sp/>element<sp/>e<sp/>and<sp/>component<sp/>n</highlight></codeline>
<codeline lineno="188"><highlight class="comment"><sp/>*<sp/>@param<sp/>som_ext<sp/><sp/><sp/><sp/><sp/><sp/><sp/>List<sp/>of<sp/>vertices<sp/>to<sp/>exclude<sp/>from<sp/>processing<sp/>(optional)</highlight></codeline>
<codeline lineno="189"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Example:<sp/>direct<sp/>treatment<sp/>of<sp/>Echange_Contact<sp/>in<sp/>Op_Diff_PolyMAC_P0_Elem</highlight></codeline>
<codeline lineno="190"><highlight class="comment"><sp/>*<sp/>@param<sp/>virt<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Virtual<sp/>faces<sp/>indicator<sp/>(1<sp/>to<sp/>include,<sp/>0<sp/>otherwise)</highlight></codeline>
<codeline lineno="191"><highlight class="comment"><sp/>*<sp/>@param<sp/>full_stencil<sp/><sp/>Complete<sp/>stencil<sp/>indicator<sp/>(1<sp/>for<sp/>full<sp/>dimensioning)</highlight></codeline>
<codeline lineno="192"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="193"><highlight class="comment"><sp/>*<sp/>@param[out]<sp/>phif_d<sp/><sp/><sp/>Start/end<sp/>indices<sp/>in<sp/>phif_{e,c}<sp/>/<sp/>phif_{pe,pc}</highlight></codeline>
<codeline lineno="194"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>phif_d(f,<sp/>0/1):<sp/>flux<sp/>indices<sp/>at<sp/>face<sp/>f<sp/>in<sp/>interval</highlight></codeline>
<codeline lineno="195"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>[phif_d(f,<sp/>0/1),<sp/>phif_d(f<sp/>+<sp/>1,<sp/>0/1)[</highlight></codeline>
<codeline lineno="196"><highlight class="comment"><sp/>*<sp/>@param[out]<sp/>phif_e<sp/><sp/><sp/>Element<sp/>indices<sp/>in<sp/>stencil<sp/>for<sp/>each<sp/>contribution</highlight></codeline>
<codeline lineno="197"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>phif_e(i):<sp/>element<sp/>index<sp/>for<sp/>i-th<sp/>contribution</highlight></codeline>
<codeline lineno="198"><highlight class="comment"><sp/>*<sp/>@param[out]<sp/>phif_c<sp/><sp/><sp/>Stencil<sp/>coefficients</highlight></codeline>
<codeline lineno="199"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>phif_c(i,<sp/>n,<sp/>c):<sp/>coefficient<sp/>for<sp/>element<sp/>i,<sp/>component<sp/>n,<sp/>contribution<sp/>c</highlight></codeline>
<codeline lineno="200"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Contains<sp/>local<sp/>indices/coefficients<sp/>(without<sp/>Echange_contact)</highlight></codeline>
<codeline lineno="201"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>and<sp/>diagonal<sp/>terms<sp/>(independent<sp/>components)</highlight></codeline>
<codeline lineno="202"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="203"><highlight class="comment"><sp/>*<sp/>@note<sp/>The<sp/>method<sp/>checks<sp/>positivity<sp/>of<sp/>bilinear<sp/>form<sp/>eigenvalues<sp/>to<sp/>ensure<sp/>scheme<sp/>stability<sp/>and<sp/>choose<sp/>the<sp/>MPFA<sp/>method<sp/>accordingly</highlight></codeline>
<codeline lineno="204"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="205"><highlight class="comment"><sp/>*<sp/>@note<sp/>The<sp/>method<sp/>returns<sp/>also<sp/>a<sp/>percentage<sp/>of<sp/>which<sp/>MPFA<sp/>method<sp/>is<sp/>used.<sp/>Be<sp/>careful<sp/>of<sp/>the<sp/>validity<sp/>of<sp/>the<sp/>solution<sp/>if<sp/>the<sp/>percentage<sp/>of<sp/>MPFA-sym<sp/>is<sp/>high</highlight></codeline>
<codeline lineno="206"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="207"><highlight class="comment"><sp/>*<sp/>@note<sp/>Special<sp/>handling<sp/>for<sp/>different<sp/>boundary<sp/>condition<sp/>types:</highlight></codeline>
<codeline lineno="208"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/>-<sp/>Dirichlet/Neumann</highlight></codeline>
<codeline lineno="209"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/>-<sp/>Imposed<sp/>global/external<sp/>friction</highlight></codeline>
<codeline lineno="210"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/>-<sp/>Imposed<sp/>global/external<sp/>exchange</highlight></codeline>
<codeline lineno="211"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="212"><highlight class="comment"><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="213" refid="classDomaine__PolyMAC__P0_1a0480912886833de41caebf4cd622aa0b" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="classDomaine__PolyMAC__P0_1a0480912886833de41caebf4cd622aa0b" kindref="member">Domaine_PolyMAC_P0::fgrad</ref>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>N,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>is_p,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="classConds__lim" kindref="compound">Conds_lim</ref>&amp;<sp/>cls,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="classTRUSTTab" kindref="compound">IntTab</ref>&amp;<sp/>fcl,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="classTRUSTTab" kindref="compound">DoubleTab</ref><sp/>*nu,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="classTRUSTTab" kindref="compound">IntTab</ref><sp/>*som_ext,</highlight></codeline>
<codeline lineno="214"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>virt,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>full_stencil,<sp/><ref refid="classTRUSTTab" kindref="compound">IntTab</ref>&amp;<sp/>phif_d,<sp/><ref refid="classTRUSTTab" kindref="compound">IntTab</ref>&amp;<sp/>phif_e,<sp/><ref refid="classTRUSTTab" kindref="compound">DoubleTab</ref>&amp;<sp/>phif_c)</highlight><highlight class="keyword"><sp/>const</highlight></codeline>
<codeline lineno="215"><highlight class="keyword"></highlight><highlight class="normal">{</highlight></codeline>
<codeline lineno="216"><highlight class="normal"></highlight><highlight class="preprocessor">#ifdef<sp/>_COMPILE_AVEC_PGCC_AVANT_22_7</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="217"><highlight class="normal"><sp/><sp/>Cerr<sp/>&lt;&lt;<sp/></highlight><highlight class="stringliteral">&quot;Internal<sp/>error<sp/>with<sp/>nvc++:<sp/>Internal<sp/>error:<sp/>read_memory_region:<sp/>not<sp/>all<sp/>expected<sp/>entries<sp/>were<sp/>read.&quot;</highlight><highlight class="normal"><sp/>&lt;&lt;<sp/>finl;</highlight></codeline>
<codeline lineno="218"><highlight class="normal"><sp/><sp/><ref refid="classProcess_1acc2fbbe761e08e5870ae605c0705491c" kindref="member">Process::exit</ref>();</highlight></codeline>
<codeline lineno="219"><highlight class="normal"></highlight><highlight class="preprocessor">#else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="220"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="classTRUSTTab" kindref="compound">IntTab</ref>&amp;<sp/>f_e<sp/>=<sp/><ref refid="classDomaine__VF_1afd20cfa68ee7df4a932b135a9543fc9f" kindref="member">face_voisins</ref>(),<sp/>&amp;e_f<sp/>=<sp/><ref refid="classDomaine__VF_1a8c017cc0e5273e28eaec57e0ab622a29" kindref="member">elem_faces</ref>(),<sp/>&amp;f_s<sp/>=<sp/><ref refid="classDomaine__VF_1a1b186007308d9ffdab7536ecc4b376bd" kindref="member">face_sommets</ref>();</highlight></codeline>
<codeline lineno="221"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="classTRUSTTab" kindref="compound">DoubleTab</ref>&amp;<sp/>nf<sp/>=<sp/><ref refid="classDomaine__VF_1a953d6f28077bfecc47a358675dfebfa7" kindref="member">face_normales</ref>(),<sp/>&amp;xs<sp/>=<sp/><ref refid="classDomaine__dis__base_1ad6c6511ebab85dea90d4d5320fee7ae2" kindref="member">domaine</ref>().<ref refid="classDomaine__32__64_1a0f47377f57417c91dba5efe37791f88c" kindref="member">coord_sommets</ref>(),<sp/>&amp;vfd<sp/>=<sp/><ref refid="classDomaine__Poly__base_1a1606d1f9e24df28d3c11c63bf9cd9f83" kindref="member">volumes_entrelaces_dir</ref>();</highlight></codeline>
<codeline lineno="222"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="classTRUSTVect" kindref="compound">DoubleVect</ref>&amp;<sp/>fs<sp/>=<sp/><ref refid="classDomaine__VF_1aec8b0ea1d27aab4760c66d670bdcd02c" kindref="member">face_surfaces</ref>(),<sp/>&amp;vf<sp/>=<sp/><ref refid="classDomaine__VF_1ad0bf90d9beb4083aea6421ca906229f1" kindref="member">volumes_entrelaces</ref>();</highlight></codeline>
<codeline lineno="223"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="classStatic__Int__Lists__32__64" kindref="compound">Static_Int_Lists</ref>&amp;<sp/>s_e<sp/>=<sp/><ref refid="classDomaine__Poly__base_1a5056960e65e7a014a5425c2573479e3e" kindref="member">som_elem</ref>();</highlight></codeline>
<codeline lineno="224"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>i,<sp/>i_s,<sp/>j,<sp/>k,<sp/>l,<sp/>e,<sp/>f,<sp/>s,<sp/>sb,<sp/>n_f,<sp/>n_m,<sp/>n_ef,<sp/>n_e,<sp/>n_eb,<sp/>m,<sp/>n,<sp/>ne_tot<sp/>=<sp/><ref refid="classDomaine__dis__base_1a33e55ca05b2a53a3a5e1f844e2551824" kindref="member">nb_elem_tot</ref>(),<sp/>sgn,<sp/>nw,<sp/>infoo,<sp/>d,<sp/>db,</highlight></codeline>
<codeline lineno="225"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>D<sp/>=<sp/><ref refid="classObjet__U_1a3e23491c01f2f39245fb6f3b6d6d9b17" kindref="member">dimension</ref>,<sp/>rk,<sp/>nl,<sp/>nc,<sp/>un<sp/>=<sp/>1,<sp/>il,<sp/>ok,<sp/>essai;</highlight></codeline>
<codeline lineno="226"><highlight class="normal"></highlight></codeline>
<codeline lineno="227"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">unsigned</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">long</highlight><highlight class="normal"><sp/>ll;</highlight></codeline>
<codeline lineno="228"><highlight class="normal"></highlight></codeline>
<codeline lineno="229"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>x,<sp/>eps_g<sp/>=<sp/>1e-6,<sp/>eps<sp/>=<sp/>1e-10,<sp/>i3[3][3]<sp/>=<sp/>{<sp/>{<sp/>1,<sp/>0,<sp/>0<sp/>},<sp/>{<sp/>0,<sp/>1,<sp/>0<sp/>},<sp/>{<sp/>0,<sp/>0,<sp/>1<sp/>}},<sp/>fac[3],<sp/>vol_s;</highlight></codeline>
<codeline lineno="230"><highlight class="normal"></highlight></codeline>
<codeline lineno="231"><highlight class="normal"><sp/><sp/>statistics().<ref refid="classPerf__counters_1ad8da7bbe3cc8b6bf63ce2c5a9c76323c" kindref="member">create_custom_counter</ref>(</highlight><highlight class="stringliteral">&quot;f_grad&quot;</highlight><highlight class="normal">,2);</highlight></codeline>
<codeline lineno="232"><highlight class="normal"><sp/><sp/><ref refid="classDomaine__PolyMAC__P0_1abf7f95be8390a773d2868b53391ce9d4" kindref="member">init_stencils</ref>();</highlight></codeline>
<codeline lineno="233"><highlight class="normal"><sp/><sp/>phif_e.<ref refid="classTRUSTTab_1a9b2632fe559a20c048cbfddc5c40ed16" kindref="member">resize</ref>(0);</highlight></codeline>
<codeline lineno="234"><highlight class="normal"><sp/><sp/>phif_c.<ref refid="classTRUSTTab_1a9b2632fe559a20c048cbfddc5c40ed16" kindref="member">resize</ref>(<ref refid="classDomaine__PolyMAC__P0_1a96d3d935dedc7028d07466d995339b85" kindref="member">fsten_eb</ref>.<ref refid="classTRUSTTab_1aee55d6851cd43d179ec3c46262fa0aad" kindref="member">dimension</ref>(0),<sp/>N);</highlight></codeline>
<codeline lineno="235"><highlight class="normal"><sp/><sp/>phif_c<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="236"><highlight class="normal"></highlight></codeline>
<codeline lineno="237"><highlight class="normal"><sp/><sp/>std::vector&lt;int&gt;<sp/>s_eb,<sp/>s_f;<sp/></highlight><highlight class="comment">//listes<sp/>d&apos;elements/bord,<sp/>de<sp/>faces<sp/>autour<sp/>du<sp/>sommet</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="238"><highlight class="normal"><sp/><sp/>std::vector&lt;double&gt;<sp/>surf_fs,<sp/>vol_es;<sp/></highlight><highlight class="comment">//surfaces<sp/>partielles<sp/>des<sp/>faces<sp/>connectees<sp/>au<sp/>sommet<sp/>(meme<sp/>ordre<sp/>que<sp/>s_f)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="239"><highlight class="normal"><sp/><sp/>std::vector&lt;std::array&lt;std::array&lt;double,<sp/>3&gt;,2&gt;&gt;<sp/>vec_fs;</highlight><highlight class="comment">//pour<sp/>chaque<sp/>facette,<sp/>base<sp/>de<sp/>(D-1)<sp/>vecteurs<sp/>permettant<sp/>de<sp/>la<sp/>parcourir</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="240"><highlight class="normal"><sp/><sp/>std::vector&lt;std::vector&lt;int&gt;&gt;<sp/>se_f;<sp/></highlight><highlight class="comment">/*<sp/>se_f[i][.]<sp/>:<sp/>faces<sp/>connectees<sp/>au<sp/>i-eme<sp/>element<sp/>connecte<sp/>au<sp/>sommet<sp/>s<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="241"><highlight class="normal"><sp/><sp/><ref refid="classTRUSTTrav" kindref="compound">DoubleTrav</ref><sp/>M,<sp/>B,<sp/>X,<sp/>Ff,<sp/>Feb,<sp/>Mf,<sp/>Meb,<sp/>W(1),<sp/>x_fs,<sp/>A,<sp/>S;<sp/></highlight><highlight class="comment">//systeme<sp/>M.(grad<sp/>u)<sp/>=<sp/>B<sp/>dans<sp/>chaque<sp/>element,<sp/>flux<sp/>a<sp/>la<sp/>face<sp/>Ff.u_fs<sp/>+<sp/>Feb.u_eb,<sp/>equations<sp/>Mf.u_fs<sp/>=<sp/>Meb.u_eb</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="242"><highlight class="normal"><sp/><sp/><ref refid="classTRUSTTrav" kindref="compound">IntTrav</ref><sp/>piv,<sp/>ctr[3];</highlight></codeline>
<codeline lineno="243"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(i<sp/>=<sp/>0;<sp/><ref refid="classDomaine__PolyMAC__P0_1a63c1168c3f83764a72ac6702ed6e8247" kindref="member">first_fgrad_</ref><sp/>&amp;&amp;<sp/>i<sp/>&lt;<sp/>3;<sp/>i++)<sp/><ref refid="classDomaine__dis__base_1ad6c6511ebab85dea90d4d5320fee7ae2" kindref="member">domaine</ref>().<ref refid="classDomaine__32__64_1ad9f8e3169e73ab1147a22eabfb0766de" kindref="member">creer_tableau_sommets</ref>(ctr[i]);</highlight></codeline>
<codeline lineno="244"><highlight class="normal"></highlight></codeline>
<codeline lineno="245"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">/*<sp/>contributions<sp/>aux<sp/>sommets<sp/>:<sp/>en<sp/>evitant<sp/>ceux<sp/>de<sp/>som_ext<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="246"><highlight class="normal"><sp/><sp/>statistics().<ref refid="classPerf__counters_1a8234efa62abcd428fe3df51699090290" kindref="member">begin_count</ref>(</highlight><highlight class="stringliteral">&quot;f_grad&quot;</highlight><highlight class="normal">,statistics().get_last_opened_counter_level()+1);</highlight></codeline>
<codeline lineno="247"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(i_s<sp/>=<sp/>0;<sp/>i_s<sp/>&lt;=<sp/>(som_ext<sp/>?<sp/>som_ext-&gt;<ref refid="classTRUSTVect_1a0a3b16fb39def99371b91ec218ef138b" kindref="member">size</ref>()<sp/>:<sp/>0);<sp/>i_s++)</highlight></codeline>
<codeline lineno="248"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(s<sp/>=<sp/>(som_ext<sp/>&amp;&amp;<sp/>i_s<sp/>?<sp/>(*som_ext)(i_s<sp/>-<sp/>1)<sp/>+<sp/>1<sp/>:<sp/>0);<sp/>s<sp/>&lt;<sp/>(som_ext<sp/>&amp;&amp;<sp/>i_s<sp/>&lt;<sp/>som_ext-&gt;<ref refid="classTRUSTVect_1a0a3b16fb39def99371b91ec218ef138b" kindref="member">size</ref>()<sp/>?<sp/>(*som_ext)(i_s)<sp/>:<sp/>(virt<sp/>?<sp/><ref refid="classDomaine__dis__base_1a909e4f99ce84d6363b8a240052a61897" kindref="member">nb_som_tot</ref>()<sp/>:<sp/><ref refid="classDomaine__dis__base_1a6319e76eb43f35bced14bf0272fa8ca1" kindref="member">nb_som</ref>()));<sp/>s++)</highlight></codeline>
<codeline lineno="249"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="250"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>elements<sp/>connectes<sp/>a<sp/>s<sp/>:<sp/>a<sp/>partir<sp/>de<sp/>som_elem<sp/>(deja<sp/>classes)<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="251"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(s_eb.clear(),<sp/>n_e<sp/>=<sp/>0;<sp/>n_e<sp/>&lt;<sp/>s_e.<ref refid="classStatic__Int__Lists__32__64_1aa218875cf8ed3a3c3a7ca72ff0587c4c" kindref="member">get_list_size</ref>(s);<sp/>n_e++)<sp/>s_eb.push_back(s_e(s,<sp/>n_e));</highlight></codeline>
<codeline lineno="252"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>faces<sp/>et<sp/>leurs<sp/>surfaces<sp/>partielles<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="253"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(s_f.clear(),<sp/>surf_fs.clear(),<sp/>vec_fs.clear(),<sp/>se_f.resize(std::max(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal">(se_f.size()),<sp/>n_e)),<sp/>i<sp/>=<sp/>0,<sp/>ok<sp/>=<sp/>1;<sp/>i<sp/>&lt;<sp/>n_e;<sp/>i++)</highlight></codeline>
<codeline lineno="254"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(se_f[i].clear(),<sp/>e<sp/>=<sp/>s_eb[i],<sp/>j<sp/>=<sp/>0;<sp/>j<sp/>&lt;<sp/>e_f.dimension(1)<sp/>&amp;&amp;<sp/>(f<sp/>=<sp/>e_f(e,<sp/>j))<sp/>&gt;=<sp/>0;<sp/>j++)</highlight></codeline>
<codeline lineno="255"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="256"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(k<sp/>=<sp/>0,<sp/>sb<sp/>=<sp/>0;<sp/>k<sp/>&lt;<sp/>f_s.dimension(1)<sp/>&amp;&amp;<sp/>(sb<sp/>=<sp/>f_s(f,<sp/>k))<sp/>&gt;=<sp/>0;<sp/>k++)</highlight></codeline>
<codeline lineno="257"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(sb<sp/>==<sp/>s)<sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="258"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(sb<sp/>!=<sp/>s)<sp/></highlight><highlight class="keywordflow">continue</highlight><highlight class="normal">;<sp/></highlight><highlight class="comment">/*<sp/>face<sp/>de<sp/>e<sp/>non<sp/>connectee<sp/>a<sp/>s<sp/>-&gt;<sp/>on<sp/>saute<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="259"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="classDomaine__VF_1acfab03002f8750be840b0946171c1010" kindref="member">fbord</ref>(f)<sp/>&gt;=<sp/>0)<sp/>s_eb.insert(std::lower_bound(s_eb.begin(),<sp/>s_eb.end(),<sp/>ne_tot<sp/>+<sp/>f),<sp/>ne_tot<sp/>+<sp/>f);<sp/></highlight><highlight class="comment">//si<sp/>f<sp/>est<sp/>de<sp/>bord,<sp/>on<sp/>ajoute<sp/>l&apos;indice<sp/>correspondant<sp/>a<sp/>s_eb</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="260"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>ok<sp/>&amp;=<sp/>(f_e(f,<sp/>0)<sp/>&gt;=<sp/>0<sp/>&amp;&amp;<sp/>f_e(f,<sp/>1)<sp/>&gt;=<sp/>0);<sp/></highlight><highlight class="comment">//si<sp/>f<sp/>est<sp/>interne,<sp/>alors<sp/>l&apos;amont/aval<sp/>doivent<sp/>etre<sp/>presents</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="261"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>se_f[i].push_back(f);<sp/></highlight><highlight class="comment">//faces<sp/>connectees<sp/>a<sp/>e<sp/>et<sp/>s</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="262"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>((ll<sp/>=<sp/>std::lower_bound(s_f.begin(),<sp/>s_f.end(),<sp/>f)<sp/>-<sp/>s_f.begin())<sp/>==<sp/>s_f.size()<sp/>||<sp/>s_f[ll]<sp/>!=<sp/>f)<sp/></highlight><highlight class="comment">/*<sp/>si<sp/>f<sp/>n&apos;est<sp/>pas<sp/>dans<sp/>s_f,<sp/>on<sp/>l&apos;ajoute<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="263"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="264"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>s_f.insert(s_f.begin()<sp/>+<sp/>ll,<sp/>f);<sp/></highlight><highlight class="comment">//face<sp/>-&gt;<sp/>dans<sp/>s_f</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="265"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(D<sp/>&lt;<sp/>3)<sp/>surf_fs.insert(surf_fs.begin()<sp/>+<sp/>ll,<sp/>fs(f)<sp/>/<sp/>2),<sp/>vec_fs.insert(vec_fs.begin()<sp/>+<sp/>ll,<sp/>{{{<sp/>xs(s,<sp/>0)<sp/>-<sp/><ref refid="classDomaine__VF_1a523f7a2ba633dbdd831a9795cf099743" kindref="member">xv_</ref>(f,<sp/>0),<sp/>xs(s,<sp/>1)<sp/>-<sp/><ref refid="classDomaine__VF_1a523f7a2ba633dbdd831a9795cf099743" kindref="member">xv_</ref>(f,<sp/>1),<sp/>0},<sp/>{<sp/>0,<sp/>0,<sp/>0<sp/>}}});<sp/></highlight><highlight class="comment">//2D<sp/>-&gt;<sp/>facile</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="266"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(surf_fs.insert(surf_fs.begin()<sp/>+<sp/>ll,<sp/>0),<sp/>vec_fs.insert(vec_fs.begin()<sp/>+<sp/>ll,<sp/>{{{<sp/>0,<sp/>0,<sp/>0},<sp/>{0,<sp/>0,<sp/>0<sp/>}}}),<sp/>m<sp/>=<sp/>0;<sp/>m<sp/>&lt;<sp/>2;<sp/>m++)<sp/></highlight><highlight class="comment">//3D<sp/>-&gt;<sp/>deux<sp/>sous-triangles</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="267"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="268"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(m<sp/>==<sp/>1<sp/>||<sp/>k<sp/>&gt;<sp/>0)<sp/>sb<sp/>=<sp/>f_s(f,<sp/>m<sp/>?<sp/>(k<sp/>+<sp/>1<sp/>&lt;<sp/>f_s.dimension(1)<sp/>&amp;&amp;<sp/>f_s(f,<sp/>k<sp/>+<sp/>1)<sp/>&gt;=<sp/>0<sp/>?<sp/>k<sp/>+<sp/>1<sp/>:<sp/>0)<sp/>:<sp/>k<sp/>-<sp/>1);<sp/></highlight><highlight class="comment">//sommet<sp/>suivant<sp/>(m<sp/>=<sp/>1)<sp/>ou<sp/>precedent<sp/>avec<sp/>k<sp/>&gt;<sp/>0<sp/>-&gt;<sp/>facile</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="269"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(n<sp/>=<sp/>f_s.dimension(1)<sp/>-<sp/>1;<sp/>(sb<sp/>=<sp/>f_s(f,<sp/>n))<sp/>==<sp/>-1;<sp/>)<sp/>n--;<sp/></highlight><highlight class="comment">//sommet<sp/>precedent<sp/>avec<sp/>k<sp/>=<sp/>0<sp/>-&gt;<sp/>on<sp/>cherche<sp/>a<sp/>partir<sp/>de<sp/>la<sp/>fin</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="270"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">auto</highlight><highlight class="normal"><sp/>v<sp/>=<sp/><ref refid="classDomaine__VF_1abce6ee7cce620caeab5e9cc6469f49c5" kindref="member">cross</ref>(D,<sp/>D,<sp/>&amp;xs(s,<sp/>0),<sp/>&amp;xs(sb,<sp/>0),<sp/>&amp;<ref refid="classDomaine__VF_1a523f7a2ba633dbdd831a9795cf099743" kindref="member">xv_</ref>(f,<sp/>0),<sp/>&amp;<ref refid="classDomaine__VF_1a523f7a2ba633dbdd831a9795cf099743" kindref="member">xv_</ref>(f,<sp/>0));</highlight><highlight class="comment">//produit<sp/>vectoriel<sp/>(xs<sp/>-<sp/>xf)x(xsb<sp/>-<sp/>xf)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="271"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>surf_fs[ll]<sp/>+=<sp/>std::fabs(<ref refid="classDomaine__PolyMAC_1a35ea111c1f80b352c518c3587cea2142" kindref="member">dot</ref>(&amp;v[0],<sp/>&amp;nf(f,<sp/>0)))<sp/>/<sp/>fs(f)<sp/>/<sp/>4;<sp/></highlight><highlight class="comment">//surface<sp/>a<sp/>ajouter</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="272"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(d<sp/>=<sp/>0;<sp/>d<sp/>&lt;<sp/>D;<sp/>d++)<sp/>vec_fs[ll][m][d]<sp/>=<sp/>(xs(s,<sp/>d)<sp/>+<sp/>xs(sb,<sp/>d))<sp/>/<sp/>2<sp/>-<sp/><ref refid="classDomaine__VF_1a523f7a2ba633dbdd831a9795cf099743" kindref="member">xv_</ref>(f,<sp/>d);<sp/></highlight><highlight class="comment">//vecteur<sp/>face<sp/>-&gt;<sp/>arete</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="273"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="274"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="275"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="276"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!ok)<sp/></highlight><highlight class="keywordflow">continue</highlight><highlight class="normal">;<sp/></highlight><highlight class="comment">//au<sp/>moins<sp/>un<sp/>voisin<sp/>manquant</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="277"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>n_eb<sp/>=<sp/>(int)s_eb.size(),<sp/>n_f<sp/>=<sp/>(int)s_f.size();</highlight></codeline>
<codeline lineno="278"><highlight class="normal"></highlight></codeline>
<codeline lineno="279"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>conversion<sp/>de<sp/>se_f<sp/>en<sp/>indices<sp/>dans<sp/>s_f<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="280"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(i<sp/>=<sp/>0;<sp/>i<sp/>&lt;<sp/>n_e;<sp/>i++)</highlight></codeline>
<codeline lineno="281"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(j<sp/>=<sp/>0;<sp/>j<sp/>&lt;<sp/>(int)<sp/>se_f[i].size();<sp/>j++)<sp/>se_f[i][j]<sp/>=<sp/>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal">)(std::lower_bound(s_f.begin(),<sp/>s_f.end(),<sp/>se_f[i][j])<sp/>-<sp/>s_f.begin());</highlight></codeline>
<codeline lineno="282"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(vol_es.resize(n_e),<sp/>vol_s<sp/>=<sp/>0,<sp/>i<sp/>=<sp/>0;<sp/>i<sp/>&lt;<sp/>n_e;<sp/>vol_s<sp/>+=<sp/>vol_es[i],<sp/>i++)</highlight></codeline>
<codeline lineno="283"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(e<sp/>=<sp/>s_eb[i],<sp/>vol_es[i]<sp/>=<sp/>0,<sp/>j<sp/>=<sp/>0;<sp/>j<sp/>&lt;<sp/>(int)<sp/>se_f[i].size();<sp/>j++)</highlight></codeline>
<codeline lineno="284"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>f<sp/>=<sp/>s_f[k<sp/>=<sp/>se_f[i][j]],<sp/>vol_es[i]<sp/>+=<sp/>surf_fs[k]<sp/>*<sp/>vfd(f,<sp/>e<sp/>!=<sp/>f_e(f,<sp/>0))<sp/>/<sp/>fs(f)<sp/>/<sp/>D;</highlight></codeline>
<codeline lineno="285"><highlight class="normal"></highlight></codeline>
<codeline lineno="286"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(essai<sp/>=<sp/>0;<sp/>essai<sp/>&lt;<sp/>3;<sp/>essai++)<sp/></highlight><highlight class="comment">/*<sp/>essai<sp/>0<sp/>:<sp/>MPFA<sp/>O<sp/>-&gt;<sp/>essai<sp/>1<sp/>:<sp/>MPFA<sp/>O<sp/>avec<sp/>x_fs<sp/>mobiles<sp/>-&gt;<sp/>essai<sp/>2<sp/>:<sp/>MPFA<sp/>symetrique<sp/>(corecive,<sp/>mais<sp/>pas<sp/>tres<sp/>consistante)<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="287"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="288"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(essai<sp/>==<sp/>1)<sp/></highlight><highlight class="comment">/*<sp/>essai<sp/>1<sp/>:<sp/>choix<sp/>des<sp/>points<sp/>x_fs<sp/>de<sp/>continuite<sp/>aux<sp/>facettes<sp/>pour<sp/>obtenir<sp/>un<sp/>schema<sp/>symetrique<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="289"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="290"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>systeme<sp/>lineaire<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="291"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(M.<ref refid="classTRUSTTab_1a9b2632fe559a20c048cbfddc5c40ed16" kindref="member">resize</ref>(N,<sp/>nc<sp/>=<sp/>(D<sp/>-<sp/>1)<sp/>*<sp/>n_f,<sp/>nl<sp/>=<sp/>D<sp/>*<sp/>(D<sp/>-<sp/>1)<sp/>/<sp/>2<sp/>*<sp/>n_e),<sp/>B.<ref refid="classTRUSTTab_1a9b2632fe559a20c048cbfddc5c40ed16" kindref="member">resize</ref>(N,<sp/>n_m<sp/>=<sp/>std::max(nc,<sp/>nl)),<sp/>M<sp/>=<sp/>0,<sp/>B<sp/>=<sp/>0,<sp/>i<sp/>=<sp/>0,<sp/>il<sp/>=<sp/>0;<sp/>i<sp/>&lt;<sp/>n_e;<sp/>i++)</highlight></codeline>
<codeline lineno="292"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(d<sp/>=<sp/>0;<sp/>d<sp/>&lt;<sp/>D;<sp/>d++)</highlight></codeline>
<codeline lineno="293"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(db<sp/>=<sp/>0;<sp/>db<sp/>&lt;<sp/>d;<sp/>db++,<sp/>il++)</highlight></codeline>
<codeline lineno="294"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(e<sp/>=<sp/>s_eb[i],<sp/>j<sp/>=<sp/>0;<sp/>j<sp/>&lt;<sp/>(int)<sp/>se_f[i].size();<sp/>j++)</highlight></codeline>
<codeline lineno="295"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(sgn<sp/>=<sp/>e<sp/>==<sp/>f_e(f<sp/>=<sp/>s_f[k<sp/>=<sp/>se_f[i][j]],<sp/>0)<sp/>?<sp/>1<sp/>:<sp/>-1,<sp/>n<sp/>=<sp/>0;<sp/>n<sp/>&lt;<sp/>N;<sp/>n++)</highlight></codeline>
<codeline lineno="296"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="297"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(l<sp/>=<sp/>0;<sp/>l<sp/>&lt;<sp/>D;<sp/>l++)<sp/>fac[l]<sp/>=<sp/>sgn<sp/>*<sp/><ref refid="classDomaine__Poly__base_1ad88d8267aeb1b99c5749b37b6e0ee9e6" kindref="member">nu_dot</ref>(nu,<sp/>e,<sp/>n,<sp/>&amp;nf(f,<sp/>0),<sp/>i3[l])<sp/>*<sp/>surf_fs[k]<sp/>/<sp/>fs(f)<sp/>/<sp/>vol_es[i];<sp/></highlight><highlight class="comment">//vecteur<sp/>lambda_e<sp/>nf<sp/>sortant<sp/>*<sp/>facteur<sp/>commun</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="298"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>B(n,<sp/>il)<sp/>+=<sp/>fac[d]<sp/>*<sp/>(<ref refid="classDomaine__VF_1a523f7a2ba633dbdd831a9795cf099743" kindref="member">xv_</ref>(f,<sp/>db)<sp/>-<sp/><ref refid="classDomaine__VF_1a1510e1cabc454c8f88adaa77b9433e8e" kindref="member">xp_</ref>(e,<sp/>db))<sp/>-<sp/>fac[db]<sp/>*<sp/>(<ref refid="classDomaine__VF_1a523f7a2ba633dbdd831a9795cf099743" kindref="member">xv_</ref>(f,<sp/>d)<sp/>-<sp/><ref refid="classDomaine__VF_1a1510e1cabc454c8f88adaa77b9433e8e" kindref="member">xp_</ref>(e,<sp/>d));<sp/></highlight><highlight class="comment">//second<sp/>membre</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="299"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(l<sp/>=<sp/>0;<sp/>l<sp/>&lt;<sp/>D<sp/>-<sp/>1;<sp/>l++)<sp/>M(n,<sp/>(D<sp/>-<sp/>1)<sp/>*<sp/>k<sp/>+<sp/>l,<sp/>il)<sp/>+=<sp/>fac[db]<sp/>*<sp/>vec_fs[k][l][d]<sp/>-<sp/>fac[d]<sp/>*<sp/>vec_fs[k][l][db];<sp/></highlight><highlight class="comment">//matrice</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="300"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="301"><highlight class="normal"></highlight></codeline>
<codeline lineno="302"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>resolution<sp/>-&gt;<sp/>DEGLSY<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="303"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nw<sp/>=<sp/>-1,<sp/>piv.<ref refid="classTRUSTTab_1a9b2632fe559a20c048cbfddc5c40ed16" kindref="member">resize</ref>(nc),<sp/>F77NAME(dgelsy)(&amp;nl,<sp/>&amp;nc,<sp/>&amp;un,<sp/>&amp;M(0,<sp/>0,<sp/>0),<sp/>&amp;nl,<sp/>&amp;B(0,<sp/>0),<sp/>&amp;n_m,<sp/>&amp;piv(0),<sp/>&amp;eps_g,<sp/>&amp;rk,<sp/>&amp;W(0),<sp/>&amp;nw,<sp/>&amp;infoo);</highlight></codeline>
<codeline lineno="304"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(W.resize(nw<sp/>=<sp/>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal">)std::lrint(W(0))),<sp/>n<sp/>=<sp/>0;<sp/>n<sp/>&lt;<sp/>N;<sp/>n++)<sp/>piv<sp/>=<sp/>0,<sp/>F77NAME(dgelsy)(&amp;nl,<sp/>&amp;nc,<sp/>&amp;un,<sp/>&amp;M(n,<sp/>0,<sp/>0),<sp/>&amp;nl,<sp/>&amp;B(n,<sp/>0),<sp/>&amp;n_m,<sp/>&amp;piv(0),<sp/>&amp;eps_g,<sp/>&amp;rk,<sp/>&amp;W(0),<sp/>&amp;nw,<sp/>&amp;infoo);</highlight></codeline>
<codeline lineno="305"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>x_fs<sp/>=<sp/>xf<sp/>+<sp/>corrections<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="306"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(x_fs.<ref refid="classTRUSTTab_1a9b2632fe559a20c048cbfddc5c40ed16" kindref="member">resize</ref>(N,<sp/>n_f,<sp/>D),<sp/>n<sp/>=<sp/>0;<sp/>n<sp/>&lt;<sp/>N;<sp/>n++)</highlight></codeline>
<codeline lineno="307"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(i<sp/>=<sp/>0;<sp/>i<sp/>&lt;<sp/>n_f;<sp/>i++)</highlight></codeline>
<codeline lineno="308"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(f<sp/>=<sp/>s_f[i],<sp/>d<sp/>=<sp/>0;<sp/>d<sp/>&lt;<sp/>D;<sp/>d++)</highlight></codeline>
<codeline lineno="309"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(x_fs(n,<sp/>i,<sp/>d)<sp/>=<sp/><ref refid="classDomaine__VF_1a523f7a2ba633dbdd831a9795cf099743" kindref="member">xv_</ref>(f,<sp/>d),<sp/>k<sp/>=<sp/>0;<sp/>k<sp/>&lt;<sp/>D<sp/>-<sp/>1;<sp/>k++)<sp/>x_fs(n,<sp/>i,<sp/>d)<sp/>+=<sp/>std::min(std::max(B(n,<sp/>(D<sp/>-<sp/>1)<sp/>*<sp/>i<sp/>+<sp/>k),<sp/>0.),<sp/>0.5)<sp/>*<sp/>vec_fs[i][k][d];</highlight></codeline>
<codeline lineno="310"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="311"><highlight class="normal"></highlight></codeline>
<codeline lineno="312"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>gradients<sp/>par<sp/>maille<sp/>en<sp/>fonctions<sp/>des<sp/>(u_eb,<sp/>u_fs),<sp/>flux<sp/>F<sp/>=<sp/>Ff.u_fs<sp/>+<sp/>Feb.u_eb,<sp/>et<sp/>systeme<sp/>Mf.u_fs<sp/>=<sp/>Feb.u_eb<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="313"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Ff.<ref refid="classTRUSTTab_1a9b2632fe559a20c048cbfddc5c40ed16" kindref="member">resize</ref>(n_f,<sp/>n_f,<sp/>N),<sp/>Feb.<ref refid="classTRUSTTab_1a9b2632fe559a20c048cbfddc5c40ed16" kindref="member">resize</ref>(n_f,<sp/>n_eb,<sp/>N),<sp/>Mf.<ref refid="classTRUSTTab_1a9b2632fe559a20c048cbfddc5c40ed16" kindref="member">resize</ref>(N,<sp/>n_f,<sp/>n_f),<sp/>Meb.<ref refid="classTRUSTTab_1a9b2632fe559a20c048cbfddc5c40ed16" kindref="member">resize</ref>(N,<sp/>n_eb,<sp/>n_f);</highlight></codeline>
<codeline lineno="314"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(Ff<sp/>=<sp/>0,<sp/>Feb<sp/>=<sp/>0,<sp/>Mf<sp/>=<sp/>0,<sp/>Meb<sp/>=<sp/>0,<sp/>i<sp/>=<sp/>0;<sp/>i<sp/>&lt;<sp/>n_e;<sp/>i++)</highlight></codeline>
<codeline lineno="315"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(e<sp/>=<sp/>s_eb[i],<sp/>M.<ref refid="classTRUSTTab_1a9b2632fe559a20c048cbfddc5c40ed16" kindref="member">resize</ref>(n_ef<sp/>=<sp/>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal">)se_f[i].size(),<sp/>D),<sp/>B.<ref refid="classTRUSTTab_1a9b2632fe559a20c048cbfddc5c40ed16" kindref="member">resize</ref>(D,<sp/>n_m<sp/>=<sp/>std::max(D,<sp/>n_ef)),<sp/>X.resize(n_ef,<sp/>D),<sp/>piv.<ref refid="classTRUSTTab_1a9b2632fe559a20c048cbfddc5c40ed16" kindref="member">resize</ref>(n_ef),<sp/>n<sp/>=<sp/>0;<sp/>n<sp/>&lt;<sp/>N;<sp/>n++)</highlight></codeline>
<codeline lineno="316"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="317"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(essai<sp/>&lt;<sp/>2)<sp/></highlight><highlight class="comment">/*<sp/>essais<sp/>0<sp/>et<sp/>1<sp/>:<sp/>gradient<sp/>consistant<sp/>donne<sp/>par<sp/>(u_e,<sp/>(u_fs)_{f<sp/>v<sp/>e,<sp/>s})*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="318"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="319"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>gradient<sp/>dans<sp/>(e,<sp/>s)<sp/>-&gt;<sp/>matrice<sp/>/<sp/>second<sp/>membre<sp/>M.x<sp/>=<sp/>B<sp/>du<sp/>systeme<sp/>(grad<sp/>u)_i<sp/>=<sp/>sum_f<sp/>b_{fi}<sp/>(x_fs_i<sp/>-<sp/>x_e),<sp/>avec<sp/>x_fs<sp/>le<sp/>pt<sp/>de<sp/>continuite<sp/>de<sp/>u_fs<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="320"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(j<sp/>=<sp/>0;<sp/>j<sp/>&lt;<sp/>n_ef;<sp/>j++)</highlight></codeline>
<codeline lineno="321"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(f<sp/>=<sp/>s_f[k<sp/>=<sp/>se_f[i][j]],<sp/>d<sp/>=<sp/>0;<sp/>d<sp/>&lt;<sp/>D;<sp/>d++)<sp/>M(j,<sp/>d)<sp/>=<sp/>(essai<sp/>?<sp/>x_fs(n,<sp/>k,<sp/>d)<sp/>:<sp/><ref refid="classDomaine__VF_1a523f7a2ba633dbdd831a9795cf099743" kindref="member">xv_</ref>(f,<sp/>d))<sp/>-<sp/><ref refid="classDomaine__VF_1a1510e1cabc454c8f88adaa77b9433e8e" kindref="member">xp_</ref>(e,<sp/>d);</highlight></codeline>
<codeline lineno="322"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(B<sp/>=<sp/>0,<sp/>d<sp/>=<sp/>0;<sp/>d<sp/>&lt;<sp/>D;<sp/>d++)<sp/>B(d,<sp/>d)<sp/>=<sp/>1;</highlight></codeline>
<codeline lineno="323"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nw<sp/>=<sp/>-1,<sp/>piv<sp/>=<sp/>0,<sp/>F77NAME(dgelsy)(&amp;D,<sp/>&amp;n_ef,<sp/>&amp;D,<sp/>&amp;M(0,<sp/>0),<sp/>&amp;D,<sp/>&amp;B(0,<sp/>0),<sp/>&amp;n_m,<sp/>&amp;piv(0),<sp/>&amp;eps_g,<sp/>&amp;rk,<sp/>&amp;W(0),<sp/>&amp;nw,<sp/>&amp;infoo);</highlight></codeline>
<codeline lineno="324"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>W.<ref refid="classTRUSTTab_1a9b2632fe559a20c048cbfddc5c40ed16" kindref="member">resize</ref>(nw<sp/>=<sp/>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal">)std::lrint(W(0))),<sp/>F77NAME(dgelsy)(&amp;D,<sp/>&amp;n_ef,<sp/>&amp;D,<sp/>&amp;M(0,<sp/>0),<sp/>&amp;D,<sp/>&amp;B(0,<sp/>0),<sp/>&amp;n_m,<sp/>&amp;piv(0),<sp/>&amp;eps_g,<sp/>&amp;rk,<sp/>&amp;W(0),<sp/>&amp;nw,<sp/>&amp;infoo);</highlight></codeline>
<codeline lineno="325"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(j<sp/>=<sp/>0;<sp/>j<sp/>&lt;<sp/>n_ef;<sp/>j++)</highlight></codeline>
<codeline lineno="326"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(d<sp/>=<sp/>0;<sp/>d<sp/>&lt;<sp/>D;<sp/>d++)<sp/>X(j,<sp/>d)<sp/>=<sp/>B(d,<sp/>j);<sp/></highlight><highlight class="comment">/*<sp/>pour<sp/>pouvoir<sp/>utiliser<sp/>nu_dot<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="327"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="328"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(j<sp/>=<sp/>0;<sp/>j<sp/>&lt;<sp/>n_ef;<sp/>j++)</highlight></codeline>
<codeline lineno="329"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(sgn<sp/>=<sp/>e<sp/>==<sp/>f_e(f<sp/>=<sp/>s_f[k<sp/>=<sp/>se_f[i][j]],<sp/>0)<sp/>?<sp/>1<sp/>:<sp/>-1,<sp/>d<sp/>=<sp/>0;<sp/>d<sp/>&lt;<sp/>D;<sp/>d++)<sp/></highlight><highlight class="comment">/*<sp/>essai<sp/>2<sp/>:<sp/>gradient<sp/>non<sp/>consistant<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="330"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>X(j,<sp/>d)<sp/>=<sp/>surf_fs[k]<sp/>/<sp/>vol_es[i]<sp/>*<sp/>sgn<sp/>*<sp/>nf(f,<sp/>d)<sp/>/<sp/>fs(f);</highlight></codeline>
<codeline lineno="331"><highlight class="normal"></highlight></codeline>
<codeline lineno="332"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>flux<sp/>et<sp/>equation.<sp/>Remarque<sp/>:<sp/>les<sp/>CLs<sp/>complexes<sp/>des<sp/>equations<sp/>scalaires<sp/>sont<sp/>gerees<sp/>directement<sp/>dans<sp/>Op_Diff_PolyMAC_P0_Elem<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="333"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(j<sp/>=<sp/>0;<sp/>j<sp/>&lt;<sp/>n_ef;<sp/>j++)</highlight></codeline>
<codeline lineno="334"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="335"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>k<sp/>=<sp/>se_f[i][j],<sp/>f<sp/>=<sp/>s_f[k],<sp/>sgn<sp/>=<sp/>e<sp/>==<sp/>f_e(f,<sp/>0)<sp/>?<sp/>1<sp/>:<sp/>-1;<sp/></highlight><highlight class="comment">//face<sp/>et<sp/>son<sp/>indice</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="336"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="classCond__lim__base" kindref="compound">Cond_lim_base</ref><sp/>*cl<sp/>=<sp/>fcl(f,<sp/>0)<sp/>?<sp/>&amp;cls[fcl(f,<sp/>1)].valeur()<sp/>:<sp/></highlight><highlight class="keyword">nullptr</highlight><highlight class="normal">;<sp/></highlight><highlight class="comment">//si<sp/>on<sp/>est<sp/>sur<sp/>une<sp/>CL,<sp/>pointeur<sp/>vers<sp/>celle-ci</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="337"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>is_dir<sp/>=<sp/>cl<sp/>&amp;&amp;<sp/>(is_p<sp/>?<sp/>sub_type(<ref refid="classNeumann" kindref="compound">Neumann</ref>,<sp/>*cl)<sp/>:<sp/>sub_type(<ref refid="classDirichlet" kindref="compound">Dirichlet</ref>,<sp/>*cl)<sp/>||<sp/>sub_type(<ref refid="classDirichlet__homogene" kindref="compound">Dirichlet_homogene</ref>,<sp/>*cl));<sp/></highlight><highlight class="comment">//est-elle<sp/>de<sp/>Dirichlet?</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="338"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(l<sp/>=<sp/>0;<sp/>l<sp/>&lt;<sp/>n_ef;<sp/>l++)</highlight></codeline>
<codeline lineno="339"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="340"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>x<sp/>=<sp/>sgn<sp/>*<sp/><ref refid="classDomaine__Poly__base_1ad88d8267aeb1b99c5749b37b6e0ee9e6" kindref="member">nu_dot</ref>(nu,<sp/>e,<sp/>n,<sp/>&amp;nf(f,<sp/>0),<sp/>&amp;X(l,<sp/>0))<sp/>*<sp/>surf_fs[k]<sp/>/<sp/>fs(f);<sp/></highlight><highlight class="comment">//contribution<sp/>au<sp/>flux</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="341"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(sgn<sp/>&gt;<sp/>0)<sp/>Ff(k,<sp/>se_f[i][l],<sp/>n)<sp/>+=<sp/>x,<sp/>Feb(k,<sp/>i,<sp/>n)<sp/>-=<sp/>x;<sp/></highlight><highlight class="comment">//flux<sp/>amont-&gt;aval</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="342"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!is_dir)<sp/>Mf(n,<sp/>se_f[i][l],<sp/>k)<sp/>+=<sp/>x,<sp/>Meb(n,<sp/>i,<sp/>k)<sp/>+=<sp/>x;<sp/></highlight><highlight class="comment">//equation<sp/>sur<sp/>u_fs<sp/>(sauf<sp/>si<sp/>CL<sp/>Dirichlet)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="343"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="344"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!cl)<sp/></highlight><highlight class="keywordflow">continue</highlight><highlight class="normal">;<sp/></highlight><highlight class="comment">//rien<sp/>de<sp/>l&apos;autre<sp/>cote</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="345"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(is_dir)<sp/>Mf(n,<sp/>k,<sp/>k)<sp/>=<sp/>Meb(n,<sp/>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal">)(std::find(s_eb.begin(),<sp/>s_eb.end(),<sp/>ne_tot<sp/>+<sp/>f)<sp/>-<sp/>s_eb.begin()),<sp/>k)<sp/>=<sp/>1;<sp/></highlight><highlight class="comment">//Dirichlet<sp/>-&gt;<sp/>equation<sp/>u_fs<sp/>=<sp/>u_b</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="346"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(is_p<sp/>?<sp/>!is_dir<sp/>:<sp/>sub_type(<ref refid="classNeumann" kindref="compound">Neumann</ref>,<sp/>*cl))<sp/></highlight><highlight class="comment">//Neumann<sp/>-&gt;<sp/>ajout<sp/>du<sp/>flux<sp/>au<sp/>bord</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="347"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Meb(n,<sp/>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal">)(std::find(s_eb.begin(),<sp/>s_eb.end(),<sp/>ne_tot<sp/>+<sp/>f)<sp/>-<sp/>s_eb.begin()),<sp/>k)<sp/>+=<sp/>surf_fs[k];</highlight></codeline>
<codeline lineno="348"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(sub_type(<ref refid="classFrottement__global__impose" kindref="compound">Frottement_global_impose</ref>,<sp/>*cl))<sp/></highlight><highlight class="comment">//Frottement_global_impose<sp/>-&gt;<sp/>flux<sp/>=<sp/><sp/>-<sp/>coeff<sp/>*<sp/>v_e</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="349"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Meb(n,<sp/>i,<sp/>k)<sp/>-=<sp/>surf_fs[k]<sp/>*<sp/>((nu)<sp/>?<sp/>ref_cast(<ref refid="classFrottement__global__impose" kindref="compound">Frottement_global_impose</ref>,<sp/>*cl).coefficient_frottement(fcl(f,<sp/>2),<sp/>n)<sp/>:<sp/>ref_cast(<ref refid="classFrottement__global__impose" kindref="compound">Frottement_global_impose</ref>,<sp/>*cl).coefficient_frottement_grad(fcl(f,<sp/>2),<sp/>n)<sp/>)<sp/>;</highlight></codeline>
<codeline lineno="350"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(sub_type(<ref refid="classFrottement__externe__impose" kindref="compound">Frottement_externe_impose</ref>,<sp/>*cl))<sp/></highlight><highlight class="comment">//Frottement_externe_impose<sp/>-&gt;<sp/>flux<sp/>=<sp/><sp/>-<sp/>coeff<sp/>*<sp/>v_f</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="351"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Mf(n,<sp/>k,<sp/>k)<sp/>+=<sp/>surf_fs[k]<sp/>*<sp/>((nu)<sp/>?<sp/>ref_cast(<ref refid="classFrottement__externe__impose" kindref="compound">Frottement_externe_impose</ref>,<sp/>*cl).coefficient_frottement(fcl(f,<sp/>2),<sp/>n)<sp/>:<sp/>ref_cast(<ref refid="classFrottement__externe__impose" kindref="compound">Frottement_externe_impose</ref>,<sp/>*cl).coefficient_frottement_grad(fcl(f,<sp/>2),<sp/>n)<sp/>);</highlight></codeline>
<codeline lineno="352"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(sub_type(<ref refid="classEchange__impose__base" kindref="compound">Echange_impose_base</ref>,<sp/>*cl))<sp/></highlight><highlight class="comment">//Echange_impose_base<sp/>-&gt;<sp/>flux<sp/>=<sp/><sp/>-<sp/>h<sp/>*<sp/>(T_{e,f}<sp/>-<sp/>T_ext)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="353"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="354"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>h<sp/>=<sp/>(nu)<sp/>?<sp/>ref_cast(<ref refid="classEchange__impose__base" kindref="compound">Echange_impose_base</ref>,<sp/>*cl).h_imp(fcl(f,<sp/>2),<sp/>n)<sp/>:<sp/>ref_cast(<ref refid="classEchange__impose__base" kindref="compound">Echange_impose_base</ref>,<sp/>*cl).h_imp_grad(fcl(f,<sp/>2),<sp/>n)<sp/>;</highlight></codeline>
<codeline lineno="355"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Meb(n,<sp/>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal">)(std::find(s_eb.begin(),<sp/>s_eb.end(),<sp/>ne_tot<sp/>+<sp/>f)<sp/>-<sp/>s_eb.begin()),<sp/>k)<sp/>+=<sp/>surf_fs[k]<sp/>*<sp/>h;<sp/></highlight><highlight class="comment">//partie<sp/>h<sp/>*<sp/>T_ext</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="356"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(sub_type(<ref refid="classEchange__externe__impose" kindref="compound">Echange_externe_impose</ref>,<sp/>*cl))<sp/>Mf(n,<sp/>k,<sp/>k)<sp/>+=<sp/>surf_fs[k]<sp/>*<sp/>h;<sp/></highlight><highlight class="comment">//Echange_externe_impose<sp/>:<sp/>partie<sp/>h<sp/>*<sp/>T_f</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="357"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>Meb(n,<sp/>i,<sp/>k)<sp/>-=<sp/>surf_fs[k]<sp/>*<sp/>h;<sp/></highlight><highlight class="comment">//Echange_global_impose<sp/>:<sp/>partie<sp/>h<sp/>*<sp/>T_e</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="358"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="359"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="360"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="361"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>resolution<sp/>de<sp/>Mf.u_fs<sp/>=<sp/>Meb.u_eb<sp/>:<sp/>DGELSY,<sp/>au<sp/>cas<sp/>ou<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="362"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nw<sp/>=<sp/>-1,<sp/>piv.<ref refid="classTRUSTTab_1a9b2632fe559a20c048cbfddc5c40ed16" kindref="member">resize</ref>(n_f),<sp/>F77NAME(dgelsy)(&amp;n_f,<sp/>&amp;n_f,<sp/>&amp;n_eb,<sp/>&amp;Mf(0,<sp/>0,<sp/>0),<sp/>&amp;n_f,<sp/>&amp;Meb(0,<sp/>0,<sp/>0),<sp/>&amp;n_f,<sp/>&amp;piv(0),<sp/>&amp;eps,<sp/>&amp;rk,<sp/>&amp;W(0),<sp/>&amp;nw,<sp/>&amp;infoo);</highlight></codeline>
<codeline lineno="363"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(W.resize(nw<sp/>=<sp/>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal">)std::lrint(W(0))),<sp/>n<sp/>=<sp/>0;<sp/>n<sp/>&lt;<sp/>N;<sp/>n++)</highlight></codeline>
<codeline lineno="364"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>piv<sp/>=<sp/>0,<sp/>F77NAME(dgelsy)(&amp;n_f,<sp/>&amp;n_f,<sp/>&amp;n_eb,<sp/>&amp;Mf(n,<sp/>0,<sp/>0),<sp/>&amp;n_f,<sp/>&amp;Meb(n,<sp/>0,<sp/>0),<sp/>&amp;n_f,<sp/>&amp;piv(0),<sp/>&amp;eps,<sp/>&amp;rk,<sp/>&amp;W(0),<sp/>&amp;nw,<sp/>&amp;infoo);</highlight></codeline>
<codeline lineno="365"><highlight class="normal"></highlight></codeline>
<codeline lineno="366"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>substitution<sp/>dans<sp/>Feb<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="367"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(i<sp/>=<sp/>0;<sp/>i<sp/>&lt;<sp/>n_f;<sp/>i++)</highlight></codeline>
<codeline lineno="368"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(j<sp/>=<sp/>0;<sp/>j<sp/>&lt;<sp/>n_eb;<sp/>j++)</highlight></codeline>
<codeline lineno="369"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(n<sp/>=<sp/>0;<sp/>n<sp/>&lt;<sp/>N;<sp/>n++)</highlight></codeline>
<codeline lineno="370"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(k<sp/>=<sp/>0;<sp/>k<sp/>&lt;<sp/>n_f;<sp/>k++)</highlight></codeline>
<codeline lineno="371"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Feb(i,<sp/>j,<sp/>n)<sp/>+=<sp/>Ff(i,<sp/>k,<sp/>n)<sp/>*<sp/>Meb(n,<sp/>j,<sp/>k);</highlight></codeline>
<codeline lineno="372"><highlight class="normal"></highlight></codeline>
<codeline lineno="373"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>A<sp/>:<sp/>forme<sp/>bilineaire<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="374"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(essai<sp/>==<sp/>2)<sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight><highlight class="comment">//pas<sp/>la<sp/>peine<sp/>pour<sp/>VFSYM</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="375"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(A.<ref refid="classTRUSTTab_1a9b2632fe559a20c048cbfddc5c40ed16" kindref="member">resize</ref>(N,<sp/>n_e,<sp/>n_e),<sp/>A<sp/>=<sp/>0,<sp/>i<sp/>=<sp/>0;<sp/>i<sp/>&lt;<sp/>n_e;<sp/>i++)</highlight></codeline>
<codeline lineno="376"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(e<sp/>=<sp/>s_eb[i],<sp/>j<sp/>=<sp/>0;<sp/>j<sp/>&lt;<sp/>(int)<sp/>se_f[i].size();<sp/>j++)</highlight></codeline>
<codeline lineno="377"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(sgn<sp/>=<sp/>e<sp/>==<sp/>f_e(f<sp/>=<sp/>s_f[k<sp/>=<sp/>se_f[i][j]],<sp/>0)<sp/>?<sp/>1<sp/>:<sp/>-1,<sp/>l<sp/>=<sp/>0;<sp/>l<sp/>&lt;<sp/>n_e;<sp/>l++)</highlight></codeline>
<codeline lineno="378"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(n<sp/>=<sp/>0;<sp/>n<sp/>&lt;<sp/>N;<sp/>n++)</highlight></codeline>
<codeline lineno="379"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>A(n,<sp/>i,<sp/>l)<sp/>-=<sp/>sgn<sp/>*<sp/>Feb(k,<sp/>l,<sp/>n);</highlight></codeline>
<codeline lineno="380"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>symmetrisation<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="381"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(n<sp/>=<sp/>0;<sp/>n<sp/>&lt;<sp/>N;<sp/>n++)</highlight></codeline>
<codeline lineno="382"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(i<sp/>=<sp/>0;<sp/>i<sp/>&lt;<sp/>n_e;<sp/>i++)</highlight></codeline>
<codeline lineno="383"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(j<sp/>=<sp/>0;<sp/>j<sp/>&lt;=<sp/>i;<sp/>j++)<sp/>A(n,<sp/>i,<sp/>j)<sp/>=<sp/>A(n,<sp/>j,<sp/>i)<sp/>=<sp/>(A(n,<sp/>i,<sp/>j)<sp/>+<sp/>A(n,<sp/>j,<sp/>i))<sp/>/<sp/>2;</highlight></codeline>
<codeline lineno="384"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>v.p.<sp/>la<sp/>plus<sp/>petite<sp/>:<sp/>DSYEV<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="385"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nw<sp/>=<sp/>-1,<sp/>F77NAME(DSYEV)(</highlight><highlight class="stringliteral">&quot;N&quot;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&quot;U&quot;</highlight><highlight class="normal">,<sp/>&amp;n_e,<sp/>&amp;A(0,<sp/>0,<sp/>0),<sp/>&amp;n_e,<sp/>S.<ref refid="classTRUSTArray_1a62f5eeb66939850d54464bb1e9c34d3d" kindref="member">addr</ref>(),<sp/>&amp;W(0),<sp/>&amp;nw,<sp/>&amp;infoo);</highlight></codeline>
<codeline lineno="386"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(W.resize(nw<sp/>=<sp/>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal">)std::lrint(W(0))),<sp/>S.<ref refid="classTRUSTTab_1a9b2632fe559a20c048cbfddc5c40ed16" kindref="member">resize</ref>(n_e),<sp/>n<sp/>=<sp/>0,<sp/>ok<sp/>=<sp/>1;<sp/>n<sp/>&lt;<sp/>N;<sp/>n++)</highlight></codeline>
<codeline lineno="387"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>F77NAME(DSYEV)(</highlight><highlight class="stringliteral">&quot;N&quot;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&quot;U&quot;</highlight><highlight class="normal">,<sp/>&amp;n_e,<sp/>&amp;A(n,<sp/>0,<sp/>0),<sp/>&amp;n_e,<sp/>&amp;S(0),<sp/>&amp;W(0),<sp/>&amp;nw,<sp/>&amp;infoo),<sp/>ok<sp/>&amp;=<sp/>S(0)<sp/>&gt;<sp/>-1e-8<sp/>*<sp/>vol_s;</highlight></codeline>
<codeline lineno="388"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(ok)<sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;<sp/></highlight><highlight class="comment">//pour<sp/>qu&apos;<sp/>&quot;essai&quot;<sp/>ait<sp/>la<sp/>bonne<sp/>valeur<sp/>en<sp/>sortie</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="389"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="390"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="classDomaine__PolyMAC__P0_1a63c1168c3f83764a72ac6702ed6e8247" kindref="member">first_fgrad_</ref>)<sp/>ctr[essai](s)<sp/>=<sp/>1;</highlight></codeline>
<codeline lineno="391"><highlight class="normal"></highlight></codeline>
<codeline lineno="392"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>stockage<sp/>dans<sp/>phif_c<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="393"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(i<sp/>=<sp/>0;<sp/>i<sp/>&lt;<sp/>n_f;<sp/>i++)</highlight></codeline>
<codeline lineno="394"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(f<sp/>=<sp/>s_f[i],<sp/>j<sp/>=<sp/>0;<sp/>j<sp/>&lt;<sp/>n_eb;<sp/>j++)</highlight></codeline>
<codeline lineno="395"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(k<sp/>=<sp/>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal">)(std::lower_bound(<ref refid="classDomaine__PolyMAC__P0_1a96d3d935dedc7028d07466d995339b85" kindref="member">fsten_eb</ref>.<ref refid="classTRUSTArray_1a62f5eeb66939850d54464bb1e9c34d3d" kindref="member">addr</ref>()<sp/>+<sp/><ref refid="classDomaine__PolyMAC__P0_1af6cdf6aa2e97688740c497eb277486cb" kindref="member">fsten_d</ref>(f),<sp/><ref refid="classDomaine__PolyMAC__P0_1a96d3d935dedc7028d07466d995339b85" kindref="member">fsten_eb</ref>.<ref refid="classTRUSTArray_1a62f5eeb66939850d54464bb1e9c34d3d" kindref="member">addr</ref>()<sp/>+<sp/><ref refid="classDomaine__PolyMAC__P0_1af6cdf6aa2e97688740c497eb277486cb" kindref="member">fsten_d</ref>(f<sp/>+<sp/>1),<sp/>s_eb[j])<sp/>-<sp/><ref refid="classDomaine__PolyMAC__P0_1a96d3d935dedc7028d07466d995339b85" kindref="member">fsten_eb</ref>.<ref refid="classTRUSTArray_1a62f5eeb66939850d54464bb1e9c34d3d" kindref="member">addr</ref>()),<sp/>n<sp/>=<sp/>0;<sp/>n<sp/>&lt;<sp/>N;<sp/>n++)</highlight></codeline>
<codeline lineno="396"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>phif_c(k,<sp/>n)<sp/>+=<sp/>Feb(i,<sp/>j,<sp/>n)<sp/>/<sp/>fs(f);</highlight></codeline>
<codeline lineno="397"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="398"><highlight class="normal"></highlight></codeline>
<codeline lineno="399"><highlight class="normal"></highlight></codeline>
<codeline lineno="400"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">/*<sp/>simplification<sp/>du<sp/>stencil<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="401"><highlight class="normal"></highlight></codeline>
<codeline lineno="402"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>skip;</highlight></codeline>
<codeline lineno="403"><highlight class="normal"><sp/><sp/><ref refid="classTRUSTTrav" kindref="compound">DoubleTrav</ref><sp/>scale(N);</highlight></codeline>
<codeline lineno="404"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(phif_d.resize(1),<sp/>phif_d<sp/>=<sp/>0,<sp/>phif_e.resize(0),<sp/>f<sp/>=<sp/>0,<sp/>i<sp/>=<sp/>0;<sp/>f<sp/>&lt;<sp/>nb_faces_tot();<sp/>f++,<sp/>phif_d.append_line(i))</highlight></codeline>
<codeline lineno="405"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(fbord(f)<sp/>&gt;=<sp/>0<sp/>||<sp/>(f_e(f,<sp/>0)<sp/>&gt;=<sp/>0<sp/>&amp;&amp;<sp/>f_e(f,<sp/>1)<sp/>&gt;=<sp/>0))</highlight></codeline>
<codeline lineno="406"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="407"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(n<sp/>=<sp/>0;<sp/>n<sp/>&lt;<sp/>N;<sp/>n++)<sp/>scale(n)<sp/>=<sp/>nu_dot(nu,<sp/>f_e(f,<sp/>0),<sp/>n,<sp/>&amp;nf(f,<sp/>0),<sp/>&amp;nf(f,<sp/>0))<sp/>/<sp/>(fs(f)<sp/>*<sp/>vf(f));<sp/></highlight><highlight class="comment">//ordre<sp/>de<sp/>grandeur<sp/>des<sp/>coefficients</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="408"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(j<sp/>=<sp/>fsten_d(f);<sp/>j<sp/>&lt;<sp/>fsten_d(f<sp/>+<sp/>1);<sp/>j++)</highlight></codeline>
<codeline lineno="409"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="410"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(skip<sp/>=<sp/>!full_stencil<sp/>&amp;&amp;<sp/>fsten_eb(j)<sp/>!=<sp/>f_e(f,<sp/>0),<sp/>n<sp/>=<sp/>0;<sp/>n<sp/>&lt;<sp/>N;<sp/>n++)<sp/>skip<sp/>&amp;=<sp/>std::fabs(phif_c(j,<sp/>n))<sp/>&lt;<sp/>1e-8<sp/>*<sp/>scale(n);<sp/></highlight><highlight class="comment">//que<sp/>mettre<sp/>ici?</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="411"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(skip)<sp/></highlight><highlight class="keywordflow">continue</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="412"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(n<sp/>=<sp/>0;<sp/>n<sp/>&lt;<sp/>N;<sp/>n++)<sp/>phif_c(i,<sp/>n)<sp/>=<sp/>phif_c(j,<sp/>n);</highlight></codeline>
<codeline lineno="413"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>phif_e.append_line(fsten_eb(j)),<sp/>i++;</highlight></codeline>
<codeline lineno="414"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="415"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="416"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">/*<sp/>comptage<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="417"><highlight class="normal"><sp/><sp/>statistics().<ref refid="classPerf__counters_1ad528e593c4ea8c18b317fef30632b053" kindref="member">end_count</ref>(</highlight><highlight class="stringliteral">&quot;f_grad&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="418"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!first_fgrad_)<sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="419"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>count[3]<sp/>=<sp/>{<sp/>mp_somme_vect_as_double(ctr[0]),<sp/>mp_somme_vect_as_double(ctr[1]),<sp/>mp_somme_vect_as_double(ctr[2])<sp/>},<sp/>tot<sp/>=<sp/>count[0]<sp/>+<sp/>count[1]<sp/>+<sp/>count[2];</highlight></codeline>
<codeline lineno="420"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(tot<sp/>&gt;<sp/>1.0e-4)</highlight></codeline>
<codeline lineno="421"><highlight class="normal"><sp/><sp/><sp/><sp/>Cerr<sp/>&lt;&lt;<sp/>domaine().le_nom()<sp/>&lt;&lt;<sp/></highlight><highlight class="stringliteral">&quot;::fgrad():<sp/>&quot;</highlight><highlight class="normal"><sp/>&lt;&lt;<sp/>100.<sp/>*<sp/>count[0]<sp/>/<sp/>tot<sp/>&lt;&lt;<sp/></highlight><highlight class="stringliteral">&quot;%<sp/>MPFA-O<sp/>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="422"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&lt;&lt;<sp/>100.<sp/>*<sp/>count[1]<sp/>/<sp/>tot<sp/>&lt;&lt;<sp/></highlight><highlight class="stringliteral">&quot;%<sp/>MPFA-O(h)<sp/>&quot;</highlight><highlight class="normal"><sp/>&lt;&lt;<sp/>100.<sp/>*<sp/>count[2]<sp/>/<sp/>tot<sp/>&lt;&lt;<sp/></highlight><highlight class="stringliteral">&quot;%<sp/>MPFA-SYM&quot;</highlight><highlight class="normal"><sp/>&lt;&lt;<sp/>finl;</highlight></codeline>
<codeline lineno="423"><highlight class="normal"><sp/><sp/>first_fgrad_<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="424"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="425"><highlight class="normal">}</highlight></codeline>
    </programlisting>
    <location file="/volatile/catA/gj277443/TRUST/sync-doc/src/PolyMAC/Geometrie/Domaine_PolyMAC_P0.cpp"/>
  </compounddef>
</doxygen>
