<?xml version='1.0' encoding='UTF-8' standalone='no'?>
<doxygen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="compound.xsd" version="1.9.1" xml:lang="en-US">
  <compounddef id="TRUSTArray_8cpp" kind="file" language="C++">
    <compoundname>TRUSTArray.cpp</compoundname>
    <includes local="no">arch.h</includes>
    <includes refid="TRUSTArray_8h" local="no">TRUSTArray.h</includes>
    <includes local="no">string.h</includes>
    <includes refid="DeviceMemory_8h" local="no">DeviceMemory.h</includes>
    <includes refid="Perf__counters_8h" local="no">Perf_counters.h</includes>
    <incdepgraph>
      <node id="2">
        <label>arch.h</label>
      </node>
      <node id="1">
        <label>TRUSTArray.cpp</label>
        <link refid="TRUSTArray_8cpp"/>
        <childnode refid="2" relation="include">
        </childnode>
        <childnode refid="3" relation="include">
        </childnode>
      </node>
      <node id="3">
        <label>string.h</label>
      </node>
    </incdepgraph>
    <briefdescription>
    </briefdescription>
    <detaileddescription>
    </detaileddescription>
    <programlisting>
<codeline lineno="1"><highlight class="comment">/****************************************************************************</highlight></codeline>
<codeline lineno="2"><highlight class="comment">*<sp/>Copyright<sp/>(c)<sp/>2025,<sp/>CEA</highlight></codeline>
<codeline lineno="3"><highlight class="comment">*<sp/>All<sp/>rights<sp/>reserved.</highlight></codeline>
<codeline lineno="4"><highlight class="comment">*</highlight></codeline>
<codeline lineno="5"><highlight class="comment">*<sp/>Redistribution<sp/>and<sp/>use<sp/>in<sp/>source<sp/>and<sp/>binary<sp/>forms,<sp/>with<sp/>or<sp/>without<sp/>modification,<sp/>are<sp/>permitted<sp/>provided<sp/>that<sp/>the<sp/>following<sp/>conditions<sp/>are<sp/>met:</highlight></codeline>
<codeline lineno="6"><highlight class="comment">*<sp/>1.<sp/>Redistributions<sp/>of<sp/>source<sp/>code<sp/>must<sp/>retain<sp/>the<sp/>above<sp/>copyright<sp/>notice,<sp/>this<sp/>list<sp/>of<sp/>conditions<sp/>and<sp/>the<sp/>following<sp/>disclaimer.</highlight></codeline>
<codeline lineno="7"><highlight class="comment">*<sp/>2.<sp/>Redistributions<sp/>in<sp/>binary<sp/>form<sp/>must<sp/>reproduce<sp/>the<sp/>above<sp/>copyright<sp/>notice,<sp/>this<sp/>list<sp/>of<sp/>conditions<sp/>and<sp/>the<sp/>following<sp/>disclaimer<sp/>in<sp/>the<sp/>documentation<sp/>and/or<sp/>other<sp/>materials<sp/>provided<sp/>with<sp/>the<sp/>distribution.</highlight></codeline>
<codeline lineno="8"><highlight class="comment">*<sp/>3.<sp/>Neither<sp/>the<sp/>name<sp/>of<sp/>the<sp/>copyright<sp/>holder<sp/>nor<sp/>the<sp/>names<sp/>of<sp/>its<sp/>contributors<sp/>may<sp/>be<sp/>used<sp/>to<sp/>endorse<sp/>or<sp/>promote<sp/>products<sp/>derived<sp/>from<sp/>this<sp/>software<sp/>without<sp/>specific<sp/>prior<sp/>written<sp/>permission.</highlight></codeline>
<codeline lineno="9"><highlight class="comment">*</highlight></codeline>
<codeline lineno="10"><highlight class="comment">*<sp/>THIS<sp/>SOFTWARE<sp/>IS<sp/>PROVIDED<sp/>BY<sp/>THE<sp/>COPYRIGHT<sp/>HOLDERS<sp/>AND<sp/>CONTRIBUTORS<sp/>&quot;AS<sp/>IS&quot;<sp/>AND<sp/>ANY<sp/>EXPRESS<sp/>OR<sp/>IMPLIED<sp/>WARRANTIES,<sp/>INCLUDING,<sp/>BUT<sp/>NOT<sp/>LIMITED<sp/>TO,<sp/>THE<sp/>IMPLIED<sp/>WARRANTIES<sp/>OF<sp/>MERCHANTABILITY<sp/>AND<sp/>FITNESS<sp/>FOR<sp/>A<sp/>PARTICULAR<sp/>PURPOSE<sp/>ARE<sp/>DISCLAIMED.</highlight></codeline>
<codeline lineno="11"><highlight class="comment">*<sp/>IN<sp/>NO<sp/>EVENT<sp/>SHALL<sp/>THE<sp/>COPYRIGHT<sp/>HOLDER<sp/>OR<sp/>CONTRIBUTORS<sp/>BE<sp/>LIABLE<sp/>FOR<sp/>ANY<sp/>DIRECT,<sp/>INDIRECT,<sp/>INCIDENTAL,<sp/>SPECIAL,<sp/>EXEMPLARY,<sp/>OR<sp/>CONSEQUENTIAL<sp/>DAMAGES<sp/>(INCLUDING,<sp/>BUT<sp/>NOT<sp/>LIMITED<sp/>TO,<sp/>PROCUREMENT<sp/>OF<sp/>SUBSTITUTE<sp/>GOODS<sp/>OR<sp/>SERVICES;<sp/>LOSS<sp/>OF<sp/>USE,<sp/>DATA,<sp/>OR<sp/>PROFITS;</highlight></codeline>
<codeline lineno="12"><highlight class="comment">*<sp/>OR<sp/>BUSINESS<sp/>INTERRUPTION)<sp/>HOWEVER<sp/>CAUSED<sp/>AND<sp/>ON<sp/>ANY<sp/>THEORY<sp/>OF<sp/>LIABILITY,<sp/>WHETHER<sp/>IN<sp/>CONTRACT,<sp/>STRICT<sp/>LIABILITY,<sp/>OR<sp/>TORT<sp/>(INCLUDING<sp/>NEGLIGENCE<sp/>OR<sp/>OTHERWISE)<sp/>ARISING<sp/>IN<sp/>ANY<sp/>WAY<sp/>OUT<sp/>OF<sp/>THE<sp/>USE<sp/>OF<sp/>THIS<sp/>SOFTWARE,<sp/>EVEN<sp/>IF<sp/>ADVISED<sp/>OF<sp/>THE<sp/>POSSIBILITY<sp/>OF<sp/>SUCH<sp/>DAMAGE.</highlight></codeline>
<codeline lineno="13"><highlight class="comment">*</highlight></codeline>
<codeline lineno="14"><highlight class="comment">*****************************************************************************/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="15"><highlight class="normal"></highlight></codeline>
<codeline lineno="16"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;arch.h&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="17"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;TRUSTArray.h&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="18"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;string.h&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="19"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;DeviceMemory.h&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="20"><highlight class="normal"></highlight></codeline>
<codeline lineno="21"><highlight class="normal"></highlight><highlight class="preprocessor">#ifndef<sp/>LATATOOLS</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="22"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;Perf_counters.h&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="23"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="24"><highlight class="normal"></highlight></codeline>
<codeline lineno="25"><highlight class="normal"></highlight><highlight class="comment">//<sp/>TRUSTArray<sp/>kernels<sp/>for<sp/>device<sp/>moved<sp/>in<sp/>.cpp<sp/>file<sp/>to<sp/>avoid<sp/>multiple<sp/>definition<sp/>during<sp/>link</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="26"><highlight class="normal"></highlight><highlight class="keyword">template</highlight><highlight class="normal"><sp/>&lt;</highlight><highlight class="keyword">typename</highlight><highlight class="normal"><sp/>_TYPE_,<sp/></highlight><highlight class="keyword">typename</highlight><highlight class="normal"><sp/>_SIZE_&gt;</highlight></codeline>
<codeline lineno="27" refid="classTRUSTArray_1aff282138221e17247c1079125a82840a" refkind="member"><highlight class="normal"><ref refid="classSortie" kindref="compound">Sortie</ref>&amp;<sp/><ref refid="classTRUSTArray_1aff282138221e17247c1079125a82840a" kindref="member">TRUSTArray&lt;_TYPE_, _SIZE_&gt;::printOn</ref>(<ref refid="classSortie" kindref="compound">Sortie</ref>&amp;<sp/>os)</highlight><highlight class="keyword"><sp/>const</highlight></codeline>
<codeline lineno="28"><highlight class="keyword"></highlight><highlight class="normal">{</highlight></codeline>
<codeline lineno="29"><highlight class="normal"></highlight><highlight class="preprocessor">#ifndef<sp/>LATATOOLS</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="30"><highlight class="normal"><sp/><sp/>this-&gt;ensureDataOnHost();</highlight></codeline>
<codeline lineno="31"><highlight class="normal"><sp/><sp/>_SIZE_<sp/>sz<sp/>=<sp/>size_array();</highlight></codeline>
<codeline lineno="32"><highlight class="normal"><sp/><sp/>os<sp/>&lt;&lt;<sp/>sz<sp/>&lt;&lt;<sp/>finl;</highlight></codeline>
<codeline lineno="33"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(sz<sp/>&gt;<sp/>0)</highlight></codeline>
<codeline lineno="34"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="35"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>_TYPE_*<sp/>v<sp/>=<sp/>span_.data();</highlight></codeline>
<codeline lineno="36"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>os.<ref refid="classSortie_1a4e4a98f0185e240cf78c34483edafe51" kindref="member">put</ref>(v,sz,sz);</highlight></codeline>
<codeline lineno="37"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="38"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="39"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>os;</highlight></codeline>
<codeline lineno="40"><highlight class="normal">}</highlight></codeline>
<codeline lineno="41"><highlight class="normal"></highlight></codeline>
<codeline lineno="42"><highlight class="normal"></highlight><highlight class="keyword">template</highlight><highlight class="normal"><sp/>&lt;</highlight><highlight class="keyword">typename</highlight><highlight class="normal"><sp/>_TYPE_,<sp/></highlight><highlight class="keyword">typename</highlight><highlight class="normal"><sp/>_SIZE_&gt;</highlight></codeline>
<codeline lineno="43" refid="classTRUSTArray_1aed8588fcae4f6535dbdbf7cbc5a6e594" refkind="member"><highlight class="normal"><ref refid="classEntree" kindref="compound">Entree</ref>&amp;<sp/><sp/><ref refid="classTRUSTArray_1aed8588fcae4f6535dbdbf7cbc5a6e594" kindref="member">TRUSTArray&lt;_TYPE_, _SIZE_&gt;::readOn</ref>(<ref refid="classEntree" kindref="compound">Entree</ref>&amp;<sp/>is)</highlight></codeline>
<codeline lineno="44"><highlight class="normal">{</highlight></codeline>
<codeline lineno="45"><highlight class="normal"></highlight><highlight class="preprocessor">#ifndef<sp/>LATATOOLS</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="46"><highlight class="normal"><sp/><sp/>_SIZE_<sp/>sz;</highlight></codeline>
<codeline lineno="47"><highlight class="normal"><sp/><sp/>is<sp/>&gt;&gt;<sp/>sz;</highlight></codeline>
<codeline lineno="48"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(sz<sp/>&gt;=<sp/>0)</highlight></codeline>
<codeline lineno="49"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="50"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Appel<sp/>a<sp/>la<sp/>methode<sp/>sans<sp/>precondition<sp/>sur<sp/>le<sp/>type<sp/>derive<sp/>(car<sp/>readOn<sp/>est<sp/>virtuelle,<sp/>les<sp/>autres<sp/>proprietes<sp/>seront<sp/>initialisees<sp/>correctement)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="51"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>resize_array_(sz);</highlight></codeline>
<codeline lineno="52"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(sz<sp/>&gt;<sp/>0)</highlight></codeline>
<codeline lineno="53"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="54"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>_TYPE_*<sp/>v<sp/>=<sp/>span_.data();</highlight></codeline>
<codeline lineno="55"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>is.<ref refid="classEntree_1ac51bf56d33f44cef1f366219204ff61e" kindref="member">get</ref>(v,sz);</highlight></codeline>
<codeline lineno="56"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="57"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="58"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="59"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="60"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>Cerr<sp/>&lt;&lt;<sp/></highlight><highlight class="stringliteral">&quot;Error<sp/>in<sp/>TRUSTArray:readOn<sp/>:<sp/>size<sp/>=<sp/>&quot;</highlight><highlight class="normal"><sp/>&lt;&lt;<sp/>sz<sp/>&lt;&lt;<sp/>finl;</highlight></codeline>
<codeline lineno="61"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classProcess_1acc2fbbe761e08e5870ae605c0705491c" kindref="member">Process::exit</ref>();</highlight></codeline>
<codeline lineno="62"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="63"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="64"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>is;</highlight></codeline>
<codeline lineno="65"><highlight class="normal">}</highlight></codeline>
<codeline lineno="66"><highlight class="normal"></highlight></codeline>
<codeline lineno="67"><highlight class="normal"></highlight><highlight class="comment"></highlight></codeline>
<codeline lineno="68"><highlight class="comment">/**<sp/>Protected<sp/>method<sp/>for<sp/>resize.<sp/>Used<sp/>by<sp/>derived<sp/>classes.</highlight></codeline>
<codeline lineno="69"><highlight class="comment"><sp/>*<sp/>Same<sp/>as<sp/>resize_array()<sp/>with<sp/>less<sp/>checks.</highlight></codeline>
<codeline lineno="70"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="71"><highlight class="comment"><sp/>*<sp/>This<sp/>is<sp/>also<sp/>where<sp/>we<sp/>deal<sp/>with<sp/>the<sp/>STORAGE::TEMP_STORAGE<sp/>capability,<sp/>i.e.<sp/>the<sp/>Trav<sp/>arrays.</highlight></codeline>
<codeline lineno="72"><highlight class="comment"><sp/>*<sp/>There<sp/>memory<sp/>is<sp/>taken<sp/>from<sp/>a<sp/>shared<sp/>pool<sp/>(TRUSTTravPool).<sp/>This<sp/>kind<sp/>of<sp/>array<sp/>should<sp/>never<sp/>be</highlight></codeline>
<codeline lineno="73"><highlight class="comment"><sp/>*<sp/>used<sp/>in<sp/>64bits,<sp/>since<sp/>Trav<sp/>are<sp/>meaningful<sp/>when<sp/>inside<sp/>the<sp/>timestepping<sp/>(so<sp/>the<sp/>32bit<sp/>world<sp/>after<sp/>the</highlight></codeline>
<codeline lineno="74"><highlight class="comment"><sp/>*<sp/>Scatter<sp/>isntruction).</highlight></codeline>
<codeline lineno="75"><highlight class="comment"><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="76"><highlight class="normal"></highlight><highlight class="keyword">template</highlight><highlight class="normal"><sp/>&lt;</highlight><highlight class="keyword">typename</highlight><highlight class="normal"><sp/>_TYPE_,<sp/></highlight><highlight class="keyword">typename</highlight><highlight class="normal"><sp/>_SIZE_&gt;</highlight></codeline>
<codeline lineno="77" refid="classTRUSTArray_1a25060dbeb8a87fbac124faa427ab4e80" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="classTRUSTArray_1a25060dbeb8a87fbac124faa427ab4e80" kindref="member">TRUSTArray&lt;_TYPE_, _SIZE_&gt;::resize_array_</ref>(_SIZE_<sp/>new_size,<sp/>RESIZE_OPTIONS<sp/>opt)</highlight></codeline>
<codeline lineno="78"><highlight class="normal">{</highlight></codeline>
<codeline lineno="79"><highlight class="normal"><sp/><sp/>assert(new_size<sp/>&gt;=<sp/>0);</highlight></codeline>
<codeline lineno="80"><highlight class="normal"></highlight></codeline>
<codeline lineno="81"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(mem_<sp/>==<sp/></highlight><highlight class="keyword">nullptr</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="82"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="83"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!span_.empty())<sp/></highlight><highlight class="comment">//<sp/>ref_data!<sp/>We<sp/>may<sp/>pass<sp/>here<sp/>if<sp/>just<sp/>changing<sp/>the<sp/>shape<sp/>of<sp/>a<sp/>tab</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="84"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="85"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>assert(size_array()<sp/>==<sp/>new_size);</highlight></codeline>
<codeline lineno="86"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal">;<sp/><sp/></highlight><highlight class="comment">//<sp/>Nothing<sp/>to<sp/>do<sp/>...</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="87"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="88"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>We<sp/>avoid<sp/>allocating<sp/>for<sp/>empty<sp/>arrays<sp/>...<sp/>those<sp/>are<sp/>typically<sp/>situations<sp/>where<sp/>we<sp/>will<sp/>resize<sp/>(with<sp/>a<sp/>non</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="89"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>null<sp/>size)<sp/>just<sp/>after,<sp/>so<sp/>the<sp/>real<sp/>allocation<sp/>will<sp/>be<sp/>made<sp/>at<sp/>that<sp/>point.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="90"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(new_size<sp/>==<sp/>0)<sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="91" refid="classTRUSTArray_1aff282138221e17247c1079125a82840a" refkind="member"><highlight class="normal"></highlight></codeline>
<codeline lineno="92" refid="classTRUSTArray_1aed8588fcae4f6535dbdbf7cbc5a6e594" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>First<sp/>allocation<sp/>-<sp/>memory<sp/>space<sp/>should<sp/>really<sp/>be<sp/>malloc&apos;d:</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="93"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(storage_type_<sp/>==<sp/>STORAGE::TEMP_STORAGE)</highlight></codeline>
<codeline lineno="94"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>mem_<sp/>=<sp/><ref refid="classTRUSTTravPool_1a5989d2d099ba01c42723e390127fcf2c" kindref="member">TRUSTTravPool&lt;_TYPE_&gt;::GetFreeBlock</ref>((</highlight><highlight class="keywordtype">int</highlight><highlight class="normal">)new_size);</highlight></codeline>
<codeline lineno="95"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="96"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>mem_<sp/>=<sp/>std::make_shared&lt;Vector_&gt;(<ref refid="classTRUSTArray_1abdb23444ba9c5f5f1e3a21c84942173b" kindref="member">Vector_</ref>(new_size));</highlight></codeline>
<codeline lineno="97"><highlight class="normal"></highlight></codeline>
<codeline lineno="98"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>span_<sp/>=<sp/><ref refid="classTRUSTArray_1ac6c60259324f8d23ff8c963e55506fbe" kindref="member">Span_</ref>(*mem_);</highlight></codeline>
<codeline lineno="99"><highlight class="normal"></highlight></codeline>
<codeline lineno="100"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>We<sp/>should<sp/>never<sp/>have<sp/>to<sp/>worry<sp/>about<sp/>device<sp/>allocation<sp/>here:</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="101"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(isAllocatedOnDevice(mem_-&gt;data()))</highlight></codeline>
<codeline lineno="102"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>data_location_<sp/>=<sp/>std::make_shared&lt;DataLocation&gt;(DataLocation::Device);</highlight></codeline>
<codeline lineno="103"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="104"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>data_location_<sp/>=<sp/>std::make_shared&lt;DataLocation&gt;(DataLocation::HostOnly);</highlight></codeline>
<codeline lineno="105"><highlight class="normal"></highlight></codeline>
<codeline lineno="106"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(opt<sp/>==<sp/>RESIZE_OPTIONS::COPY_INIT)</highlight></codeline>
<codeline lineno="107"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>operator=((_TYPE_)0);<sp/></highlight><highlight class="comment">//<sp/>To<sp/>initialize<sp/>on<sp/>device<sp/>or<sp/>host</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="108"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//std::fill(mem_-&gt;begin(),<sp/>mem_-&gt;end(),<sp/>(_TYPE_)<sp/>0);</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="109"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="110"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="111"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="112"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Array<sp/>is<sp/>already<sp/>allocated,<sp/>we<sp/>want<sp/>to<sp/>resize:</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="113"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>array<sp/>must<sp/>not<sp/>be<sp/>shared!<sp/>(also<sp/>checked<sp/>in<sp/>resize_array())<sp/>...<sp/>but,<sp/>still,<sp/>we<sp/>allow<sp/>passing<sp/>here<sp/>(i.e.<sp/>no<sp/>assert)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="114"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>only<sp/>if<sp/>we<sp/>keep<sp/>the<sp/>same<sp/>size_array().<sp/>This<sp/>is<sp/>for<sp/>example<sp/>invoked<sp/>by<sp/>TRUSTTab<sp/>when<sp/>just<sp/>changing<sp/>the<sp/>overall<sp/>shape<sp/>of</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="115"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>the<sp/>array<sp/>without<sp/>modifying<sp/>the<sp/>total<sp/>number<sp/>of<sp/>elems<sp/>...</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="116"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>_SIZE_<sp/>sz_arr<sp/>=<sp/>size_array();</highlight></codeline>
<codeline lineno="117"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(new_size<sp/>!=<sp/>sz_arr)<sp/></highlight><highlight class="comment">//<sp/>Yes,<sp/>we<sp/>compare<sp/>to<sp/>the<sp/>span&apos;s<sp/>size</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="118"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="119"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>assert(ref_count()<sp/>==<sp/>1);<sp/><sp/></highlight><highlight class="comment">//<sp/>from<sp/>here<sp/>on,<sp/>we<sp/>*really*<sp/>should<sp/>not<sp/>be<sp/>shared</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="120"><highlight class="normal"></highlight></codeline>
<codeline lineno="121"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(storage_type_<sp/>==<sp/>STORAGE::TEMP_STORAGE)</highlight></codeline>
<codeline lineno="122"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="123"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>No<sp/>64b<sp/>Trav:</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="124"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>assert(<sp/>(std::is_same&lt;trustIdType,<sp/>int&gt;::value<sp/>||<sp/>!std::is_same&lt;_SIZE_,<sp/>trustIdType&gt;::value)<sp/>);</highlight></codeline>
<codeline lineno="125"><highlight class="normal"></highlight></codeline>
<codeline lineno="126"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Resize<sp/>of<sp/>a<sp/>Trav:<sp/>if<sp/>the<sp/>underlying<sp/>mem_<sp/>is<sp/>already<sp/>big<sp/>enough,<sp/>just<sp/>update<sp/>the<sp/>span,<sp/>and<sp/>possibly<sp/>fill<sp/>with<sp/>0</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="127"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>else,<sp/>really<sp/>increase<sp/>memory<sp/>allocation<sp/>using<sp/>the<sp/>TRUSTTravPool.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="128"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>_SIZE_<sp/>mem_sz<sp/>=<sp/>(_SIZE_)mem_-&gt;size();</highlight></codeline>
<codeline lineno="129"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(new_size<sp/>&lt;=<sp/>mem_sz)</highlight></codeline>
<codeline lineno="130"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="131"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Cheat,<sp/>simply<sp/>update<sp/>the<sp/>span<sp/>(up<sp/>or<sp/>down)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="132"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>span_<sp/>=<sp/>Span_(span_.begin(),<sp/>span_.begin()+new_size);</highlight></codeline>
<codeline lineno="133"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Possibly<sp/>set<sp/>to<sp/>0<sp/>extended<sp/>part:</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="134"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(new_size<sp/>&gt;<sp/>sz_arr<sp/>&amp;&amp;<sp/>opt<sp/>==<sp/>RESIZE_OPTIONS::COPY_INIT)</highlight></codeline>
<codeline lineno="135"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="136"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ensureDataOnHost();</highlight></codeline>
<codeline lineno="137"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>std::fill(span_.begin()<sp/>+<sp/>sz_arr,<sp/>span_.end(),<sp/>(_TYPE_)<sp/>0);</highlight></codeline>
<codeline lineno="138"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="139"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="140"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>Real<sp/>size<sp/>increase<sp/>of<sp/>the<sp/>underlying<sp/>std::vector</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="141"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="142"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>ResizeBlock</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="143"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>mem_<sp/>=<sp/><ref refid="classTRUSTTravPool_1a85dabef91b58bf6db5ab9abd87c69667" kindref="member">TRUSTTravPool&lt;_TYPE_&gt;::ResizeBlock</ref>(mem_,<sp/>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal">)new_size);</highlight></codeline>
<codeline lineno="144"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>span_<sp/>=<sp/>Span_(*mem_);</highlight></codeline>
<codeline lineno="145"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(opt<sp/>==<sp/>RESIZE_OPTIONS::COPY_INIT)</highlight></codeline>
<codeline lineno="146"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="147"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ensureDataOnHost();</highlight></codeline>
<codeline lineno="148"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>std::fill(span_.begin()<sp/>+<sp/>sz_arr,<sp/>span_.end(),<sp/>(_TYPE_)<sp/>0);</highlight></codeline>
<codeline lineno="149"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="150"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="151"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="152"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>Normal<sp/>(non<sp/>Trav)<sp/>arrays</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="153"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="154"><highlight class="normal"></highlight><highlight class="preprocessor">#ifndef<sp/>LATATOOLS</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="155"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>onDevice<sp/>=<sp/>isAllocatedOnDevice(*</highlight><highlight class="keyword">this</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="156"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(onDevice)</highlight></codeline>
<codeline lineno="157"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="158"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>ToDo<sp/>Kokkos:<sp/>resize<sp/>on<sp/>device<sp/>is<sp/>not<sp/>optimal<sp/>for<sp/>the<sp/>moment<sp/>as<sp/>it<sp/>makes<sp/>2<sp/>copy<sp/>D2H<sp/>and<sp/>H2D</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="159"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>copyFromDevice(*</highlight><highlight class="keyword">this</highlight><highlight class="normal">);<sp/></highlight><highlight class="comment">//<sp/>Force<sp/>copie<sp/>sur<sp/>le<sp/>host</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="160"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>_TYPE_<sp/>*<sp/>prev_ad<sp/>=<sp/>span_.data();<sp/></highlight><highlight class="comment">//<sp/>before<sp/>resize!</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="161" refid="classTRUSTArray_1a6b7369280b24e4b822c4e3c548460496" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>deleteOnDevice(prev_ad,<sp/>sz_arr);<sp/></highlight><highlight class="comment">//<sp/>Delete<sp/>current<sp/>block</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="162"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>set_data_location(DataLocation::HostOnly);</highlight></codeline>
<codeline lineno="163"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="164" refid="classTRUSTArray_1aa9450c030e7c2ab06df33e7f18838528" refkind="member"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="165"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>mem_-&gt;resize(new_size);</highlight></codeline>
<codeline lineno="166"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>span_<sp/>=<sp/><ref refid="classTRUSTArray_1ac6c60259324f8d23ff8c963e55506fbe" kindref="member">Span_</ref>(*mem_);</highlight></codeline>
<codeline lineno="167" refid="classTRUSTArray_1a133a8bd6d0c8191ba4e49de1360e8da1" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Possibly<sp/>set<sp/>to<sp/>0<sp/>extended<sp/>part,<sp/>since<sp/>we<sp/>have<sp/>a<sp/>custom<sp/>Vector<sp/>allocator<sp/>not<sp/>doing<sp/>it<sp/>by<sp/>default<sp/>(TVAlloc):</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="168"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(new_size<sp/>&gt;<sp/>sz_arr<sp/>&amp;&amp;<sp/>opt<sp/>==<sp/>RESIZE_OPTIONS::COPY_INIT)</highlight></codeline>
<codeline lineno="169"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>std::fill(span_.begin()+sz_arr,<sp/>span_.end(),<sp/>(_TYPE_)<sp/>0);</highlight></codeline>
<codeline lineno="170"><highlight class="normal"></highlight><highlight class="preprocessor">#ifndef<sp/>LATATOOLS</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="171"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(onDevice)</highlight></codeline>
<codeline lineno="172"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="173"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Re-allocate<sp/>and<sp/>copy<sp/>on<sp/>device:</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="174"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>mapToDevice(*</highlight><highlight class="keyword">this</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="175"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="176"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="177"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="178"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="179"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="180"><highlight class="normal">}</highlight></codeline>
<codeline lineno="181"><highlight class="normal"></highlight><highlight class="comment"></highlight></codeline>
<codeline lineno="182"><highlight class="comment">/**<sp/><sp/>Copie<sp/>les<sp/>elements<sp/>source[first_element_source<sp/>+<sp/>i]<sp/>dans<sp/>les<sp/>elements<sp/><sp/>(*this)[first_element_dest<sp/>+<sp/>i]<sp/>pour<sp/>0<sp/>&lt;=<sp/>i<sp/>&lt;<sp/>nb_elements</highlight></codeline>
<codeline lineno="183"><highlight class="comment">*<sp/><sp/><sp/><sp/>Les<sp/>autres<sp/>elements<sp/>de<sp/>(*this)<sp/>sont<sp/>inchanges.</highlight></codeline>
<codeline lineno="184"><highlight class="comment"></highlight></codeline>
<codeline lineno="185"><highlight class="comment">*<sp/>@param<sp/><sp/>const<sp/>ArrOfDouble&amp;<sp/>m:<sp/>le<sp/>tableau<sp/>a<sp/>utiliser,<sp/>doit<sp/>etre<sp/>different<sp/>de<sp/>*this<sp/>!</highlight></codeline>
<codeline lineno="186"><highlight class="comment">*<sp/>@param<sp/>_SIZE_<sp/>nb_elements:<sp/>nombre<sp/>d&apos;elements<sp/>a<sp/>copier,<sp/>nb_elements<sp/>&gt;=<sp/>-1.<sp/>Si<sp/>nb_elements==-1,<sp/>on<sp/>copie<sp/>tout<sp/>le<sp/>tableau<sp/>m.<sp/>Valeurs<sp/>par<sp/>defaut:<sp/>-1</highlight></codeline>
<codeline lineno="187"><highlight class="comment">*<sp/>@param<sp/>_SIZE_<sp/>first_element_dest.<sp/>Valeurs<sp/>par<sp/>defaut:<sp/>0</highlight></codeline>
<codeline lineno="188"><highlight class="comment">*<sp/>@param<sp/>_SIZE_<sp/>first_element_source.<sp/>Valeurs<sp/>par<sp/>defaut:<sp/>0</highlight></codeline>
<codeline lineno="189"><highlight class="comment">*<sp/>@return<sp/>ArrOfDouble&amp;<sp/>:<sp/>*this</highlight></codeline>
<codeline lineno="190"><highlight class="comment">*<sp/>@throw<sp/>Sort<sp/>en<sp/>erreur<sp/>si<sp/>la<sp/>taille<sp/>du<sp/>tableau<sp/>m<sp/>est<sp/>plus<sp/>grande<sp/>que<sp/>la<sp/>taille<sp/>de<sp/>tableau<sp/>this.</highlight></codeline>
<codeline lineno="191"><highlight class="comment">*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="192"><highlight class="normal"></highlight><highlight class="keyword">template</highlight><highlight class="normal"><sp/>&lt;</highlight><highlight class="keyword">typename</highlight><highlight class="normal"><sp/>_TYPE_,<sp/></highlight><highlight class="keyword">typename</highlight><highlight class="normal"><sp/>_SIZE_&gt;</highlight></codeline>
<codeline lineno="193" refid="classTRUSTArray_1a678fe673d5c62662dcac939687fad90c" refkind="member"><highlight class="normal"><ref refid="classTRUSTArray" kindref="compound">TRUSTArray&lt;_TYPE_, _SIZE_&gt;</ref>&amp;<sp/><ref refid="classTRUSTArray_1a678fe673d5c62662dcac939687fad90c" kindref="member">TRUSTArray&lt;_TYPE_, _SIZE_&gt;::inject_array</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="classTRUSTArray" kindref="compound">TRUSTArray</ref>&amp;<sp/>source,<sp/>_SIZE_<sp/>nb_elements,<sp/>_SIZE_<sp/>first_element_dest,<sp/>_SIZE_<sp/>first_element_source)</highlight></codeline>
<codeline lineno="194"><highlight class="normal">{</highlight></codeline>
<codeline lineno="195"><highlight class="normal"><sp/><sp/>assert(&amp;source<sp/>!=<sp/></highlight><highlight class="keyword">this</highlight><highlight class="normal"><sp/>&amp;&amp;<sp/>nb_elements<sp/>&gt;=<sp/>-1);</highlight></codeline>
<codeline lineno="196"><highlight class="normal"><sp/><sp/>assert(first_element_dest<sp/>&gt;=<sp/>0<sp/>&amp;&amp;<sp/>first_element_source<sp/>&gt;=<sp/>0);</highlight></codeline>
<codeline lineno="197"><highlight class="normal"></highlight></codeline>
<codeline lineno="198"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(nb_elements<sp/>&lt;<sp/>0)<sp/>nb_elements<sp/>=<sp/>source.<ref refid="classTRUSTArray_1a48b5aa02624ffdc0bad44ca38ddd1a1c" kindref="member">size_array</ref>();</highlight></codeline>
<codeline lineno="199"><highlight class="normal"></highlight></codeline>
<codeline lineno="200"><highlight class="normal"><sp/><sp/>assert(first_element_source<sp/>+<sp/>nb_elements<sp/>&lt;=<sp/>source.<ref refid="classTRUSTArray_1a48b5aa02624ffdc0bad44ca38ddd1a1c" kindref="member">size_array</ref>());</highlight></codeline>
<codeline lineno="201"><highlight class="normal"><sp/><sp/>assert(first_element_dest<sp/>+<sp/>nb_elements<sp/>&lt;=<sp/>size_array());</highlight></codeline>
<codeline lineno="202"><highlight class="normal"></highlight></codeline>
<codeline lineno="203"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(nb_elements<sp/>&gt;<sp/>0)</highlight></codeline>
<codeline lineno="204"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="205" refid="classTRUSTArray_1a327cf65f1333405551bf812e9e1797a5" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>kernelOnDevice<sp/>=<sp/>checkDataOnDevice(source);</highlight></codeline>
<codeline lineno="206"><highlight class="normal"></highlight><highlight class="preprocessor">#ifndef<sp/>LATATOOLS</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="207"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(statistics().get_use_gpu()<sp/>&amp;&amp;<sp/>nb_elements&gt;100)<sp/>start_gpu_timer(__KERNEL_NAME__);</highlight></codeline>
<codeline lineno="208" refid="classTRUSTArray_1a81338001a3b2f38943c4c03485a23e6e" refkind="member"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="209"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(kernelOnDevice)</highlight></codeline>
<codeline lineno="210"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="211" refid="classTRUSTArray_1a60d225a395471e8aa0d8edb33f14f1aa" refkind="member"><highlight class="normal"></highlight><highlight class="preprocessor">#ifndef<sp/>LATATOOLS</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="212"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">auto</highlight><highlight class="normal"><sp/>addr_source<sp/>=<sp/>source.view_ro&lt;1&gt;();</highlight></codeline>
<codeline lineno="213"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">auto</highlight><highlight class="normal"><sp/>addr_dest<sp/>=<sp/>view_rw&lt;1&gt;();</highlight></codeline>
<codeline lineno="214" refid="classTRUSTArray_1a914cefef8382ae2efa9eedb7ec2c2395" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Kokkos::parallel_for(__KERNEL_NAME__,<sp/>nb_elements,<sp/>KOKKOS_LAMBDA(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>_SIZE_<sp/>i)<sp/>{<sp/>addr_dest[first_element_dest+i]<sp/>=<sp/>addr_source[first_element_source+i];<sp/>});</highlight></codeline>
<codeline lineno="215"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="216"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="217" refid="classTRUSTArray_1afb4e5196c96ec4fc105d00543bcd0a9d" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="218"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="219"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>PL:<sp/>On<sp/>utilise<sp/>le<sp/>memcpy<sp/>car<sp/>c&apos;est<sp/>VRAIMENT<sp/>plus<sp/>rapide<sp/>(10%<sp/>+vite<sp/>sur<sp/>RNR_G20)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="220" refid="classTRUSTArray_1a3a88e5d43509ef09691d4ed6d84b3344" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>_TYPE_<sp/>*<sp/>addr_source<sp/>=<sp/>source.span_.data()<sp/>+<sp/>first_element_source;</highlight></codeline>
<codeline lineno="221"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>_TYPE_<sp/>*<sp/>addr_dest<sp/>=<sp/>span_.data()<sp/>+<sp/>first_element_dest;</highlight></codeline>
<codeline lineno="222"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>memcpy(addr_dest,<sp/>addr_source,<sp/>nb_elements<sp/>*<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(_TYPE_));</highlight></codeline>
<codeline lineno="223" refid="classTRUSTArray_1a54b288f32c77255e24af9b6c78d8b994" refkind="member"><highlight class="normal"></highlight><highlight class="preprocessor">#ifdef<sp/>TRUST_USE_GPU</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="224"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="structDeviceMemory_1a7ab4e031c2b55cf7d01eaeb3dfece269" kindref="member">DeviceMemory::warning</ref>(nb_elements)<sp/>&amp;&amp;<sp/><ref refid="classProcess_1acd052b99706c577f8a5b6656217cf4c2" kindref="member">Process::je_suis_maitre</ref>())</highlight></codeline>
<codeline lineno="225" refid="classTRUSTArray_1a678fe673d5c62662dcac939687fad90c" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Cerr<sp/>&lt;&lt;<sp/></highlight><highlight class="stringliteral">&quot;[Host]<sp/>Filling<sp/>a<sp/>large<sp/>TRUSTArray<sp/>(&quot;</highlight><highlight class="normal"><sp/>&lt;&lt;<sp/>nb_elements<sp/>&lt;&lt;<sp/></highlight><highlight class="stringliteral">&quot;<sp/>items)<sp/>which<sp/>is<sp/>slow<sp/>during<sp/>a<sp/>GPU<sp/>run!<sp/>Set<sp/>a<sp/>breakpoint<sp/>to<sp/>fix.&quot;</highlight><highlight class="normal"><sp/>&lt;&lt;<sp/>finl;</highlight></codeline>
<codeline lineno="226"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="227"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="228"><highlight class="normal"></highlight><highlight class="preprocessor">#ifndef<sp/>LATATOOLS</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="229"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(statistics().get_use_gpu()<sp/>&amp;&amp;<sp/>nb_elements&gt;100)<sp/>end_gpu_timer(__KERNEL_NAME__,<sp/>kernelOnDevice);</highlight></codeline>
<codeline lineno="230"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="231"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="232"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>*</highlight><highlight class="keyword">this</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="233"><highlight class="normal">}</highlight></codeline>
<codeline lineno="234"><highlight class="normal"></highlight></codeline>
<codeline lineno="235"><highlight class="normal"></highlight><highlight class="keyword">template</highlight><highlight class="normal">&lt;</highlight><highlight class="keyword">typename</highlight><highlight class="normal"><sp/>_TYPE_,<sp/></highlight><highlight class="keyword">typename</highlight><highlight class="normal"><sp/>_SIZE_&gt;</highlight></codeline>
<codeline lineno="236"><highlight class="normal"></highlight><highlight class="keyword">template</highlight><highlight class="normal">&lt;</highlight><highlight class="keyword">typename</highlight><highlight class="normal"><sp/>_TAB_&gt;</highlight></codeline>
<codeline lineno="237"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="classTRUSTArray" kindref="compound">TRUSTArray&lt;_TYPE_, _SIZE_&gt;::ref_conv_helper_</ref>(_TAB_&amp;<sp/>out)</highlight><highlight class="keyword"><sp/>const</highlight></codeline>
<codeline lineno="238"><highlight class="keyword"></highlight><highlight class="normal">{</highlight></codeline>
<codeline lineno="239"><highlight class="normal"><sp/><sp/>out.<ref refid="classTRUSTArray_1ac843dea33bcbcbc63e52b0f63514ddfd" kindref="member">detach_array</ref>();</highlight></codeline>
<codeline lineno="240"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>Same<sp/>as<sp/>&apos;attach_array()&apos;,<sp/>but<sp/>since<sp/>we<sp/>are<sp/>crossing<sp/>templates<sp/>parameters,<sp/>we<sp/>can<sp/>not<sp/>call<sp/>it<sp/>directly:</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="241"><highlight class="normal"><sp/><sp/>out.mem_<sp/>=<sp/>mem_;</highlight></codeline>
<codeline lineno="242"><highlight class="normal"><sp/><sp/>out.span_<sp/>=<sp/>span_;</highlight></codeline>
<codeline lineno="243"><highlight class="normal"><sp/><sp/>out.data_location_<sp/>=<sp/>data_location_;</highlight></codeline>
<codeline lineno="244"><highlight class="normal"><sp/><sp/>out.storage_type_<sp/>=<sp/>storage_type_;</highlight></codeline>
<codeline lineno="245"><highlight class="normal">}</highlight></codeline>
<codeline lineno="246"><highlight class="normal"></highlight><highlight class="comment"></highlight></codeline>
<codeline lineno="247"><highlight class="comment">/*!<sp/>Conversion<sp/>methods<sp/>-<sp/>from<sp/>a<sp/>small<sp/>array<sp/>(_SIZE_=int)<sp/>of<sp/>TID<sp/>(_TYPE_=trustIdType),<sp/>return<sp/>a<sp/>big<sp/>one<sp/>(_SIZE_=trustIdType).</highlight></codeline>
<codeline lineno="248"><highlight class="comment"><sp/>*<sp/>No<sp/>data<sp/>copied!<sp/>This<sp/>behaves<sp/>somewhat<sp/>like<sp/>a<sp/>ref_array.<sp/>Used<sp/>in<sp/>LATA<sp/>stuff<sp/>notably.<sp/>Not<sp/>implemented<sp/>for<sp/>_TYPE_=double<sp/>or<sp/>float</highlight></codeline>
<codeline lineno="249"><highlight class="comment"><sp/>*<sp/>(because<sp/>never<sp/>needed).</highlight></codeline>
<codeline lineno="250"><highlight class="comment"><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="251"><highlight class="normal"></highlight><highlight class="keyword">template</highlight><highlight class="normal">&lt;&gt;</highlight></codeline>
<codeline lineno="252"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="classTRUSTArray_1a6b7369280b24e4b822c4e3c548460496" kindref="member">TRUSTArray&lt;trustIdType, int&gt;::ref_as_big</ref>(<ref refid="classTRUSTArray" kindref="compound">TRUSTArray&lt;trustIdType,trustIdType&gt;</ref>&amp;<sp/>out)</highlight><highlight class="keyword"><sp/>const</highlight></codeline>
<codeline lineno="253"><highlight class="keyword"></highlight><highlight class="normal">{</highlight></codeline>
<codeline lineno="254"><highlight class="normal"><sp/><sp/>ref_conv_helper_(out);</highlight></codeline>
<codeline lineno="255"><highlight class="normal">}</highlight></codeline>
<codeline lineno="256"><highlight class="normal"></highlight></codeline>
<codeline lineno="257"><highlight class="normal"></highlight><highlight class="keyword">template</highlight><highlight class="normal">&lt;</highlight><highlight class="keyword">typename</highlight><highlight class="normal"><sp/>_TYPE_,<sp/></highlight><highlight class="keyword">typename</highlight><highlight class="normal"><sp/>_SIZE_&gt;</highlight></codeline>
<codeline lineno="258" refid="classTRUSTArray_1a6b7369280b24e4b822c4e3c548460496" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="classTRUSTArray_1a6b7369280b24e4b822c4e3c548460496" kindref="member">TRUSTArray&lt;_TYPE_,_SIZE_&gt;::ref_as_big</ref>(<ref refid="classTRUSTArray" kindref="compound">TRUSTArray&lt;_TYPE_,trustIdType&gt;</ref>&amp;<sp/>out)</highlight><highlight class="keyword"><sp/>const</highlight></codeline>
<codeline lineno="259"><highlight class="keyword"></highlight><highlight class="normal">{</highlight></codeline>
<codeline lineno="260"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>Should<sp/>no<sp/>be<sp/>used<sp/>for<sp/>anything<sp/>else<sp/>than<sp/>specialisations<sp/>listed<sp/>above.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="261"><highlight class="normal"><sp/><sp/>assert(</highlight><highlight class="keyword">false</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="262"><highlight class="normal"><sp/><sp/><ref refid="classProcess_1acc2fbbe761e08e5870ae605c0705491c" kindref="member">Process::exit</ref>(</highlight><highlight class="stringliteral">&quot;TRUSTArray&lt;&gt;::ref_as_big()<sp/>should<sp/>not<sp/>be<sp/>used<sp/>with<sp/>those<sp/>current<sp/>template<sp/>types.&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="263"><highlight class="normal">}</highlight></codeline>
<codeline lineno="264"><highlight class="normal"></highlight><highlight class="comment"></highlight></codeline>
<codeline lineno="265"><highlight class="comment">/*!<sp/>Conversion<sp/>methods<sp/>-<sp/>from<sp/>a<sp/>big<sp/>array<sp/>(_SIZE_=trustIdType),<sp/>return<sp/>a<sp/>small<sp/>one<sp/>(_SIZE_=int).</highlight></codeline>
<codeline lineno="266"><highlight class="comment"><sp/>*<sp/>Overflow<sp/>is<sp/>detected<sp/>in<sp/>debug<sp/>if<sp/>array<sp/>is<sp/>too<sp/>big<sp/>to<sp/>be<sp/>fit<sp/>into<sp/>_SIZE_=int.</highlight></codeline>
<codeline lineno="267"><highlight class="comment"><sp/>*<sp/>No<sp/>data<sp/>copied!<sp/>This<sp/>behaves<sp/>somewhat<sp/>like<sp/>a<sp/>ref_array.<sp/>Used<sp/>in<sp/>LATA<sp/>stuff<sp/>and<sp/>FT<sp/>notably.</highlight></codeline>
<codeline lineno="268"><highlight class="comment"><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="269"><highlight class="normal"></highlight><highlight class="keyword">template</highlight><highlight class="normal">&lt;&gt;</highlight></codeline>
<codeline lineno="270" refid="classTRUSTArray_1a925b9ab3b7f6e8f24f4e7dd93f445370" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="classTRUSTArray_1aa9450c030e7c2ab06df33e7f18838528" kindref="member">TRUSTArray&lt;float, trustIdType&gt;::ref_as_small</ref>(<ref refid="classTRUSTArray" kindref="compound">TRUSTArray&lt;float, int&gt;</ref>&amp;<sp/>out)</highlight><highlight class="keyword"><sp/>const</highlight></codeline>
<codeline lineno="271"><highlight class="keyword"></highlight><highlight class="normal">{</highlight></codeline>
<codeline lineno="272"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>Check<sp/>size<sp/>fits<sp/>in<sp/>32bits:</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="273"><highlight class="normal"><sp/><sp/>assert(size_array()<sp/>&lt;<sp/>std::numeric_limits&lt;int&gt;::max());</highlight></codeline>
<codeline lineno="274"><highlight class="normal"><sp/><sp/>ref_conv_helper_(out);</highlight></codeline>
<codeline lineno="275"><highlight class="normal">}</highlight></codeline>
<codeline lineno="276"><highlight class="normal"></highlight></codeline>
<codeline lineno="277"><highlight class="normal"></highlight><highlight class="keyword">template</highlight><highlight class="normal">&lt;&gt;</highlight></codeline>
<codeline lineno="278" refid="classTRUSTArray_1a97558009b35279beb28767f665390e9f" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="classTRUSTArray_1aa9450c030e7c2ab06df33e7f18838528" kindref="member">TRUSTArray&lt;int, trustIdType&gt;::ref_as_small</ref>(<ref refid="classTRUSTArray" kindref="compound">TRUSTArray&lt;int, int&gt;</ref>&amp;<sp/>out)</highlight><highlight class="keyword"><sp/>const</highlight></codeline>
<codeline lineno="279"><highlight class="keyword"></highlight><highlight class="normal">{</highlight></codeline>
<codeline lineno="280"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>Check<sp/>size<sp/>fits<sp/>in<sp/>32bits:</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="281"><highlight class="normal"><sp/><sp/>assert(size_array()<sp/>&lt;<sp/>std::numeric_limits&lt;int&gt;::max());</highlight></codeline>
<codeline lineno="282"><highlight class="normal"><sp/><sp/>ref_conv_helper_(out);</highlight></codeline>
<codeline lineno="283"><highlight class="normal">}</highlight></codeline>
<codeline lineno="284"><highlight class="normal"></highlight></codeline>
<codeline lineno="285"><highlight class="normal"></highlight><highlight class="keyword">template</highlight><highlight class="normal">&lt;</highlight><highlight class="keyword">typename</highlight><highlight class="normal"><sp/>_TYPE_,<sp/></highlight><highlight class="keyword">typename</highlight><highlight class="normal"><sp/>_SIZE_&gt;</highlight></codeline>
<codeline lineno="286" refid="classTRUSTArray_1aa9450c030e7c2ab06df33e7f18838528" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="classTRUSTArray_1aa9450c030e7c2ab06df33e7f18838528" kindref="member">TRUSTArray&lt;_TYPE_,_SIZE_&gt;::ref_as_small</ref>(<ref refid="classTRUSTArray" kindref="compound">TRUSTArray&lt;_TYPE_, int&gt;</ref>&amp;<sp/>out)</highlight><highlight class="keyword"><sp/>const</highlight></codeline>
<codeline lineno="287"><highlight class="keyword"></highlight><highlight class="normal">{</highlight></codeline>
<codeline lineno="288"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>Should<sp/>no<sp/>be<sp/>used<sp/>for<sp/>anything<sp/>else<sp/>than<sp/>specialisations<sp/>listed<sp/>above.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="289"><highlight class="normal"><sp/><sp/>assert(</highlight><highlight class="keyword">false</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="290"><highlight class="normal"><sp/><sp/><ref refid="classProcess_1acc2fbbe761e08e5870ae605c0705491c" kindref="member">Process::exit</ref>(</highlight><highlight class="stringliteral">&quot;TRUSTArray&lt;&gt;::ref_as_big()<sp/>should<sp/>not<sp/>be<sp/>used<sp/>with<sp/>those<sp/>current<sp/>template<sp/>types.&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="291"><highlight class="normal">}</highlight></codeline>
<codeline lineno="292"><highlight class="normal"></highlight><highlight class="comment"></highlight></codeline>
<codeline lineno="293"><highlight class="comment">/*!<sp/>Conversion<sp/>from<sp/>a<sp/>BigArrOfTID<sp/>to<sp/>an<sp/>ArrOfInt.<sp/>Careful,<sp/>it<sp/>always<sp/>does<sp/>a<sp/>copy!<sp/>It<sp/>is<sp/>your<sp/>responsibility</highlight></codeline>
<codeline lineno="294"><highlight class="comment"><sp/>*<sp/>to<sp/>invoke<sp/>it<sp/>only<sp/>when<sp/>necessary<sp/>(typically<sp/>you<sp/>should<sp/>avoid<sp/>this<sp/>when<sp/>trustIdType<sp/>==<sp/>int<sp/>...)</highlight></codeline>
<codeline lineno="295"><highlight class="comment"><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="296"><highlight class="normal"></highlight><highlight class="keyword">template</highlight><highlight class="normal">&lt;&gt;</highlight></codeline>
<codeline lineno="297"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="classTRUSTArray_1a133a8bd6d0c8191ba4e49de1360e8da1" kindref="member">TRUSTArray&lt;trustIdType,trustIdType&gt;::from_tid_to_int</ref>(<ref refid="classTRUSTArray" kindref="compound">TRUSTArray&lt;int, int&gt;</ref>&amp;<sp/>out)</highlight><highlight class="keyword"><sp/>const</highlight></codeline>
<codeline lineno="298"><highlight class="keyword"></highlight><highlight class="normal">{</highlight></codeline>
<codeline lineno="299"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>Not<sp/>too<sp/>big?</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="300"><highlight class="normal"><sp/><sp/>assert(<ref refid="classTRUSTArray_1a48b5aa02624ffdc0bad44ca38ddd1a1c" kindref="member">size_array</ref>()<sp/>&lt;<sp/>std::numeric_limits&lt;int&gt;::max());</highlight></codeline>
<codeline lineno="301"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>sz_int<sp/>=<sp/>(int)<ref refid="classTRUSTArray_1a48b5aa02624ffdc0bad44ca38ddd1a1c" kindref="member">size_array</ref>();<sp/></highlight><highlight class="comment">//<sp/>we<sp/>may<sp/>cast!</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="302"><highlight class="normal"><sp/><sp/>out.<ref refid="classTRUSTArray_1a25060dbeb8a87fbac124faa427ab4e80" kindref="member">resize_array_</ref>(sz_int);<sp/><sp/></highlight><highlight class="comment">//<sp/>the<sp/>one<sp/>with<sp/>&apos;_&apos;<sp/>skipping<sp/>the<sp/>checks,<sp/>so<sp/>we<sp/>can<sp/>be<sp/>called<sp/>from<sp/>Tab<sp/>too</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="303"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(sz_int)</highlight></codeline>
<codeline lineno="304"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="305"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>All<sp/>values<sp/>within<sp/>int<sp/>range?</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="306"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>assert((<sp/><sp/><sp/>*std::min_element(span_.begin(),<sp/>span_.end())<sp/>&gt;<sp/>std::numeric_limits&lt;int&gt;::min()<sp/><sp/>));</highlight></codeline>
<codeline lineno="307"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>assert((<sp/><sp/><sp/>*std::max_element(span_.begin(),<sp/>span_.end())<sp/>&lt;<sp/>std::numeric_limits&lt;int&gt;::max()<sp/><sp/>));</highlight></codeline>
<codeline lineno="308"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="309"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>Yes,<sp/>copy:</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="310"><highlight class="normal"><sp/><sp/>std::copy(span_.begin(),<sp/>span_.end(),<sp/>out.span_.begin());</highlight></codeline>
<codeline lineno="311"><highlight class="normal">}</highlight></codeline>
<codeline lineno="312"><highlight class="normal"></highlight></codeline>
<codeline lineno="313"><highlight class="normal"></highlight><highlight class="keyword">template</highlight><highlight class="normal">&lt;</highlight><highlight class="keyword">typename</highlight><highlight class="normal"><sp/>_TYPE_,<sp/></highlight><highlight class="keyword">typename</highlight><highlight class="normal"><sp/>_SIZE_&gt;</highlight></codeline>
<codeline lineno="314" refid="classTRUSTArray_1a133a8bd6d0c8191ba4e49de1360e8da1" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="classTRUSTArray_1a133a8bd6d0c8191ba4e49de1360e8da1" kindref="member">TRUSTArray&lt;_TYPE_,_SIZE_&gt;::from_tid_to_int</ref>(<ref refid="classTRUSTArray" kindref="compound">TRUSTArray&lt;int, int&gt;</ref>&amp;<sp/>out)</highlight><highlight class="keyword"><sp/>const</highlight></codeline>
<codeline lineno="315"><highlight class="keyword"></highlight><highlight class="normal">{</highlight></codeline>
<codeline lineno="316"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>Should<sp/>no<sp/>be<sp/>used<sp/>for<sp/>anything<sp/>else<sp/>than<sp/>specialisations<sp/>listed<sp/>above.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="317"><highlight class="normal"><sp/><sp/>assert(</highlight><highlight class="keyword">false</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="318"><highlight class="normal"><sp/><sp/><ref refid="classProcess_1acc2fbbe761e08e5870ae605c0705491c" kindref="member">Process::exit</ref>(</highlight><highlight class="stringliteral">&quot;TRUSTArray&lt;&gt;::from_tid_to_int()<sp/>should<sp/>not<sp/>be<sp/>used<sp/>with<sp/>those<sp/>current<sp/>template<sp/>types.&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="319"><highlight class="normal">}</highlight></codeline>
<codeline lineno="320"><highlight class="normal"></highlight></codeline>
<codeline lineno="321"><highlight class="normal"></highlight><highlight class="comment"></highlight></codeline>
<codeline lineno="322"><highlight class="comment">/**<sp/>Remplit<sp/>le<sp/>tableau<sp/>avec<sp/>la<sp/>x<sp/>en<sp/>parametre<sp/>(x<sp/>est<sp/>affecte<sp/>a<sp/>toutes<sp/>les<sp/>cases<sp/>du<sp/>tableau)</highlight></codeline>
<codeline lineno="323"><highlight class="comment"><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="324"><highlight class="normal"></highlight><highlight class="keyword">template</highlight><highlight class="normal"><sp/>&lt;</highlight><highlight class="keyword">typename</highlight><highlight class="normal"><sp/>_TYPE_,<sp/></highlight><highlight class="keyword">typename</highlight><highlight class="normal"><sp/>_SIZE_&gt;</highlight></codeline>
<codeline lineno="325" refid="classTRUSTArray_1a327cf65f1333405551bf812e9e1797a5" refkind="member"><highlight class="normal"><ref refid="classTRUSTArray" kindref="compound">TRUSTArray&lt;_TYPE_, _SIZE_&gt;</ref>&amp;<sp/><ref refid="classTRUSTArray_1aecff560951cc3f1e7d4cbfa0754fb555" kindref="member">TRUSTArray&lt;_TYPE_, _SIZE_&gt;::operator=</ref>(_TYPE_<sp/>x)</highlight></codeline>
<codeline lineno="326"><highlight class="normal">{</highlight></codeline>
<codeline lineno="327"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>_SIZE_<sp/>size<sp/>=<sp/>size_array();</highlight></codeline>
<codeline lineno="328"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>kernelOnDevice<sp/>=<sp/>checkDataOnDevice();</highlight></codeline>
<codeline lineno="329"><highlight class="normal"></highlight><highlight class="preprocessor">#ifndef<sp/>LATATOOLS</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="330"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(statistics().get_use_gpu()<sp/>&amp;&amp;<sp/>size&gt;100)<sp/>start_gpu_timer(__KERNEL_NAME__);</highlight></codeline>
<codeline lineno="331"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="332" refid="classTRUSTArray_1a25060dbeb8a87fbac124faa427ab4e80" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(kernelOnDevice)</highlight></codeline>
<codeline lineno="333"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="334"><highlight class="normal"></highlight><highlight class="preprocessor">#ifndef<sp/>LATATOOLS</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="335"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">auto</highlight><highlight class="normal"><sp/>data<sp/>=<sp/>view_rw&lt;1&gt;();</highlight></codeline>
<codeline lineno="336"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>Kokkos::parallel_for(__KERNEL_NAME__,<sp/>size,<sp/>KOKKOS_LAMBDA(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>i)<sp/>{<sp/>data[i]<sp/>=<sp/>x;<sp/>});</highlight></codeline>
<codeline lineno="337"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="338"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="339"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="340"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="341"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>_TYPE_<sp/>*data<sp/>=<sp/>span_.data();</highlight></codeline>
<codeline lineno="342"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(_SIZE_<sp/>i<sp/>=<sp/>0;<sp/>i<sp/>&lt;<sp/>size;<sp/>i++)<sp/>data[i]<sp/>=<sp/>x;</highlight></codeline>
<codeline lineno="343"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="344"><highlight class="normal"></highlight><highlight class="preprocessor">#ifndef<sp/>LATATOOLS</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="345"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(statistics().get_use_gpu()<sp/>&amp;&amp;<sp/>size&gt;100)<sp/>end_gpu_timer(__KERNEL_NAME__,<sp/>kernelOnDevice);</highlight></codeline>
<codeline lineno="346"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="347"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>*</highlight><highlight class="keyword">this</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="348"><highlight class="normal">}</highlight></codeline>
<codeline lineno="349"><highlight class="normal"></highlight><highlight class="comment"></highlight></codeline>
<codeline lineno="350"><highlight class="comment">/**<sp/>Addition<sp/>case<sp/>a<sp/>case<sp/>sur<sp/>toutes<sp/>les<sp/>cases<sp/>du<sp/>tableau<sp/>:<sp/>la<sp/>taille<sp/>de<sp/>y<sp/>doit<sp/>etre<sp/>au<sp/>moins<sp/>egale<sp/>a<sp/>la<sp/>taille<sp/>de<sp/>this</highlight></codeline>
<codeline lineno="351"><highlight class="comment"><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="352"><highlight class="normal"></highlight><highlight class="keyword">template</highlight><highlight class="normal"><sp/>&lt;</highlight><highlight class="keyword">typename</highlight><highlight class="normal"><sp/>_TYPE_,<sp/></highlight><highlight class="keyword">typename</highlight><highlight class="normal"><sp/>_SIZE_&gt;</highlight></codeline>
<codeline lineno="353" refid="classTRUSTArray_1a81338001a3b2f38943c4c03485a23e6e" refkind="member"><highlight class="normal"><ref refid="classTRUSTArray" kindref="compound">TRUSTArray&lt;_TYPE_, _SIZE_&gt;</ref>&amp;<sp/><ref refid="classTRUSTArray_1a81338001a3b2f38943c4c03485a23e6e" kindref="member">TRUSTArray&lt;_TYPE_, _SIZE_&gt;::operator+=</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="classTRUSTArray" kindref="compound">TRUSTArray</ref>&amp;<sp/>y)</highlight></codeline>
<codeline lineno="354"><highlight class="normal">{</highlight></codeline>
<codeline lineno="355"><highlight class="normal"><sp/><sp/>assert(size_array()==y.<ref refid="classTRUSTArray_1a48b5aa02624ffdc0bad44ca38ddd1a1c" kindref="member">size_array</ref>());</highlight></codeline>
<codeline lineno="356"><highlight class="normal"><sp/><sp/>_SIZE_<sp/>size<sp/>=<sp/>size_array();</highlight></codeline>
<codeline lineno="357"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>kernelOnDevice<sp/>=<sp/>checkDataOnDevice(y);</highlight></codeline>
<codeline lineno="358"><highlight class="normal"></highlight><highlight class="preprocessor">#ifndef<sp/>LATATOOLS</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="359"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(statistics().get_use_gpu()<sp/>&amp;&amp;<sp/>size&gt;100)<sp/>start_gpu_timer(__KERNEL_NAME__);</highlight></codeline>
<codeline lineno="360"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="361"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(kernelOnDevice)</highlight></codeline>
<codeline lineno="362"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="363"><highlight class="normal"></highlight><highlight class="preprocessor">#ifndef<sp/>LATATOOLS</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="364"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">auto</highlight><highlight class="normal"><sp/>dy<sp/>=<sp/>y.view_ro&lt;1&gt;();</highlight></codeline>
<codeline lineno="365"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">auto</highlight><highlight class="normal"><sp/>dx<sp/>=<sp/>view_rw&lt;1&gt;();</highlight></codeline>
<codeline lineno="366"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>Kokkos::parallel_for(__KERNEL_NAME__,<sp/>size,<sp/>KOKKOS_LAMBDA(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>_SIZE_<sp/>i)<sp/>{<sp/>dx[i]<sp/>+=<sp/>dy[i];<sp/>});</highlight></codeline>
<codeline lineno="367"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="368"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="369"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="370"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="371"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>_TYPE_*<sp/>dy<sp/>=<sp/>y.span_.data();</highlight></codeline>
<codeline lineno="372"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>_TYPE_*<sp/>dx<sp/>=<sp/>span_.data();</highlight></codeline>
<codeline lineno="373"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(_SIZE_<sp/>i<sp/>=<sp/>0;<sp/>i<sp/>&lt;<sp/>size;<sp/>i++)<sp/>dx[i]<sp/>+=<sp/>dy[i];</highlight></codeline>
<codeline lineno="374"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="375"><highlight class="normal"></highlight><highlight class="preprocessor">#ifndef<sp/>LATATOOLS</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="376"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(statistics().get_use_gpu()<sp/>&amp;&amp;<sp/>size&gt;100)<sp/>end_gpu_timer(__KERNEL_NAME__,<sp/>kernelOnDevice);</highlight></codeline>
<codeline lineno="377"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="378"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>*</highlight><highlight class="keyword">this</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="379"><highlight class="normal">}</highlight></codeline>
<codeline lineno="380"><highlight class="normal"></highlight><highlight class="comment"></highlight></codeline>
<codeline lineno="381"><highlight class="comment">/**<sp/>Ajoute<sp/>la<sp/>meme<sp/>valeur<sp/>a<sp/>toutes<sp/>les<sp/>cases<sp/>du<sp/>tableau</highlight></codeline>
<codeline lineno="382"><highlight class="comment"><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="383"><highlight class="normal"></highlight><highlight class="keyword">template</highlight><highlight class="normal"><sp/>&lt;</highlight><highlight class="keyword">typename</highlight><highlight class="normal"><sp/>_TYPE_,<sp/></highlight><highlight class="keyword">typename</highlight><highlight class="normal"><sp/>_SIZE_&gt;</highlight></codeline>
<codeline lineno="384" refid="classTRUSTArray_1a60d225a395471e8aa0d8edb33f14f1aa" refkind="member"><highlight class="normal"><ref refid="classTRUSTArray" kindref="compound">TRUSTArray&lt;_TYPE_, _SIZE_&gt;</ref>&amp;<sp/><ref refid="classTRUSTArray_1a81338001a3b2f38943c4c03485a23e6e" kindref="member">TRUSTArray&lt;_TYPE_, _SIZE_&gt;::operator+=</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>_TYPE_<sp/>dy)</highlight></codeline>
<codeline lineno="385"><highlight class="normal">{</highlight></codeline>
<codeline lineno="386"><highlight class="normal"><sp/><sp/>_SIZE_<sp/>size<sp/>=<sp/>size_array();</highlight></codeline>
<codeline lineno="387"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>kernelOnDevice<sp/>=<sp/>checkDataOnDevice();</highlight></codeline>
<codeline lineno="388"><highlight class="normal"></highlight><highlight class="preprocessor">#ifndef<sp/>LATATOOLS</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="389"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(statistics().get_use_gpu()<sp/>&amp;&amp;<sp/>size&gt;100)<sp/>start_gpu_timer(__KERNEL_NAME__);</highlight></codeline>
<codeline lineno="390"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="391"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(kernelOnDevice)</highlight></codeline>
<codeline lineno="392"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="393"><highlight class="normal"></highlight><highlight class="preprocessor">#ifndef<sp/>LATATOOLS</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="394"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">auto</highlight><highlight class="normal"><sp/>data<sp/>=<sp/>view_rw&lt;1&gt;();</highlight></codeline>
<codeline lineno="395"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>Kokkos::parallel_for(__KERNEL_NAME__,<sp/>size,<sp/>KOKKOS_LAMBDA(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>_SIZE_<sp/>i)<sp/>{<sp/>data[i]<sp/>+=<sp/>dy;<sp/>});</highlight></codeline>
<codeline lineno="396"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="397"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="398"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="399"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="400"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>_TYPE_<sp/>*data<sp/>=<sp/>span_.data();</highlight></codeline>
<codeline lineno="401"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal">(_SIZE_<sp/>i<sp/>=<sp/>0;<sp/>i<sp/>&lt;<sp/>size;<sp/>i++)<sp/>data[i]<sp/>+=<sp/>dy;</highlight></codeline>
<codeline lineno="402"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="403"><highlight class="normal"></highlight><highlight class="preprocessor">#ifndef<sp/>LATATOOLS</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="404"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(statistics().get_use_gpu()<sp/>&amp;&amp;<sp/>size&gt;100)<sp/>end_gpu_timer(__KERNEL_NAME__,<sp/>kernelOnDevice);</highlight></codeline>
<codeline lineno="405"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="406"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>*</highlight><highlight class="keyword">this</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="407"><highlight class="normal">}</highlight></codeline>
<codeline lineno="408"><highlight class="normal"></highlight><highlight class="comment"></highlight></codeline>
<codeline lineno="409"><highlight class="comment">/**<sp/>Soustraction<sp/>case<sp/>a<sp/>case<sp/>sur<sp/>toutes<sp/>les<sp/>cases<sp/>du<sp/>tableau<sp/>:<sp/>tableau<sp/>de<sp/>meme<sp/>taille<sp/>que<sp/>*this</highlight></codeline>
<codeline lineno="410"><highlight class="comment"><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="411"><highlight class="normal"></highlight><highlight class="keyword">template</highlight><highlight class="normal"><sp/>&lt;</highlight><highlight class="keyword">typename</highlight><highlight class="normal"><sp/>_TYPE_,<sp/></highlight><highlight class="keyword">typename</highlight><highlight class="normal"><sp/>_SIZE_&gt;</highlight></codeline>
<codeline lineno="412" refid="classTRUSTArray_1a914cefef8382ae2efa9eedb7ec2c2395" refkind="member"><highlight class="normal"><ref refid="classTRUSTArray" kindref="compound">TRUSTArray&lt;_TYPE_, _SIZE_&gt;</ref>&amp;<sp/><ref refid="classTRUSTArray_1a914cefef8382ae2efa9eedb7ec2c2395" kindref="member">TRUSTArray&lt;_TYPE_, _SIZE_&gt;::operator-=</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="classTRUSTArray" kindref="compound">TRUSTArray</ref>&amp;<sp/>y)</highlight></codeline>
<codeline lineno="413"><highlight class="normal">{</highlight></codeline>
<codeline lineno="414"><highlight class="normal"><sp/><sp/>assert(size_array()<sp/>==<sp/>y.<ref refid="classTRUSTArray_1a48b5aa02624ffdc0bad44ca38ddd1a1c" kindref="member">size_array</ref>());</highlight></codeline>
<codeline lineno="415"><highlight class="normal"><sp/><sp/>_SIZE_<sp/>size<sp/>=<sp/>size_array();</highlight></codeline>
<codeline lineno="416"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>kernelOnDevice<sp/>=<sp/>checkDataOnDevice(y);</highlight></codeline>
<codeline lineno="417"><highlight class="normal"></highlight><highlight class="preprocessor">#ifndef<sp/>LATATOOLS</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="418"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(statistics().get_use_gpu()<sp/>&amp;&amp;<sp/>size&gt;100)<sp/>start_gpu_timer(__KERNEL_NAME__);</highlight></codeline>
<codeline lineno="419"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="420"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(kernelOnDevice)</highlight></codeline>
<codeline lineno="421"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="422"><highlight class="normal"></highlight><highlight class="preprocessor">#ifndef<sp/>LATATOOLS</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="423"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">auto</highlight><highlight class="normal"><sp/>data<sp/>=<sp/>view_rw&lt;1&gt;();</highlight></codeline>
<codeline lineno="424"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">auto</highlight><highlight class="normal"><sp/>data_y<sp/>=<sp/>y.view_ro&lt;1&gt;();</highlight></codeline>
<codeline lineno="425"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>Kokkos::parallel_for(__KERNEL_NAME__,<sp/>size,<sp/>KOKKOS_LAMBDA(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>_SIZE_<sp/>i)<sp/>{<sp/>data[i]<sp/>-=<sp/>data_y[i];<sp/>});</highlight></codeline>
<codeline lineno="426"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="427"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="428"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="429"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="430"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>_TYPE_<sp/>*<sp/>data<sp/>=<sp/>span_.<ref refid="classTRUSTArray_1a9ec33fa4863d56044782dc86c2b0a83e" kindref="member">data</ref>();</highlight></codeline>
<codeline lineno="431"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>_TYPE_<sp/>*<sp/>data_y<sp/>=<sp/>y.span_.data();</highlight></codeline>
<codeline lineno="432"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(_SIZE_<sp/>i<sp/>=<sp/>0;<sp/>i<sp/>&lt;<sp/>size;<sp/>i++)<sp/>data[i]<sp/>-=<sp/>data_y[i];</highlight></codeline>
<codeline lineno="433"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="434"><highlight class="normal"></highlight><highlight class="preprocessor">#ifndef<sp/>LATATOOLS</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="435"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(statistics().get_use_gpu()<sp/>&amp;&amp;<sp/>size&gt;100)<sp/>end_gpu_timer(__KERNEL_NAME__,<sp/>kernelOnDevice);</highlight></codeline>
<codeline lineno="436"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="437"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>*</highlight><highlight class="keyword">this</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="438"><highlight class="normal">}</highlight></codeline>
<codeline lineno="439"><highlight class="normal"></highlight><highlight class="comment"></highlight></codeline>
<codeline lineno="440"><highlight class="comment">/**<sp/>soustrait<sp/>la<sp/>meme<sp/>valeur<sp/>a<sp/>toutes<sp/>les<sp/>cases</highlight></codeline>
<codeline lineno="441"><highlight class="comment"><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="442"><highlight class="normal"></highlight><highlight class="keyword">template</highlight><highlight class="normal"><sp/>&lt;</highlight><highlight class="keyword">typename</highlight><highlight class="normal"><sp/>_TYPE_,<sp/></highlight><highlight class="keyword">typename</highlight><highlight class="normal"><sp/>_SIZE_&gt;</highlight></codeline>
<codeline lineno="443" refid="classTRUSTArray_1afb4e5196c96ec4fc105d00543bcd0a9d" refkind="member"><highlight class="normal"><ref refid="classTRUSTArray" kindref="compound">TRUSTArray&lt;_TYPE_, _SIZE_&gt;</ref>&amp;<sp/><ref refid="classTRUSTArray_1a914cefef8382ae2efa9eedb7ec2c2395" kindref="member">TRUSTArray&lt;_TYPE_, _SIZE_&gt;::operator-=</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>_TYPE_<sp/>dy)</highlight></codeline>
<codeline lineno="444"><highlight class="normal">{</highlight></codeline>
<codeline lineno="445"><highlight class="normal"><sp/><sp/>operator+=(-dy);</highlight></codeline>
<codeline lineno="446"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>*</highlight><highlight class="keyword">this</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="447"><highlight class="normal">}</highlight></codeline>
<codeline lineno="448"><highlight class="normal"></highlight><highlight class="comment"></highlight></codeline>
<codeline lineno="449"><highlight class="comment">/**<sp/>muliplie<sp/>toutes<sp/>les<sp/>cases<sp/>par<sp/>dy</highlight></codeline>
<codeline lineno="450"><highlight class="comment"><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="451"><highlight class="normal"></highlight><highlight class="keyword">template</highlight><highlight class="normal"><sp/>&lt;</highlight><highlight class="keyword">typename</highlight><highlight class="normal"><sp/>_TYPE_,<sp/></highlight><highlight class="keyword">typename</highlight><highlight class="normal"><sp/>_SIZE_&gt;</highlight></codeline>
<codeline lineno="452" refid="classTRUSTArray_1a3a88e5d43509ef09691d4ed6d84b3344" refkind="member"><highlight class="normal"><ref refid="classTRUSTArray" kindref="compound">TRUSTArray&lt;_TYPE_, _SIZE_&gt;</ref>&amp;<sp/><ref refid="classTRUSTArray_1a3a88e5d43509ef09691d4ed6d84b3344" kindref="member">TRUSTArray&lt;_TYPE_, _SIZE_&gt;::operator*= </ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>_TYPE_<sp/>dy)</highlight></codeline>
<codeline lineno="453"><highlight class="normal">{</highlight></codeline>
<codeline lineno="454"><highlight class="normal"><sp/><sp/>_SIZE_<sp/>size<sp/>=<sp/>size_array();</highlight></codeline>
<codeline lineno="455"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>kernelOnDevice<sp/>=<sp/>checkDataOnDevice();</highlight></codeline>
<codeline lineno="456"><highlight class="normal"></highlight><highlight class="preprocessor">#ifndef<sp/>LATATOOLS</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="457"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(statistics().get_use_gpu()<sp/>&amp;&amp;<sp/>size&gt;100)<sp/>start_gpu_timer(__KERNEL_NAME__);</highlight></codeline>
<codeline lineno="458"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="459"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(kernelOnDevice)</highlight></codeline>
<codeline lineno="460"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="461"><highlight class="normal"></highlight><highlight class="preprocessor">#ifndef<sp/>LATATOOLS</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="462"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">auto</highlight><highlight class="normal"><sp/>data<sp/>=<sp/>view_rw&lt;1&gt;();</highlight></codeline>
<codeline lineno="463"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>Kokkos::parallel_for(__KERNEL_NAME__,<sp/>size,<sp/>KOKKOS_LAMBDA(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>_SIZE_<sp/>i)<sp/>{<sp/>data[i]<sp/>*=<sp/>dy;<sp/>});</highlight></codeline>
<codeline lineno="464"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="465"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="466"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="467"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="468"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>_TYPE_<sp/>*data<sp/>=<sp/>span_.data();</highlight></codeline>
<codeline lineno="469"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal">(_SIZE_<sp/>i=0;<sp/>i<sp/>&lt;<sp/>size;<sp/>i++)<sp/>data[i]<sp/>*=<sp/>dy;</highlight></codeline>
<codeline lineno="470"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="471"><highlight class="normal"></highlight><highlight class="preprocessor">#ifndef<sp/>LATATOOLS</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="472"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(statistics().get_use_gpu()<sp/>&amp;&amp;<sp/>size&gt;100)<sp/>end_gpu_timer(__KERNEL_NAME__,<sp/>kernelOnDevice);</highlight></codeline>
<codeline lineno="473"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="474"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>*</highlight><highlight class="keyword">this</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="475"><highlight class="normal">}</highlight></codeline>
<codeline lineno="476"><highlight class="normal"></highlight><highlight class="comment"></highlight></codeline>
<codeline lineno="477"><highlight class="comment">/**<sp/>divise<sp/>toutes<sp/>les<sp/>cases<sp/>par<sp/>dy<sp/>(pas<sp/>pour<sp/>TRUSTArray&lt;int&gt;)</highlight></codeline>
<codeline lineno="478"><highlight class="comment"><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="479"><highlight class="normal"></highlight><highlight class="keyword">template</highlight><highlight class="normal"><sp/>&lt;</highlight><highlight class="keyword">typename</highlight><highlight class="normal"><sp/>_TYPE_,<sp/></highlight><highlight class="keyword">typename</highlight><highlight class="normal"><sp/>_SIZE_&gt;</highlight></codeline>
<codeline lineno="480" refid="classTRUSTArray_1a54b288f32c77255e24af9b6c78d8b994" refkind="member"><highlight class="normal"><ref refid="classTRUSTArray" kindref="compound">TRUSTArray&lt;_TYPE_, _SIZE_&gt;</ref>&amp;<sp/><ref refid="classTRUSTArray_1a54b288f32c77255e24af9b6c78d8b994" kindref="member">TRUSTArray&lt;_TYPE_, _SIZE_&gt;::operator/= </ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>_TYPE_<sp/>dy)</highlight></codeline>
<codeline lineno="481"><highlight class="normal">{</highlight></codeline>
<codeline lineno="482"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(std::is_integral&lt;_TYPE_&gt;::value)<sp/></highlight><highlight class="keywordflow">throw</highlight><highlight class="normal">;<sp/><sp/></highlight><highlight class="comment">//<sp/>division<sp/>should<sp/>not<sp/>be<sp/>called<sp/>on<sp/>integral<sp/>types.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="483"><highlight class="normal"><sp/><sp/>operator*=(1/dy);</highlight></codeline>
<codeline lineno="484"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>*</highlight><highlight class="keyword">this</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="485"><highlight class="normal">}</highlight></codeline>
<codeline lineno="486"><highlight class="normal"></highlight></codeline>
<codeline lineno="487"><highlight class="normal"></highlight><highlight class="comment">//<sp/>Pour<sp/>instancier<sp/>les<sp/>methodes<sp/>templates<sp/>dans<sp/>un<sp/>.cpp</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="488"><highlight class="normal"></highlight><highlight class="keyword">template</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="classTRUSTArray" kindref="compound">TRUSTArray&lt;double, int&gt;</ref>;</highlight></codeline>
<codeline lineno="489"><highlight class="normal"></highlight><highlight class="keyword">template</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="classTRUSTArray" kindref="compound">TRUSTArray&lt;int, int&gt;</ref>;</highlight></codeline>
<codeline lineno="490"><highlight class="normal"></highlight><highlight class="keyword">template</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="classTRUSTArray" kindref="compound">TRUSTArray&lt;float, int&gt;</ref>;</highlight></codeline>
<codeline lineno="491"><highlight class="normal"></highlight></codeline>
<codeline lineno="492"><highlight class="normal"></highlight><highlight class="preprocessor">#if<sp/>INT_is_64_<sp/>==<sp/>2</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="493"><highlight class="normal"></highlight><highlight class="keyword">template</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="classTRUSTArray" kindref="compound">TRUSTArray&lt;double, trustIdType&gt;</ref>;</highlight></codeline>
<codeline lineno="494"><highlight class="normal"></highlight><highlight class="keyword">template</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="classTRUSTArray" kindref="compound">TRUSTArray&lt;int, trustIdType&gt;</ref>;</highlight></codeline>
<codeline lineno="495"><highlight class="normal"></highlight><highlight class="keyword">template</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="classTRUSTArray" kindref="compound">TRUSTArray&lt;trustIdType, trustIdType&gt;</ref>;</highlight></codeline>
<codeline lineno="496"><highlight class="normal"></highlight><highlight class="keyword">template</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="classTRUSTArray" kindref="compound">TRUSTArray&lt;trustIdType, int&gt;</ref>;</highlight></codeline>
<codeline lineno="497"><highlight class="normal"></highlight><highlight class="keyword">template</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="classTRUSTArray" kindref="compound">TRUSTArray&lt;float, trustIdType&gt;</ref>;</highlight></codeline>
<codeline lineno="498"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight></codeline>
    </programlisting>
    <location file="/volatile/catA/gj277443/TRUST/sync-doc/src/Kernel/Math/TRUSTArray.cpp"/>
  </compounddef>
</doxygen>
