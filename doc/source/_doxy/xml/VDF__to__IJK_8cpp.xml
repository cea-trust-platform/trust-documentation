<?xml version='1.0' encoding='UTF-8' standalone='no'?>
<doxygen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="compound.xsd" version="1.9.1" xml:lang="en-US">
  <compounddef id="VDF__to__IJK_8cpp" kind="file" language="C++">
    <compoundname>VDF_to_IJK.cpp</compoundname>
    <includes refid="VDF__to__IJK_8h" local="no">VDF_to_IJK.h</includes>
    <includes refid="Schema__Comm__Vecteurs_8h" local="no">Schema_Comm_Vecteurs.h</includes>
    <includes refid="Schema__Comm_8h" local="no">Schema_Comm.h</includes>
    <includes refid="communications_8h" local="no">communications.h</includes>
    <includes refid="Domaine__VF_8h" local="no">Domaine_VF.h</includes>
    <includes refid="IJK__Field_8h" local="no">IJK_Field.h</includes>
    <includes refid="TRUSTTabs_8h" local="no">TRUSTTabs.h</includes>
    <includes refid="Array__tools_8h" local="no">Array_tools.h</includes>
    <includes refid="Domaine_8h" local="no">Domaine.h</includes>
      <sectiondef kind="func">
      <memberdef kind="function" id="VDF__to__IJK_8cpp_1a89663eb2af7f516eccc92398e444897f" prot="public" static="yes" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int</type>
        <definition>static int bsearch_double</definition>
        <argsstring>(const ArrOfDouble &amp;tab, double valeur)</argsstring>
        <name>bsearch_double</name>
        <param>
          <type>const <ref refid="classTRUSTArray" kindref="compound">ArrOfDouble</ref> &amp;</type>
          <declname>tab</declname>
        </param>
        <param>
          <type>double</type>
          <declname>valeur</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/volatile/catA/gj277443/TRUST/sync-doc/src/IJK/Tools/VDF_to_IJK.cpp" line="59" column="12" bodyfile="/volatile/catA/gj277443/TRUST/sync-doc/src/IJK/Tools/VDF_to_IJK.cpp" bodystart="59" bodyend="77"/>
      </memberdef>
      <memberdef kind="function" id="VDF__to__IJK_8cpp_1ac0dbf90d414dc5d4fff68f9ff3a91a5c" prot="public" static="yes" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>const <ref refid="classTRUSTTab" kindref="compound">DoubleTab</ref> &amp;</type>
        <definition>static const DoubleTab&amp; get_items_coords</definition>
        <argsstring>(const Domaine_VF &amp;domaine_vf, Domaine_IJK::Localisation loc, int &amp;nb_items)</argsstring>
        <name>get_items_coords</name>
        <param>
          <type>const <ref refid="classDomaine__VF" kindref="compound">Domaine_VF</ref> &amp;</type>
          <declname>domaine_vf</declname>
        </param>
        <param>
          <type><ref refid="classDomaine__IJK_1af42f29bc11c3d6e985da2a908f6e8ba3" kindref="member">Domaine_IJK::Localisation</ref></type>
          <declname>loc</declname>
        </param>
        <param>
          <type>int &amp;</type>
          <declname>nb_items</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/volatile/catA/gj277443/TRUST/sync-doc/src/IJK/Tools/VDF_to_IJK.cpp" line="79" column="24" bodyfile="/volatile/catA/gj277443/TRUST/sync-doc/src/IJK/Tools/VDF_to_IJK.cpp" bodystart="79" bodyend="93"/>
      </memberdef>
      <memberdef kind="function" id="VDF__to__IJK_8cpp_1a5b1718b16c879a04508cd4e443893010" prot="public" static="yes" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>static void pack_lists</definition>
        <argsstring>(const VECT(ArrOfInt) &amp;src, ArrOfInt &amp;non_empty, Static_Int_Lists &amp;dest)</argsstring>
        <name>pack_lists</name>
        <param>
          <type>const VECT(<ref refid="classTRUSTArray" kindref="compound">ArrOfInt</ref>) &amp;</type>
          <declname>src</declname>
        </param>
        <param>
          <type><ref refid="classTRUSTArray" kindref="compound">ArrOfInt</ref> &amp;</type>
          <declname>non_empty</declname>
        </param>
        <param>
          <type><ref refid="classStatic__Int__Lists__32__64" kindref="compound">Static_Int_Lists</ref> &amp;</type>
          <declname>dest</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/volatile/catA/gj277443/TRUST/sync-doc/src/IJK/Tools/VDF_to_IJK.cpp" line="27" column="13" bodyfile="/volatile/catA/gj277443/TRUST/sync-doc/src/IJK/Tools/VDF_to_IJK.cpp" bodystart="27" bodyend="53"/>
      </memberdef>
      </sectiondef>
    <briefdescription>
    </briefdescription>
    <detaileddescription>
    </detaileddescription>
    <programlisting>
<codeline lineno="1"><highlight class="comment">/****************************************************************************</highlight></codeline>
<codeline lineno="2"><highlight class="comment">*<sp/>Copyright<sp/>(c)<sp/>2025,<sp/>CEA</highlight></codeline>
<codeline lineno="3"><highlight class="comment">*<sp/>All<sp/>rights<sp/>reserved.</highlight></codeline>
<codeline lineno="4"><highlight class="comment">*</highlight></codeline>
<codeline lineno="5"><highlight class="comment">*<sp/>Redistribution<sp/>and<sp/>use<sp/>in<sp/>source<sp/>and<sp/>binary<sp/>forms,<sp/>with<sp/>or<sp/>without<sp/>modification,<sp/>are<sp/>permitted<sp/>provided<sp/>that<sp/>the<sp/>following<sp/>conditions<sp/>are<sp/>met:</highlight></codeline>
<codeline lineno="6"><highlight class="comment">*<sp/>1.<sp/>Redistributions<sp/>of<sp/>source<sp/>code<sp/>must<sp/>retain<sp/>the<sp/>above<sp/>copyright<sp/>notice,<sp/>this<sp/>list<sp/>of<sp/>conditions<sp/>and<sp/>the<sp/>following<sp/>disclaimer.</highlight></codeline>
<codeline lineno="7"><highlight class="comment">*<sp/>2.<sp/>Redistributions<sp/>in<sp/>binary<sp/>form<sp/>must<sp/>reproduce<sp/>the<sp/>above<sp/>copyright<sp/>notice,<sp/>this<sp/>list<sp/>of<sp/>conditions<sp/>and<sp/>the<sp/>following<sp/>disclaimer<sp/>in<sp/>the<sp/>documentation<sp/>and/or<sp/>other<sp/>materials<sp/>provided<sp/>with<sp/>the<sp/>distribution.</highlight></codeline>
<codeline lineno="8"><highlight class="comment">*<sp/>3.<sp/>Neither<sp/>the<sp/>name<sp/>of<sp/>the<sp/>copyright<sp/>holder<sp/>nor<sp/>the<sp/>names<sp/>of<sp/>its<sp/>contributors<sp/>may<sp/>be<sp/>used<sp/>to<sp/>endorse<sp/>or<sp/>promote<sp/>products<sp/>derived<sp/>from<sp/>this<sp/>software<sp/>without<sp/>specific<sp/>prior<sp/>written<sp/>permission.</highlight></codeline>
<codeline lineno="9"><highlight class="comment">*</highlight></codeline>
<codeline lineno="10"><highlight class="comment">*<sp/>THIS<sp/>SOFTWARE<sp/>IS<sp/>PROVIDED<sp/>BY<sp/>THE<sp/>COPYRIGHT<sp/>HOLDERS<sp/>AND<sp/>CONTRIBUTORS<sp/>&quot;AS<sp/>IS&quot;<sp/>AND<sp/>ANY<sp/>EXPRESS<sp/>OR<sp/>IMPLIED<sp/>WARRANTIES,<sp/>INCLUDING,<sp/>BUT<sp/>NOT<sp/>LIMITED<sp/>TO,<sp/>THE<sp/>IMPLIED<sp/>WARRANTIES<sp/>OF<sp/>MERCHANTABILITY<sp/>AND<sp/>FITNESS<sp/>FOR<sp/>A<sp/>PARTICULAR<sp/>PURPOSE<sp/>ARE<sp/>DISCLAIMED.</highlight></codeline>
<codeline lineno="11"><highlight class="comment">*<sp/>IN<sp/>NO<sp/>EVENT<sp/>SHALL<sp/>THE<sp/>COPYRIGHT<sp/>HOLDER<sp/>OR<sp/>CONTRIBUTORS<sp/>BE<sp/>LIABLE<sp/>FOR<sp/>ANY<sp/>DIRECT,<sp/>INDIRECT,<sp/>INCIDENTAL,<sp/>SPECIAL,<sp/>EXEMPLARY,<sp/>OR<sp/>CONSEQUENTIAL<sp/>DAMAGES<sp/>(INCLUDING,<sp/>BUT<sp/>NOT<sp/>LIMITED<sp/>TO,<sp/>PROCUREMENT<sp/>OF<sp/>SUBSTITUTE<sp/>GOODS<sp/>OR<sp/>SERVICES;<sp/>LOSS<sp/>OF<sp/>USE,<sp/>DATA,<sp/>OR<sp/>PROFITS;</highlight></codeline>
<codeline lineno="12"><highlight class="comment">*<sp/>OR<sp/>BUSINESS<sp/>INTERRUPTION)<sp/>HOWEVER<sp/>CAUSED<sp/>AND<sp/>ON<sp/>ANY<sp/>THEORY<sp/>OF<sp/>LIABILITY,<sp/>WHETHER<sp/>IN<sp/>CONTRACT,<sp/>STRICT<sp/>LIABILITY,<sp/>OR<sp/>TORT<sp/>(INCLUDING<sp/>NEGLIGENCE<sp/>OR<sp/>OTHERWISE)<sp/>ARISING<sp/>IN<sp/>ANY<sp/>WAY<sp/>OUT<sp/>OF<sp/>THE<sp/>USE<sp/>OF<sp/>THIS<sp/>SOFTWARE,<sp/>EVEN<sp/>IF<sp/>ADVISED<sp/>OF<sp/>THE<sp/>POSSIBILITY<sp/>OF<sp/>SUCH<sp/>DAMAGE.</highlight></codeline>
<codeline lineno="13"><highlight class="comment">*</highlight></codeline>
<codeline lineno="14"><highlight class="comment">*****************************************************************************/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="15"><highlight class="normal"></highlight></codeline>
<codeline lineno="16"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;VDF_to_IJK.h&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="17"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;Schema_Comm_Vecteurs.h&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="18"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;Schema_Comm.h&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="19"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;communications.h&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="20"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;Domaine_VF.h&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="21"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;IJK_Field.h&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="22"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;TRUSTTabs.h&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="23"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;Array_tools.h&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="24"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;Domaine.h&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="25"><highlight class="normal"></highlight></codeline>
<codeline lineno="26"><highlight class="normal"></highlight><highlight class="comment">//<sp/>search<sp/>non<sp/>empty<sp/>lists<sp/>in<sp/>src<sp/>and<sp/>fills<sp/>non_empty<sp/>and<sp/>dest<sp/>with<sp/>non<sp/>empty<sp/>lists</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="27"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>pack_lists(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>VECT(<ref refid="classTRUSTArray" kindref="compound">ArrOfInt</ref>)<sp/>&amp;<sp/>src,<sp/><ref refid="classTRUSTArray" kindref="compound">ArrOfInt</ref>&amp;<sp/>non_empty,<sp/><ref refid="classStatic__Int__Lists__32__64" kindref="compound">Static_Int_Lists</ref>&amp;<sp/>dest)</highlight></codeline>
<codeline lineno="28"><highlight class="normal">{</highlight></codeline>
<codeline lineno="29"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>count<sp/>non<sp/>empty<sp/>lists</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="30"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>n<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="31"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>nmax<sp/>=<sp/>src.size();</highlight></codeline>
<codeline lineno="32"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>i<sp/>=<sp/>0;<sp/>i<sp/>&lt;<sp/>nmax;<sp/>i++)</highlight></codeline>
<codeline lineno="33"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(src[i].size_array()<sp/>&gt;<sp/>0)</highlight></codeline>
<codeline lineno="34"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>n++;</highlight></codeline>
<codeline lineno="35"><highlight class="normal"></highlight></codeline>
<codeline lineno="36"><highlight class="normal"><sp/><sp/>VECT(<ref refid="classTRUSTArray" kindref="compound">ArrOfInt</ref>)<sp/>tmp(n);</highlight></codeline>
<codeline lineno="37"><highlight class="normal"><sp/><sp/>non_empty.<ref refid="classTRUSTArray_1ad1bd36a32ef2d67b0a3695b5d97ac0ab" kindref="member">resize_array</ref>(n);</highlight></codeline>
<codeline lineno="38"><highlight class="normal"></highlight></codeline>
<codeline lineno="39"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>copy<sp/>non<sp/>empty<sp/>lists<sp/>into<sp/>tmp</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="40"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>j<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="41"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>i<sp/>=<sp/>0;<sp/>i<sp/>&lt;<sp/>nmax;<sp/>i++)</highlight></codeline>
<codeline lineno="42"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="43"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(src[i].size_array()<sp/>&gt;<sp/>0)</highlight></codeline>
<codeline lineno="44"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="45"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>non_empty[j]<sp/>=<sp/>i;</highlight></codeline>
<codeline lineno="46"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>tmp[j]<sp/>=<sp/>src[i];</highlight></codeline>
<codeline lineno="47"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>j++;</highlight></codeline>
<codeline lineno="48"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="49"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="50"><highlight class="normal"></highlight></codeline>
<codeline lineno="51"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>Built<sp/>dest</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="52"><highlight class="normal"><sp/><sp/>dest.<ref refid="classStatic__Int__Lists__32__64_1a27f6cd0babdbfc6b544d6d1a758a7ae1" kindref="member">set</ref>(tmp);</highlight></codeline>
<codeline lineno="53"><highlight class="normal">}</highlight></codeline>
<codeline lineno="54"><highlight class="normal"></highlight></codeline>
<codeline lineno="55"><highlight class="normal"></highlight><highlight class="comment">//<sp/>Returns<sp/>0<sp/>if<sp/>valeur<sp/>&lt;<sp/>tab[1],</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="56"><highlight class="normal"></highlight><highlight class="comment">//<sp/>returns<sp/>tab.size_array()<sp/>-<sp/>1<sp/>if<sp/>valeur<sp/>&gt;=<sp/>tab[size_array()-1]</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="57"><highlight class="normal"></highlight><highlight class="comment">//<sp/>returns<sp/>n<sp/>if<sp/>valeur<sp/>&gt;=<sp/>tab[n]<sp/>&amp;&amp;<sp/>valeur<sp/>&lt;<sp/>tab[n+1]</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="58"><highlight class="normal"></highlight><highlight class="comment">//</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="59"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>bsearch_double(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="classTRUSTArray" kindref="compound">ArrOfDouble</ref>&amp;<sp/>tab,<sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>valeur)</highlight></codeline>
<codeline lineno="60"><highlight class="normal">{</highlight></codeline>
<codeline lineno="61"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>i<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="62"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>j<sp/>=<sp/>tab.<ref refid="classTRUSTArray_1a48b5aa02624ffdc0bad44ca38ddd1a1c" kindref="member">size_array</ref>()<sp/>-<sp/>1;</highlight></codeline>
<codeline lineno="63"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(valeur<sp/>&gt;=<sp/>tab[j])</highlight></codeline>
<codeline lineno="64"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>j;</highlight></codeline>
<codeline lineno="65"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/>(j<sp/>&gt;<sp/>i<sp/>+<sp/>1)</highlight></codeline>
<codeline lineno="66"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="67"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Le<sp/>tableau<sp/>doit<sp/>etre<sp/>trie</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="68"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>assert(j<sp/>==<sp/>tab.<ref refid="classTRUSTArray_1a48b5aa02624ffdc0bad44ca38ddd1a1c" kindref="member">size_array</ref>()<sp/>||<sp/>tab[i]<sp/>&lt;=<sp/>tab[j]);</highlight></codeline>
<codeline lineno="69"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>milieu<sp/>=<sp/>(i<sp/>+<sp/>j)<sp/>/<sp/>2;</highlight></codeline>
<codeline lineno="70"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>val<sp/>=<sp/>tab[milieu];</highlight></codeline>
<codeline lineno="71"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(val<sp/>&gt;<sp/>valeur)</highlight></codeline>
<codeline lineno="72"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>j<sp/>=<sp/>milieu;</highlight></codeline>
<codeline lineno="73"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="74"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>i<sp/>=<sp/>milieu;</highlight></codeline>
<codeline lineno="75"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="76"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>i;</highlight></codeline>
<codeline lineno="77"><highlight class="normal">}</highlight></codeline>
<codeline lineno="78"><highlight class="normal"></highlight></codeline>
<codeline lineno="79"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="classTRUSTTab" kindref="compound">DoubleTab</ref>&amp;<sp/>get_items_coords(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="classDomaine__VF" kindref="compound">Domaine_VF</ref>&amp;<sp/>domaine_vf,<sp/><ref refid="classDomaine__IJK_1af42f29bc11c3d6e985da2a908f6e8ba3" kindref="member">Domaine_IJK::Localisation</ref><sp/>loc,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal">&amp;<sp/>nb_items)</highlight></codeline>
<codeline lineno="80"><highlight class="normal">{</highlight></codeline>
<codeline lineno="81"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">switch</highlight><highlight class="normal">(loc)</highlight></codeline>
<codeline lineno="82"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="83"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="classDomaine__IJK_1af42f29bc11c3d6e985da2a908f6e8ba3a4a01cd61239708e0c20e9fbedfa52eb6" kindref="member">Domaine_IJK::ELEM</ref>:</highlight></codeline>
<codeline lineno="84"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>nb_items<sp/>=<sp/>domaine_vf.<ref refid="classDomaine__dis__base_1ad6c6511ebab85dea90d4d5320fee7ae2" kindref="member">domaine</ref>().<ref refid="classDomaine__32__64_1a92cccd83fdd182cb909d51ff9938eb1b" kindref="member">nb_elem</ref>();</highlight></codeline>
<codeline lineno="85"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>domaine_vf.<ref refid="classDomaine__VF_1ab7331ae644b09336ef8c3e480c3078f0" kindref="member">xp</ref>();</highlight></codeline>
<codeline lineno="86"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="classDomaine__IJK_1af42f29bc11c3d6e985da2a908f6e8ba3a35600a8d7e22e8475ca29a4c8853e706" kindref="member">Domaine_IJK::NODES</ref>:</highlight></codeline>
<codeline lineno="87"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>nb_items<sp/>=<sp/>domaine_vf.<ref refid="classDomaine__dis__base_1ad6c6511ebab85dea90d4d5320fee7ae2" kindref="member">domaine</ref>().<ref refid="classDomaine__32__64_1ae7be1a7efe0526d124745c0c5238f0a2" kindref="member">nb_som</ref>();</highlight></codeline>
<codeline lineno="88"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>domaine_vf.<ref refid="classDomaine__dis__base_1ad6c6511ebab85dea90d4d5320fee7ae2" kindref="member">domaine</ref>().<ref refid="classDomaine__32__64_1a586e7cadea561e6c4b7553acf994ac6a" kindref="member">les_sommets</ref>();</highlight></codeline>
<codeline lineno="89"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">default</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="90"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>nb_items<sp/>=<sp/>domaine_vf.<ref refid="classDomaine__VF_1a14775734830fc461afe2d5a4c55ddf32" kindref="member">nb_faces</ref>();</highlight></codeline>
<codeline lineno="91"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>domaine_vf.<ref refid="classDomaine__VF_1a5b43475ca3328249d3ae62642db3feda" kindref="member">xv</ref>();</highlight></codeline>
<codeline lineno="92"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="93"><highlight class="normal">}</highlight></codeline>
<codeline lineno="94"><highlight class="normal"></highlight></codeline>
<codeline lineno="95" refid="classVDF__to__IJK_1a8a0b6ce3c28fe1b9c78a877b033a5b2b" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="classVDF__to__IJK_1a8a0b6ce3c28fe1b9c78a877b033a5b2b" kindref="member">VDF_to_IJK::initialize</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="classDomaine__VF" kindref="compound">Domaine_VF</ref>&amp;<sp/>domaine_vf,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="classDomaine__IJK" kindref="compound">Domaine_IJK</ref>&amp;<sp/>splitting,</highlight></codeline>
<codeline lineno="96"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classDomaine__IJK_1af42f29bc11c3d6e985da2a908f6e8ba3" kindref="member">Domaine_IJK::Localisation</ref><sp/>localisation,</highlight></codeline>
<codeline lineno="97"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>direction_for_x,</highlight></codeline>
<codeline lineno="98"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>direction_for_y,</highlight></codeline>
<codeline lineno="99"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>direction_for_z)</highlight></codeline>
<codeline lineno="100"><highlight class="normal">{</highlight></codeline>
<codeline lineno="101"><highlight class="normal"><sp/><sp/>Cerr<sp/>&lt;&lt;<sp/></highlight><highlight class="stringliteral">&quot;VDF_to_IJK::initialize<sp/>localisation=&quot;</highlight><highlight class="normal"><sp/>&lt;&lt;<sp/>(int)localisation<sp/>&lt;&lt;<sp/>endl;</highlight></codeline>
<codeline lineno="102"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>np<sp/>=<sp/><ref refid="classProcess_1a6bf692ce58d9578aa62ac3c07b8caaa1" kindref="member">Process::nproc</ref>();</highlight></codeline>
<codeline lineno="103"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>moi<sp/>=<sp/><ref refid="classProcess_1ab55ba07167ec807ed3a145cac0f5dca4" kindref="member">Process::me</ref>();</highlight></codeline>
<codeline lineno="104"><highlight class="normal"></highlight></codeline>
<codeline lineno="105"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="classTRUSTArray" kindref="compound">ArrOfDouble</ref>&amp;<sp/>all_coord_i<sp/>=<sp/>splitting.<ref refid="classDomaine__IJK_1a6f5ad308612af7de42f8e4d79dd0c644" kindref="member">get_node_coordinates</ref>(0);</highlight></codeline>
<codeline lineno="106"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="classTRUSTArray" kindref="compound">ArrOfDouble</ref>&amp;<sp/>all_coord_j<sp/>=<sp/>splitting.<ref refid="classDomaine__IJK_1a6f5ad308612af7de42f8e4d79dd0c644" kindref="member">get_node_coordinates</ref>(1);</highlight></codeline>
<codeline lineno="107"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="classTRUSTArray" kindref="compound">ArrOfDouble</ref>&amp;<sp/>all_coord_k<sp/>=<sp/>splitting.<ref refid="classDomaine__IJK_1a6f5ad308612af7de42f8e4d79dd0c644" kindref="member">get_node_coordinates</ref>(2);</highlight></codeline>
<codeline lineno="108"><highlight class="normal"></highlight></codeline>
<codeline lineno="109"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>For<sp/>each<sp/>direction,<sp/>global<sp/>position<sp/>of<sp/>the<sp/>first<sp/>element<sp/>of<sp/>each<sp/>slice</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="110"><highlight class="normal"><sp/><sp/>VECT(<ref refid="classTRUSTArray" kindref="compound">ArrOfInt</ref>)<sp/>slice_offsets(3);</highlight></codeline>
<codeline lineno="111"><highlight class="normal"><sp/><sp/>VECT(<ref refid="classTRUSTArray" kindref="compound">ArrOfInt</ref>)<sp/>slice_size(3);</highlight></codeline>
<codeline lineno="112"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>For<sp/>each<sp/>subdomain,<sp/>on<sp/>which<sp/>mpi<sp/>process<sp/>is<sp/>it<sp/>?</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="113"><highlight class="normal"><sp/><sp/><ref refid="classTRUSTTab" kindref="compound">IntTab</ref><sp/>mapping;</highlight></codeline>
<codeline lineno="114"><highlight class="normal"><sp/><sp/>splitting.<ref refid="classDomaine__IJK_1a876aa7c03968a0a5d656114907df4169" kindref="member">get_processor_mapping</ref>(mapping);</highlight></codeline>
<codeline lineno="115"><highlight class="normal"></highlight></codeline>
<codeline lineno="116"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>i<sp/>=<sp/>0;<sp/>i<sp/>&lt;<sp/>3;<sp/>i++)</highlight></codeline>
<codeline lineno="117"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="118"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>splitting.<ref refid="classDomaine__IJK_1ab0b00df4f680cfb84198069b342dbe60" kindref="member">get_slice_offsets</ref>(i,<sp/>slice_offsets[i]);</highlight></codeline>
<codeline lineno="119"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>splitting.<ref refid="classDomaine__IJK_1ac2827655cdf92b93107b4d9c8f9c1a54" kindref="member">get_slice_size</ref>(i,<sp/>localisation,<sp/>slice_size[i]);</highlight></codeline>
<codeline lineno="120"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="121"><highlight class="normal"><sp/><sp/><ref refid="classSchema__Comm" kindref="compound">Schema_Comm</ref><sp/>sch;</highlight></codeline>
<codeline lineno="122"><highlight class="normal"><sp/><sp/><ref refid="classTRUSTArray" kindref="compound">ArrOfInt</ref><sp/>all_pe;</highlight></codeline>
<codeline lineno="123"><highlight class="normal"></highlight></codeline>
<codeline lineno="124"><highlight class="normal"></highlight></codeline>
<codeline lineno="125"><highlight class="normal"><sp/><sp/>{</highlight></codeline>
<codeline lineno="126"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Ajout<sp/>pour<sp/>limiter<sp/>la<sp/>porte<sp/>de<sp/>la<sp/>variable<sp/>!!!</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="127"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>pe;</highlight></codeline>
<codeline lineno="128"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(pe<sp/>=<sp/>0;<sp/>pe<sp/>&lt;<sp/>np;<sp/>pe++)</highlight></codeline>
<codeline lineno="129"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pe<sp/>!=<sp/>moi)</highlight></codeline>
<codeline lineno="130"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>all_pe.<ref refid="classTRUSTArray_1a3bbfcd5ab081affbdc18217c813fcba7" kindref="member">append_array</ref>(pe);</highlight></codeline>
<codeline lineno="131"><highlight class="normal"><sp/><sp/><sp/><sp/>sch.<ref refid="classSchema__Comm_1ad11c9b47999c294c26ae4df8d2bbd57b" kindref="member">set_send_recv_pe_list</ref>(all_pe,<sp/>all_pe,<sp/>1<sp/></highlight><highlight class="comment">/*<sp/>me<sp/>to<sp/>me<sp/>*/</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="132"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="133"><highlight class="normal"></highlight></codeline>
<codeline lineno="134"><highlight class="normal"><sp/><sp/>VECT(<ref refid="classTRUSTTab" kindref="compound">IntTab</ref>)<sp/>all_data(np);</highlight></codeline>
<codeline lineno="135"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>pe<sp/>=<sp/>0;<sp/>pe<sp/>&lt;<sp/>np;<sp/>pe++)</highlight></codeline>
<codeline lineno="136"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="137"><highlight class="normal"></highlight></codeline>
<codeline lineno="138"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>all_data[pe].resize(0,2);</highlight></codeline>
<codeline lineno="139"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="140"><highlight class="normal"></highlight></codeline>
<codeline lineno="141"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>srccomponent_for_direction[3];</highlight></codeline>
<codeline lineno="142"><highlight class="normal"><sp/><sp/>srccomponent_for_direction[direction_for_x]<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="143"><highlight class="normal"><sp/><sp/>srccomponent_for_direction[direction_for_y]<sp/>=<sp/>1;</highlight></codeline>
<codeline lineno="144"><highlight class="normal"><sp/><sp/>srccomponent_for_direction[direction_for_z]<sp/>=<sp/>2;</highlight></codeline>
<codeline lineno="145"><highlight class="normal"></highlight></codeline>
<codeline lineno="146"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>Coordinates<sp/>of<sp/>geometric<sp/>items:</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="147"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>nb_items;</highlight></codeline>
<codeline lineno="148"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>attention,<sp/>coords.dimension(0)<sp/>inclut<sp/>les<sp/>mailles<sp/>virtuelles<sp/>pour<sp/>le<sp/>tableau<sp/>des<sp/>elements,<sp/>c&apos;est<sp/>pas<sp/>bon,</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="149"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>il<sp/>faut<sp/>recuperer<sp/>nb_elem<sp/>reels...</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="150"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="classTRUSTTab" kindref="compound">DoubleTab</ref>&amp;<sp/>coords<sp/>=<sp/>get_items_coords(domaine_vf,<sp/>localisation,<sp/>nb_items);</highlight></codeline>
<codeline lineno="151"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="classTRUSTVect" kindref="compound">IntVect</ref>&amp;<sp/>orientation<sp/>=<sp/>domaine_vf.<ref refid="classDomaine__VF_1aa5acf9a69d74db118172c0b9cfafe5ae" kindref="member">orientation</ref>();</highlight></codeline>
<codeline lineno="152"><highlight class="normal"></highlight></codeline>
<codeline lineno="153"><highlight class="normal"><sp/><sp/>sch.<ref refid="classSchema__Comm_1ac574385d716aca94a48373ab71f37e4f" kindref="member">begin_comm</ref>();</highlight></codeline>
<codeline lineno="154"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>eps<sp/>=<sp/><ref refid="classObjet__U_1a7447e25c68cc8d3a1c06cf99f0565cff" kindref="member">Objet_U::precision_geom</ref>;</highlight></codeline>
<codeline lineno="155"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>item_index<sp/>=<sp/>0;<sp/>item_index<sp/>&lt;<sp/>nb_items;<sp/>item_index++)</highlight></codeline>
<codeline lineno="156"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="157"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(localisation<sp/>==<sp/><ref refid="classDomaine__IJK_1af42f29bc11c3d6e985da2a908f6e8ba3a2824d1e193c056b3750a3781714c9bd4" kindref="member">Domaine_IJK::FACES_I</ref><sp/>&amp;&amp;<sp/>orientation[item_index]<sp/>!=<sp/>srccomponent_for_direction[0])</highlight></codeline>
<codeline lineno="158"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">continue</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="159"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(localisation<sp/>==<sp/><ref refid="classDomaine__IJK_1af42f29bc11c3d6e985da2a908f6e8ba3a15b0074a7289b4f572e2bb171a7f0bbe" kindref="member">Domaine_IJK::FACES_J</ref><sp/>&amp;&amp;<sp/>orientation[item_index]<sp/>!=<sp/><sp/>srccomponent_for_direction[1])</highlight></codeline>
<codeline lineno="160"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">continue</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="161"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(localisation<sp/>==<sp/><ref refid="classDomaine__IJK_1af42f29bc11c3d6e985da2a908f6e8ba3a1ca30ec67a63064fafda2bd181ad5615" kindref="member">Domaine_IJK::FACES_K</ref><sp/>&amp;&amp;<sp/>orientation[item_index]<sp/>!=<sp/>srccomponent_for_direction[2])</highlight></codeline>
<codeline lineno="162"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">continue</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="163"><highlight class="normal"></highlight></codeline>
<codeline lineno="164"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>coord[3];</highlight></codeline>
<codeline lineno="165"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>coord[direction_for_x]<sp/>=<sp/>coords(item_index,<sp/>0)<sp/>+<sp/>eps;</highlight></codeline>
<codeline lineno="166"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>coord[direction_for_y]<sp/>=<sp/>coords(item_index,<sp/>1)<sp/>+<sp/>eps;</highlight></codeline>
<codeline lineno="167"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>coord[direction_for_z]<sp/>=<sp/>coords(item_index,<sp/>2)<sp/>+<sp/>eps;</highlight></codeline>
<codeline lineno="168"><highlight class="normal"></highlight></codeline>
<codeline lineno="169"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>ijk[3];</highlight></codeline>
<codeline lineno="170"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>ijk[0]<sp/>=<sp/>bsearch_double(all_coord_i,<sp/>coord[0]);</highlight></codeline>
<codeline lineno="171"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>ijk[1]<sp/>=<sp/>bsearch_double(all_coord_j,<sp/>coord[1]);</highlight></codeline>
<codeline lineno="172"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>ijk[2]<sp/>=<sp/>bsearch_double(all_coord_k,<sp/>coord[2]);</highlight></codeline>
<codeline lineno="173"><highlight class="normal"></highlight></codeline>
<codeline lineno="174"><highlight class="normal"></highlight></codeline>
<codeline lineno="175"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>slice_index[3];<sp/></highlight><highlight class="comment">//<sp/>index<sp/>of<sp/>the<sp/>subdomain<sp/>than<sp/>contains<sp/>the<sp/>current<sp/>element,<sp/>in<sp/>each<sp/>direction</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="176"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>local_ijk_size[3];<sp/><sp/></highlight><highlight class="comment">//<sp/>size<sp/>of<sp/>the<sp/>ijk<sp/>subdomain<sp/>that<sp/>contains<sp/>the<sp/>current<sp/>element</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="177"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>local_ijk_index[3];<sp/></highlight><highlight class="comment">//<sp/>ijk<sp/>index<sp/>of<sp/>the<sp/>element<sp/>in<sp/>the<sp/>subdomain</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="178"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>i<sp/>=<sp/>0;<sp/>i<sp/>&lt;<sp/>3;<sp/>i++)</highlight></codeline>
<codeline lineno="179"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="180"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Wrap<sp/>for<sp/>periodic<sp/>items:</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="181"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(ijk[i]<sp/>&gt;=<sp/>splitting.<ref refid="classDomaine__IJK_1ab4b922b8cf6bae26173fa4ea35c5a2ea" kindref="member">get_nb_items_global</ref>(localisation,<sp/>i))</highlight></codeline>
<codeline lineno="182"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ijk[i]<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="183"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>idx<sp/>=<sp/>slice_offsets[i].size_array()-1;</highlight></codeline>
<codeline lineno="184"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/>(slice_offsets[i][idx]<sp/>&gt;<sp/>ijk[i])</highlight></codeline>
<codeline lineno="185"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>idx--;</highlight></codeline>
<codeline lineno="186"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>slice_index[i]<sp/>=<sp/>idx;</highlight></codeline>
<codeline lineno="187"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>local_ijk_size[i]<sp/>=<sp/>slice_size[i][idx];</highlight></codeline>
<codeline lineno="188"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>local_ijk_index[i]<sp/>=<sp/>ijk[i]<sp/>-<sp/>slice_offsets[i][idx];</highlight></codeline>
<codeline lineno="189"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="190"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>which<sp/>pe<sp/>has<sp/>this<sp/>element<sp/>in<sp/>the<sp/>ijk<sp/>mesh?</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="191"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>pe<sp/>=<sp/>mapping(slice_index[0],<sp/>slice_index[1],<sp/>slice_index[2]);</highlight></codeline>
<codeline lineno="192"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>local<sp/>index<sp/>of<sp/>this<sp/>element<sp/>in<sp/>the<sp/>ijk<sp/>mesh<sp/>(linear<sp/>index<sp/>computed<sp/>without<sp/>ghost<sp/>cells)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="193"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>local_index<sp/>=<sp/>(local_ijk_index[2]<sp/>*<sp/>local_ijk_size[1]<sp/>+<sp/>local_ijk_index[1])<sp/>*<sp/>local_ijk_size[0]<sp/>+<sp/>local_ijk_index[0];</highlight></codeline>
<codeline lineno="194"><highlight class="normal"></highlight></codeline>
<codeline lineno="195"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>all_data[pe].append_line(local_index,<sp/>item_index);</highlight></codeline>
<codeline lineno="196"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="197"><highlight class="normal"></highlight></codeline>
<codeline lineno="198"><highlight class="normal"><sp/><sp/>VECT(<ref refid="classTRUSTArray" kindref="compound">ArrOfInt</ref>)<sp/>to_send(np);</highlight></codeline>
<codeline lineno="199"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>pe<sp/>=<sp/>0;<sp/>pe<sp/>&lt;<sp/>np;<sp/>pe++)</highlight></codeline>
<codeline lineno="200"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="201"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>tri_lexicographique_tableau(all_data[pe]);</highlight></codeline>
<codeline lineno="202"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>n<sp/>=<sp/>all_data[pe].dimension(0);</highlight></codeline>
<codeline lineno="203"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(n<sp/>&gt;<sp/>0)</highlight></codeline>
<codeline lineno="204"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Cerr<sp/>&lt;&lt;<sp/></highlight><highlight class="stringliteral">&quot;VDF_to_IJK::initialize<sp/>localisation=&quot;</highlight><highlight class="normal"><sp/>&lt;&lt;<sp/>(int)localisation</highlight></codeline>
<codeline lineno="205"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&lt;&lt;<sp/></highlight><highlight class="stringliteral">&quot;<sp/>found<sp/>&quot;</highlight><highlight class="normal"><sp/>&lt;&lt;<sp/>n<sp/>&lt;&lt;<sp/></highlight><highlight class="stringliteral">&quot;<sp/>items<sp/>to<sp/>send<sp/>to<sp/>processor<sp/>&quot;</highlight><highlight class="normal"><sp/>&lt;&lt;<sp/>pe<sp/>&lt;&lt;<sp/>finl;</highlight></codeline>
<codeline lineno="206"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classSortie" kindref="compound">Sortie</ref>&amp;<sp/>buf<sp/>=<sp/>sch.<ref refid="classSchema__Comm_1a681259723c5c1b85f419433de7aa78d7" kindref="member">send_buffer</ref>(pe);</highlight></codeline>
<codeline lineno="207"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>i<sp/>=<sp/>0;<sp/>i<sp/>&lt;<sp/>n;<sp/>i++)</highlight></codeline>
<codeline lineno="208"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="209"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>buf<sp/>&lt;&lt;<sp/>all_data[pe](i,0);</highlight></codeline>
<codeline lineno="210"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>to_send[pe].append_array(all_data[pe](i,1));</highlight></codeline>
<codeline lineno="211"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="212"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="213"><highlight class="normal"><sp/><sp/>sch.<ref refid="classSchema__Comm_1a516f48fb0494781b373d7b343388ed44" kindref="member">echange_taille_et_messages</ref>();</highlight></codeline>
<codeline lineno="214"><highlight class="normal"><sp/><sp/>VECT(<ref refid="classTRUSTArray" kindref="compound">ArrOfInt</ref>)<sp/>to_recv(np);</highlight></codeline>
<codeline lineno="215"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>pe<sp/>=<sp/>0;<sp/>pe<sp/>&lt;<sp/>np;<sp/>pe++)</highlight></codeline>
<codeline lineno="216"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="217"><highlight class="normal"></highlight></codeline>
<codeline lineno="218"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="219"><highlight class="normal"></highlight></codeline>
<codeline lineno="220"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>pe<sp/>=<sp/>0;<sp/>pe<sp/>&lt;<sp/>np;<sp/>pe++)</highlight></codeline>
<codeline lineno="221"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="222"><highlight class="normal"></highlight></codeline>
<codeline lineno="223"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classEntree" kindref="compound">Entree</ref>&amp;<sp/>buf<sp/>=<sp/>sch.<ref refid="classSchema__Comm_1a85c05ef4688c20afa429264ebac8fdcf" kindref="member">recv_buffer</ref>(pe);</highlight></codeline>
<codeline lineno="224"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(;;)</highlight></codeline>
<codeline lineno="225"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="226"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>val;</highlight></codeline>
<codeline lineno="227"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>buf<sp/>&gt;&gt;<sp/>val;</highlight></codeline>
<codeline lineno="228"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(buf.<ref refid="classEntree_1abcd397cb0b99fbe7c6f01047d8cec89c" kindref="member">eof</ref>())</highlight></codeline>
<codeline lineno="229"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="230"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>to_recv[pe].append_array(val);</highlight></codeline>
<codeline lineno="231"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="232"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(to_recv[pe].size_array()<sp/>&gt;<sp/>0)</highlight></codeline>
<codeline lineno="233"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Cerr<sp/>&lt;&lt;<sp/></highlight><highlight class="stringliteral">&quot;VDF_to_IJK::initialize<sp/>localisation=&quot;</highlight><highlight class="normal"><sp/>&lt;&lt;<sp/>(int)localisation</highlight></codeline>
<codeline lineno="234"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&lt;&lt;<sp/></highlight><highlight class="stringliteral">&quot;<sp/>found<sp/>&quot;</highlight><highlight class="normal"><sp/>&lt;&lt;<sp/>to_recv[pe].size_array()<sp/>&lt;&lt;<sp/></highlight><highlight class="stringliteral">&quot;<sp/>items<sp/>to<sp/>receive<sp/>from<sp/>processor<sp/>&quot;</highlight><highlight class="normal"><sp/>&lt;&lt;<sp/>pe<sp/>&lt;&lt;<sp/>finl;</highlight></codeline>
<codeline lineno="235"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="236"><highlight class="normal"><sp/><sp/>sch.<ref refid="classSchema__Comm_1a7dd8d56caee9c6759850bb7c38e31c8b" kindref="member">end_comm</ref>();</highlight></codeline>
<codeline lineno="237"><highlight class="normal"><sp/><sp/>pack_lists(to_send,<sp/><ref refid="classVDF__to__IJK_1a1c1d0cc9687374aa797e917d5d4a74b9" kindref="member">pe_send_</ref>,<sp/><ref refid="classVDF__to__IJK_1aa3dfd11453a0481a378f320f5fc34acc" kindref="member">pe_send_data_</ref>);</highlight></codeline>
<codeline lineno="238"><highlight class="normal"><sp/><sp/>pack_lists(to_recv,<sp/><ref refid="classVDF__to__IJK_1a385fa3cf9af8e24b8c40bf48e0e23575" kindref="member">pe_recv_</ref>,<sp/><ref refid="classVDF__to__IJK_1a874df8a481d93271ddb35570ad495c4d" kindref="member">pe_recv_data_</ref>);</highlight></codeline>
<codeline lineno="239"><highlight class="normal"></highlight></codeline>
<codeline lineno="240"><highlight class="normal"><sp/><sp/><ref refid="classVDF__to__IJK_1acbc4235721b12dd48da45969799ef07c" kindref="member">ijk_ni_</ref><sp/>=<sp/>splitting.<ref refid="classDomaine__IJK_1a3b3309eb3bdba88405be08f4ab51c3b8" kindref="member">get_nb_elem_local</ref>(0);</highlight></codeline>
<codeline lineno="241"><highlight class="normal"><sp/><sp/><ref refid="classVDF__to__IJK_1ade8790d9fd13b0a18de9cf814cefeaa5" kindref="member">ijk_nj_</ref><sp/>=<sp/>splitting.<ref refid="classDomaine__IJK_1a3b3309eb3bdba88405be08f4ab51c3b8" kindref="member">get_nb_elem_local</ref>(1);</highlight></codeline>
<codeline lineno="242"><highlight class="normal">}</highlight></codeline>
    </programlisting>
    <location file="/volatile/catA/gj277443/TRUST/sync-doc/src/IJK/Tools/VDF_to_IJK.cpp"/>
  </compounddef>
</doxygen>
