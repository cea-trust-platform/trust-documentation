<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

  <meta name="viewport" content="width=device-width,initial-scale=1">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <meta name="lang:clipboard.copy" content="Copy to clipboard">
  <meta name="lang:clipboard.copied" content="Copied to clipboard">
  <meta name="lang:search.language" content="en">
  <meta name="lang:search.pipeline.stopwords" content="True">
  <meta name="lang:search.pipeline.trimmer" content="True">
  <meta name="lang:search.result.none" content="No matching documents">
  <meta name="lang:search.result.one" content="1 matching document">
  <meta name="lang:search.result.other" content="# matching documents">
  <meta name="lang:search.tokenizer" content="[\s\-]+">

  
    <link href="https://fonts.gstatic.com/" rel="preconnect" crossorigin>
    <link href="https://fonts.googleapis.com/css?family=Roboto+Mono:400,500,700|Roboto:300,400,400i,700&display=fallback" rel="stylesheet">

    <style>
      body,
      input {
        font-family: "Roboto", "Helvetica Neue", Helvetica, Arial, sans-serif
      }

      code,
      kbd,
      pre {
        font-family: "Roboto Mono", "Courier New", Courier, monospace
      }
    </style>
  

  <link rel="stylesheet" href="../_static/stylesheets/application.css"/>
  <link rel="stylesheet" href="../_static/stylesheets/application-palette.css"/>
  <link rel="stylesheet" href="../_static/stylesheets/application-fixes.css"/>
  
  <link rel="stylesheet" href="../_static/fonts/material-icons.css"/>
  
  <meta name="theme-color" content="#3f51b5">
  <script src="../_static/javascripts/modernizr.js"></script>
  
  
  
    <title>Introduction &#8212; TRUST Generic Guide  documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/material.css" />
    <link rel="stylesheet" type="text/css" href="../_static/graphviz.css" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/sphinx_highlight.js"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Data setting" href="data.html" />
    <link rel="prev" title="TRUST Generic Guide" href="../index.html" />
  
   

  </head>
  <body dir=ltr
        data-md-color-primary=blue-grey data-md-color-accent=blue>
  
  <svg class="md-svg">
    <defs data-children-count="0">
      
      <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448" viewBox="0 0 416 448" id="__github"><path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z"/></svg>
      
    </defs>
  </svg>
  
  <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer">
  <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search">
  <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
  <a href="#srcs/intro" tabindex="1" class="md-skip"> Skip to content </a>
  <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex navheader">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="../index.html" title="TRUST Generic Guide  documentation"
           class="md-header-nav__button md-logo">
          
            &nbsp;
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          <span class="md-header-nav__topic">TRUST Generic Guide  documentation</span>
          <span class="md-header-nav__topic"> Introduction </span>
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
        
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" action="../search.html" method="get" name="search">
      <input type="text" class="md-search__input" name="q" placeholder="Search"
             autocapitalize="off" autocomplete="off" spellcheck="false"
             data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>

      </div>
      
      
  
  <script src="../_static/javascripts/version_dropdown.js"></script>
  <script>
    var json_loc = "../"versions.json"",
        target_loc = "../../",
        text = "Versions";
    $( document ).ready( add_version_dropdown(json_loc, target_loc, text));
  </script>
  

    </div>
  </nav>
</header>

  
  <div class="md-container">
    
    
    
  <nav class="md-tabs" data-md-component="tabs">
    <div class="md-tabs__inner md-grid">
      <ul class="md-tabs__list">
          <li class="md-tabs__item"><a href="../index.html" class="md-tabs__link">TRUST Generic Guide  documentation</a></li>
      </ul>
    </div>
  </nav>
    <main class="md-main">
      <div class="md-main__inner md-grid" data-md-component="container">
        
          <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
            <div class="md-sidebar__scrollwrap">
              <div class="md-sidebar__inner">
                <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="../index.html" title="TRUST Generic Guide documentation" class="md-nav__button md-logo">
      
        <img src="../_static/" alt=" logo" width="48" height="48">
      
    </a>
    <a href="../index.html"
       title="TRUST Generic Guide documentation">TRUST Generic Guide  documentation</a>
  </label>
  

</nav>
              </div>
            </div>
          </div>
          <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
            <div class="md-sidebar__scrollwrap">
              <div class="md-sidebar__inner">
                
<nav class="md-nav md-nav--secondary">
    <label class="md-nav__title" for="__toc">Contents</label>
  <ul class="md-nav__list" data-md-scrollfix="">
        <li class="md-nav__item"><a href="#srcs-intro--page-root" class="md-nav__link">Introduction</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#before-trust-a-modular-software-named-trio-u" class="md-nav__link">Before TRUST: a Modular Software Named Trio_U</a>
        </li>
        <li class="md-nav__item"><a href="#short-history" class="md-nav__link">Short History</a>
        </li>
        <li class="md-nav__item"><a href="#data-file" class="md-nav__link">Data File</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#data-file-example-base-blocks" class="md-nav__link">Data File Example: Base Blocks</a>
        </li>
        <li class="md-nav__item"><a href="#basic-rules" class="md-nav__link">Basic Rules</a>
        </li>
        <li class="md-nav__item"><a href="#objects-notion" class="md-nav__link">Objects Notion</a>
        </li>
        <li class="md-nav__item"><a href="#interpretor-notion" class="md-nav__link">Interpretor Notion</a>
        </li>
        <li class="md-nav__item"><a href="#example" class="md-nav__link">Example</a>
        </li>
        <li class="md-nav__item"><a href="#important-remarks" class="md-nav__link">Important Remarks</a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#running-a-data-file" class="md-nav__link">Running a Data File</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#sequential-calculation" class="md-nav__link">Sequential Calculation</a>
        </li>
        <li class="md-nav__item"><a href="#parallel-calculation" class="md-nav__link">Parallel Calculation</a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#interactive-evolution" class="md-nav__link">Interactive Evolution</a>
        </li></ul>
            </nav>
        </li>
    
<li class="md-nav__item"><a class="md-nav__extra_link" href="../_sources/srcs/intro.rst.txt">Show Source</a> </li>

<li id="searchbox" class="md-nav__item"></li>

  </ul>
</nav>
              </div>
            </div>
          </div>
        
        <div class="md-content">
          <article class="md-content__inner md-typeset" role="main">
            
  <section id="introduction">
<h1 id="srcs-intro--page-root">Introduction<a class="headerlink" href="#srcs-intro--page-root" title="Permalink to this heading">¶</a></h1>
<p><strong>TRUST</strong> is a High Performance Computing (HPC) thermal-hydraulic engine for Computational Fluid Dynamics (CFD) developed at the Departement of System and Structure Modelisation (DM2S) of the French Atomic Energy Commission (CEA).</p>
<p>The acronym <strong>TRUST</strong> stands for <strong>TR</strong>io_<strong>U</strong> <strong>S</strong>oftware for <strong>T</strong>hermohydraulics. This software was originally designed for conduction, incompressible single-phase, and Low Mach Number (LMN) flows with a robust Weakly-Compressible (WC) multi-species solver. However, a huge effort has been conducted recently, and now TRUST is able to simulate real compressible multi-phase flows.</p>
<p>TRUST is also being progressively ported to support GPU acceleration (NVidia/AMD).</p>
<p>The software is OpenSource with a <a class="reference external" href="https://github.com/cea-trust-platform/trust-code/blob/master/License.txt">BSD license</a>, available on GitHub via <a class="reference external" href="https://github.com/cea-trust-platform/trust-code">this link</a>.</p>
<p>You can easily create new project based on <strong>TRUST</strong> plateform. Theses projects are named <strong>BALTIK</strong> projects (<strong>B</strong>uild an <strong>A</strong>pplication <strong>L</strong>inked to <strong>T</strong>r<strong>I</strong>o_U <strong>K</strong>ernel).</p>
<section id="before-trust-a-modular-software-named-trio-u">
<h2 id="before-trust-a-modular-software-named-trio-u">Before TRUST: a Modular Software Named Trio_U<a class="headerlink" href="#before-trust-a-modular-software-named-trio-u" title="Permalink to this heading">¶</a></h2>
<p><strong>TRUST</strong> was born from the cutting in two pieces of <strong>Trio_U</strong> software. <strong>Trio_U</strong> was a software brick based on the <strong>Kernel</strong> brick (which contains the equations, space discretizations, numerical schemes, parallelism…) and used by other CEA applications (see Figure 1).</p>
<figure class="small-caption align-center" id="id1">
<a class="reference internal image-reference" href="../_images/tikz1.png"><img alt="image description" src="../_images/tikz1.png" style="width: 600px;"/></a>
<figcaption>
<p><span class="caption-text">Figure 1: Trio_U brick software</span><a class="headerlink" href="#id1" title="Permalink to this image">¶</a></p>
</figcaption>
</figure>
<style>
.small-caption {
  display: table;
  caption-side: bottom;
  font-size: smaller;
  margin-top: 5px;
  text-align: center; /* Add this line */
}
</style><p>In 2015, <strong>Trio_U</strong> was divided in two parts: <strong>TRUST</strong> and <strong>TrioCFD</strong>.</p>
<ul class="simple">
<li><p><strong>TRUST</strong> is a new platform, its name means: <strong>TR</strong>io_<strong>U</strong> <strong>S</strong>oftware for <strong>T</strong>hermohydraulics.</p></li>
<li><p><strong>TrioCFD</strong> is an open source BALTIK project based on <strong>TRUST</strong>.</p></li>
</ul>
<p>Here are some other selected BALTIKS based on the TRUST platform (see Figure 2).</p>
<figure class="small-caption align-center" id="id2">
<a class="reference internal image-reference" href="../_images/tikz2.png"><img alt="image description" src="../_images/tikz2.png" style="width: 700px;"/></a>
<figcaption>
<p><span class="caption-text">Figure 2: Selected BALTIKS based on the TRUST platform.</span><a class="headerlink" href="#id2" title="Permalink to this image">¶</a></p>
</figcaption>
</figure>
</section>
<section id="short-history">
<h2 id="short-history">Short History<a class="headerlink" href="#short-history" title="Permalink to this heading">¶</a></h2>
<p><strong>TRUST</strong> is developed at the Laboratory of High Performance Computing and Numerical Analysis (LCAN) of the Software Engineering and Simulation Service (SGLS) in the Department of System and Structure Modeling (DM2S).</p>
<p>The project starts in 1994 and improved versions were built ever since:</p>
<ul class="simple">
<li><p><strong>1994 :</strong> Start of the project Trio_U</p></li>
<li><p><strong>1997 :</strong> v1.0 - Finite Difference Volume (VDF) method only</p></li>
<li><p><strong>1998 :</strong> v1.1 - Finite Element Volume (VEF) method only</p></li>
<li><p><strong>2000 :</strong> v1.2 - Parallel MPI version</p></li>
<li><p><strong>2001 :</strong> v1.3 - Radiation model (TrioCFD now)</p></li>
<li><p><strong>2002 :</strong> v1.4 - LES turbulence models (TrioCFD now)</p></li>
<li><p><strong>2006 :</strong> v1.5 - VDF/VEF Front Tracking method (TrioCFD now)</p></li>
<li><p><strong>2009 :</strong> v1.6 - Data structure revamped</p></li>
<li><p><strong>2015 :</strong> v1.7 - Separation TRUST &amp; TrioCFD + switch to open source</p></li>
<li><p><strong>2019 :</strong> v1.8 - New polyheadral discretization (PolyMAC)</p></li>
<li><p><strong>2021 :</strong> v1.8.4 - Multiphase problem + Weakly Compressible model</p></li>
<li><p><strong>2022 … :</strong> Modern C++ code (templates, CRTP, …), support GPU (NVidia/AMD), remove MACROS, …</p></li>
</ul>
</section>
<section id="data-file">
<h2 id="data-file">Data File<a class="headerlink" href="#data-file" title="Permalink to this heading">¶</a></h2>
<p>To launch a calculation with <strong>TRUST</strong>, you need to write a “data file” which is an input file for <strong>TRUST</strong> and will contain all the information about your simulation. Data files are written following some rules as shown below. But their language is not a programming language, users can’t make loops or switch…</p>
<p><strong>Note</strong> that:</p>
<ul>
<li><p>lines between <code class="docutils literal notranslate"><span class="pre">#</span> <span class="pre">...</span> <span class="pre">#</span></code> and <code class="docutils literal notranslate"><span class="pre">/*</span> <span class="pre">...</span> <span class="pre">*/</span></code> are comments,</p></li>
<li><p>in that document, words in <strong>bold</strong> are <strong>TRUST</strong> keywords, you can highlight them in your file editor with the command line:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>trust<span class="w"> </span>-config<span class="w"> </span>gedit<span class="p">|</span>vim<span class="p">|</span>emacs
</pre></div>
</div>
</li>
<li><p>braces <code class="docutils literal notranslate"><span class="pre">{</span> <span class="pre">}</span></code> are elements that <strong>TRUST</strong> reads and interprets, so don’t forget them and <em>put space</em> <em>before and after them</em>,</p></li>
<li><p>elements between bracket <code class="docutils literal notranslate"><span class="pre">[</span> <span class="pre">]</span></code> are optional.</p></li>
</ul>
<section id="data-file-example-base-blocks">
<span id="dataset"></span><h3 id="data-file-example-base-blocks">Data File Example: Base Blocks<a class="headerlink" href="#data-file-example-base-blocks" title="Permalink to this heading">¶</a></h3>
<p>Here is the template of a basic sequential data file:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># Dimension 2D or 3D #</span>
Dimension<span class="w"> </span><span class="m">2</span>
</pre></div>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># Problem definition #</span>
Pb_hydraulique<span class="w"> </span>my_problem
</pre></div>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># Domain definition #</span>
Domaine<span class="w"> </span>my_domain
</pre></div>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># Mesh #</span>
<span class="c1"># BEGIN MESH #</span>
Read_file<span class="w"> </span>my_mesh.geo<span class="w"> </span><span class="p">;</span>
<span class="c1"># END MESH #</span>
</pre></div>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># For parallel calculation only! #</span>
<span class="c1"># For the first run: partitioning step #</span>
<span class="c1"># Partition my_domain</span>
<span class="o">{</span>
<span class="w">   </span>Partition_tool<span class="w"> </span>partitioner_name<span class="w"> </span><span class="o">{</span><span class="w"> </span>option1<span class="w"> </span>option2<span class="w"> </span>...<span class="w"> </span><span class="o">}</span>
<span class="w">   </span>Larg_joint<span class="w"> </span><span class="m">2</span>
<span class="w">   </span>zones_name<span class="w"> </span>DOM
<span class="w">   </span>...
<span class="o">}</span>
End<span class="w"> </span><span class="c1">#</span>
</pre></div>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># For parallel calculation only! #</span>
<span class="c1"># For the second run: read of the sub-domains #</span>
<span class="c1"># Scatter DOM .Zones my_domain #</span>
</pre></div>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># Discretization on hexa or tetra mesh #</span>
VDF<span class="w"> </span>my_discretization
</pre></div>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># Time scheme explicit or implicit #</span>
Scheme_euler_explicit<span class="w"> </span>my_scheme
Read<span class="w"> </span>my_scheme
<span class="o">{</span>
<span class="w">   </span><span class="c1"># Initial time #</span>
<span class="w">   </span><span class="c1"># Time step #</span>
<span class="w">   </span><span class="c1"># Output criteria #</span>
<span class="w">   </span><span class="c1"># Stop Criteria #</span>
<span class="o">}</span>
</pre></div>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># Association between the different objects #</span>
Associate<span class="w"> </span>my_problem<span class="w"> </span>my_domain
Associate<span class="w"> </span>my_problem<span class="w"> </span>my_scheme
</pre></div>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># Discretization of the problem #</span>
Discretize<span class="w"> </span>my_problem<span class="w"> </span>my_discretization
</pre></div>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># New domains for post-treatment #</span>
<span class="c1"># By default each boundary condition of the domain is already extracted #</span>
<span class="c1"># with names such as "my_dom"_boundaries_"my_BC" #</span>
Domaine<span class="w"> </span>plane
extraire_surface
<span class="o">{</span>
<span class="w">   </span>domaine<span class="w"> </span>plane
<span class="w">   </span>probleme<span class="w"> </span>my_probleme
<span class="w">   </span>condition_elements<span class="w"> </span><span class="o">(</span>x&gt;0.5<span class="o">)</span>
<span class="w">   </span>condition_faces<span class="w"> </span><span class="o">(</span><span class="m">1</span><span class="o">)</span>
<span class="o">}</span>
</pre></div>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># Problem description #</span>
Read<span class="w"> </span>my_problem
<span class="o">{</span>
</pre></div>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="o">{</span>
<span class="w">   </span><span class="c1"># hydraulic problem #</span>
<span class="w">   </span>Navier_Stokes_standard
<span class="w">   </span><span class="o">{</span>
<span class="w">      </span><span class="c1"># Physical characteristics of medium #</span>
<span class="w">      </span>Fluide_Incompressible
<span class="w">      </span><span class="o">{</span>
<span class="w">      </span>...
<span class="w">      </span><span class="c1"># Gravity vector definition #</span>
<span class="w">      </span>gravity<span class="w"> </span>Uniform_field<span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="m">0</span><span class="w"> </span>-9.81
<span class="w">      </span><span class="o">}</span>

<span class="w">      </span><span class="c1"># Choice of the pressure matrix solver #</span>
<span class="w">      </span>Solveur_Pression<span class="w"> </span>solver<span class="w"> </span><span class="o">{</span><span class="w"> </span>...<span class="w"> </span><span class="o">}</span>

<span class="w">      </span><span class="c1"># Diffusion operator #</span>
<span class="w">      </span>Diffusion<span class="w"> </span><span class="o">{</span><span class="w"> </span>...<span class="w"> </span><span class="o">}</span>

<span class="w">      </span><span class="c1"># Convection operator #</span>
<span class="w">      </span>Convection<span class="w"> </span><span class="o">{</span><span class="w"> </span>...<span class="w"> </span><span class="o">}</span>

<span class="w">      </span><span class="c1"># Sources #</span>
<span class="w">      </span>Sources<span class="w"> </span><span class="o">{</span><span class="w"> </span>...<span class="w"> </span><span class="o">}</span>

<span class="w">      </span><span class="c1"># Initial conditions #</span>
<span class="w">      </span>Initial_conditions<span class="w"> </span><span class="o">{</span><span class="w"> </span>...<span class="w"> </span><span class="o">}</span>

<span class="w">      </span><span class="c1"># Boundary conditions #</span>
<span class="w">      </span>Boundary_conditions<span class="w"> </span><span class="o">{</span><span class="w"> </span>...<span class="w"> </span><span class="o">}</span>
<span class="w">   </span><span class="o">}</span>
</pre></div>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># Post_processing description #</span>
<span class="c1"># To know domains that can be treated directly, search in .err #</span>
<span class="c1"># output file: "Creating a surface domain named" #</span>

<span class="c1"># To know fields that can be treated directly, search in .err #</span>
<span class="c1"># output file: "Reading of fields to be postprocessed" #</span>

Post_processing
<span class="o">{</span>
<span class="w">   </span><span class="c1"># Definition of new fields #</span>
<span class="w">   </span>Definition_Champs<span class="w"> </span><span class="o">{</span><span class="w"> </span>...<span class="w"> </span><span class="o">}</span>

<span class="w">   </span><span class="c1"># Probes #</span>
<span class="w">   </span>Probes<span class="w"> </span><span class="o">{</span><span class="w"> </span>...<span class="w"> </span><span class="o">}</span>

<span class="w">   </span><span class="c1"># Fields #</span>
<span class="w">   </span><span class="c1"># format default value: lml #</span>
<span class="w">   </span><span class="c1"># select ’lata’ for VisIt tool or ’MED’ for Salomé #</span>
<span class="w">   </span>format<span class="w"> </span>lata
<span class="w">   </span>fields<span class="w"> </span>dt_post<span class="w"> </span><span class="m">1</span>.<span class="w"> </span><span class="o">{</span><span class="w"> </span>...<span class="w"> </span><span class="o">}</span>

<span class="w">   </span><span class="c1"># Statistical fields #</span>
<span class="w">   </span>Statistiques<span class="w"> </span>dt_post<span class="w"> </span><span class="m">1</span>.<span class="w"> </span><span class="o">{</span><span class="w"> </span>...<span class="w"> </span><span class="o">}</span>
<span class="o">}</span>
</pre></div>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># Saving and restarting process #</span>
<span class="o">[</span>sauvegarde<span class="w"> </span>binaire<span class="w"> </span>datafile<span class="w"> </span>.sauv<span class="o">]</span>
<span class="o">[</span>resume_last_time<span class="w"> </span>binaire<span class="w"> </span>datafile<span class="w"> </span>.sauv<span class="o">]</span>
</pre></div>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># End of the problem description block #</span>
<span class="o">}</span>
</pre></div>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># The problem is solved with #</span>
Solve<span class="w"> </span>my_problem
</pre></div>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># Not necessary keyword to finish #</span>
End
</pre></div>
</div>
</section>
<section id="basic-rules">
<h3 id="basic-rules">Basic Rules<a class="headerlink" href="#basic-rules" title="Permalink to this heading">¶</a></h3>
<p>There is no line concept in <strong>TRUST</strong>.</p>
<p>Data files uses <code class="docutils literal notranslate"><span class="pre">blocks</span></code>. They may be defined using the braces:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="o">{</span>
<span class="w">   </span>a<span class="w"> </span>block
<span class="o">}</span>
</pre></div>
</div>
</section>
<section id="objects-notion">
<h3 id="objects-notion">Objects Notion<a class="headerlink" href="#objects-notion" title="Permalink to this heading">¶</a></h3>
<p><strong>Objects</strong> are created in the data set as follows:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="o">[</span><span class="w"> </span><span class="nb">export</span><span class="w"> </span><span class="o">]</span><span class="w"> </span>Type<span class="w"> </span>identificateur
</pre></div>
</div>
<ul class="simple">
<li><p><strong>export</strong>: if this keyword is included, <em>identificateur</em> (identifier) will have a global range, if not, its range will be applied to the block only (the associated object will be destroyed on exiting the block).</p></li>
<li><p><strong>Type</strong>: must be a type of object recognised by <strong>TRUST</strong>, correspond to the C++ classes. The list of recognised types is given in the file hierarchie.dump.</p></li>
<li><p><strong>identificateur</strong>: the identifier of the object type <em>Type</em> created, correspond to an instancy of the C++ class <em>Type</em>. <strong>TRUST</strong> exits in error if the identifier has already been used.</p></li>
</ul>
<p>There are several object types. Physical objects, for example:</p>
<ul class="simple">
<li><p>A <strong>Fluide_incompressible</strong> (incompressible_Fluid) object. This type of object is defined by its physical characteristics (its dynamic viscosity <span class="math notranslate nohighlight">\(\mu\)</span> (keyword <strong>mu</strong>), its density <span class="math notranslate nohighlight">\(\rho\)</span> (keyword <strong>rho</strong>), etc…).</p></li>
<li><p>A <strong>Domaine</strong>.</p></li>
</ul>
<p>More abstract object types also exist:</p>
<ul class="simple">
<li><p>A <strong>VDF</strong>, <strong>VEFPreP1B</strong>, <strong>PolyMAC_P0P1NC</strong> or <strong>PolyMAC_P0</strong> according to the discretization type.</p></li>
<li><p>A <strong>Scheme_euler_explicit</strong> to indicate the time scheme type.</p></li>
<li><p>A <strong>Solveur_pression</strong> to denote the pressure system solver type.</p></li>
<li><p>A <strong>Uniform_field</strong> to define, for example, the gravity field.</p></li>
</ul>
</section>
<section id="interpretor-notion">
<h3 id="interpretor-notion">Interpretor Notion<a class="headerlink" href="#interpretor-notion" title="Permalink to this heading">¶</a></h3>
<p><strong>Interprete</strong> (interpretor) type objects are then used to handle the created objects with the following syntax:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>Type_interprete<span class="w"> </span>argument
</pre></div>
</div>
<ul class="simple">
<li><p><strong>Type_interprete</strong>: any type derived from the <strong>Interprete</strong> (Interpretor) type recognised by <strong>TRUST</strong>.</p></li>
<li><p><strong>argument</strong>: an argument may comprise one or several object identifiers and/or one or several data blocks.</p></li>
</ul>
<p>Interpretors allow some operations to be carried out on objects.</p>
<p>Currently available general interpretors include <strong>Read</strong>, <strong>Read_file</strong>, <strong>Ecrire</strong> (Write), <strong>Ecrire_fichier</strong> (Write_file), <strong>Associate</strong>.</p>
</section>
<section id="example">
<h3 id="example">Example<a class="headerlink" href="#example" title="Permalink to this heading">¶</a></h3>
<p>A data set to write Ok on screen:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>Nom<span class="w"> </span>a_name<span class="w">        </span><span class="c1"># Creation of an object type. Name identifier a_name #</span>
Read<span class="w"> </span>a_name<span class="w"> </span>Ok<span class="w">    </span><span class="c1"># Allocates the string "Ok" to a_name #</span>
Ecrire<span class="w"> </span>a_name<span class="w">     </span><span class="c1"># Write a_name on screen #</span>
</pre></div>
</div>
</section>
<section id="important-remarks">
<h3 id="important-remarks">Important Remarks<a class="headerlink" href="#important-remarks" title="Permalink to this heading">¶</a></h3>
<ol class="arabic simple">
<li><p>To insert <em>comments</em> in the data set, use # .. # (or /* … */), the character # must always be enclosed by blanks.</p></li>
<li><p>The comma separates items in a list (a comma must be enclosed with spaces or a new line).</p></li>
<li><p>Interpretor keywords are recognised indiscriminately whether they are written in lower and/or upper case.</p></li>
<li><p><strong>On the contrary, object names (identifiers) are recognised differently if they are written in upper or lower case.</strong></p></li>
<li><p>In the following description, items (keywords or values) enclosed by [ and ] are <em>optional</em>.</p></li>
</ol>
</section>
</section>
<section id="running-a-data-file">
<h2 id="running-a-data-file">Running a Data File<a class="headerlink" href="#running-a-data-file" title="Permalink to this heading">¶</a></h2>
<p>To use <strong>TRUST</strong>, your shell must be “bash”. So ensure you are in the right shell:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>&gt; echo $0
/bin/bash
</pre></div>
</div>
<p>To run your data file, you must initialize the TRUST environment using
the following command:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>&gt; source $my_path_to_TRUST_installation/env_TRUST.sh
TRUST vX.Y.Z support : trust@cea.fr
Loading personal configuration /$path_to_my_home_directory/.perso_TRUST.env
</pre></div>
</div>
<section id="sequential-calculation">
<h3 id="sequential-calculation">Sequential Calculation<a class="headerlink" href="#sequential-calculation" title="Permalink to this heading">¶</a></h3>
<p>You can run your sequential calculation:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>&gt; cd $my_test_directory
&gt; trust [-evol] my_data_file
</pre></div>
</div>
<p>where “trust” command call the “trust” script. You can have the list of
its options with:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;</span> <span class="n">trust</span> <span class="o">-</span><span class="n">help</span>
</pre></div>
</div>
<p>or</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;</span> <span class="n">trust</span> <span class="o">-</span><span class="n">h</span>
</pre></div>
</div>
<p>Here is a panel of available options:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Usage</span><span class="p">:</span> <span class="n">trust</span> <span class="p">[</span><span class="n">option</span><span class="p">]</span> <span class="n">datafile</span> <span class="p">[</span><span class="n">nb_cpus</span><span class="p">]</span> <span class="p">[</span><span class="mi">1</span><span class="o">&gt;</span><span class="n">file</span><span class="o">.</span><span class="n">out</span><span class="p">]</span> <span class="p">[</span><span class="mi">2</span><span class="o">&gt;</span><span class="n">file</span><span class="o">.</span><span class="n">err</span><span class="p">]</span>
<span class="n">Where</span> <span class="n">option</span> <span class="n">may</span> <span class="n">be</span><span class="p">:</span>
<span class="o">-</span><span class="n">help</span><span class="o">|-</span><span class="n">h</span>                      <span class="p">:</span> <span class="n">List</span> <span class="n">options</span><span class="o">.</span>
<span class="o">-</span><span class="n">baltik</span> <span class="p">[</span><span class="n">baltik_name</span><span class="p">]</span>         <span class="p">:</span> <span class="n">Instanciate</span> <span class="n">an</span> <span class="n">empty</span> <span class="n">Baltik</span> <span class="n">project</span><span class="o">.</span>
<span class="o">-</span><span class="n">index</span>                        <span class="p">:</span> <span class="n">Access</span> <span class="n">to</span> <span class="n">the</span> <span class="n">TRUST</span> <span class="n">ressource</span> <span class="n">index</span><span class="o">.</span>
<span class="o">-</span><span class="n">doc</span>                          <span class="p">:</span> <span class="n">Access</span> <span class="n">to</span> <span class="n">the</span> <span class="n">TRUST</span> <span class="n">manual</span> <span class="p">(</span><span class="n">Generic</span> <span class="n">Guide</span><span class="p">)</span><span class="o">.</span>
<span class="o">-</span><span class="n">html</span>                         <span class="p">:</span> <span class="n">Access</span> <span class="n">to</span> <span class="n">the</span> <span class="n">doxygen</span> <span class="n">documentation</span><span class="o">.</span>
<span class="o">-</span><span class="n">config</span> <span class="n">nedit</span><span class="o">|</span><span class="n">vim</span><span class="o">|</span><span class="n">emacs</span><span class="o">|</span><span class="n">gedit</span> <span class="p">:</span> <span class="n">Configure</span> <span class="n">nedit</span> <span class="ow">or</span> <span class="n">vim</span> <span class="ow">or</span> <span class="n">emacs</span> <span class="ow">or</span> <span class="n">gedit</span> <span class="k">with</span> <span class="n">TRUST</span> <span class="n">keywords</span><span class="o">.</span>
<span class="o">-</span><span class="n">edit</span>                         <span class="p">:</span> <span class="n">Edit</span> <span class="n">datafile</span><span class="o">.</span>
<span class="o">-</span><span class="n">xcheck</span>                       <span class="p">:</span> <span class="n">Check</span> <span class="n">the</span> <span class="n">datafile</span><span class="s1">'s keywords with xdata.</span>
<span class="o">-</span><span class="n">xdata</span>                        <span class="p">:</span> <span class="n">Check</span> <span class="ow">and</span> <span class="n">run</span> <span class="n">the</span> <span class="n">datafile</span><span class="s1">'s keywords with xdata.</span>
<span class="o">-</span><span class="n">partition</span>                    <span class="p">:</span> <span class="n">Partition</span> <span class="n">the</span> <span class="n">mesh</span> <span class="n">to</span> <span class="n">prepare</span> <span class="n">a</span> <span class="n">parallel</span> <span class="n">calculation</span> <span class="p">(</span><span class="n">Creation</span> <span class="n">of</span> <span class="n">the</span> <span class="o">.</span><span class="n">Zones</span> <span class="n">files</span><span class="p">)</span><span class="o">.</span>
<span class="o">-</span><span class="n">mesh</span>                         <span class="p">:</span> <span class="n">Visualize</span> <span class="n">the</span> <span class="n">mesh</span><span class="p">(</span><span class="n">es</span><span class="p">)</span> <span class="n">contained</span> <span class="ow">in</span> <span class="n">the</span> <span class="n">data</span> <span class="n">file</span><span class="o">.</span>
<span class="o">-</span><span class="n">eclipse</span><span class="o">-</span><span class="n">trust</span>                <span class="p">:</span> <span class="n">Generate</span> <span class="n">Eclipse</span> <span class="n">configuration</span> <span class="n">files</span> <span class="n">to</span> <span class="kn">import</span> <span class="nn">TRUST</span> <span class="n">sources</span><span class="o">.</span>
<span class="o">-</span><span class="n">eclipse</span><span class="o">-</span><span class="n">baltik</span>               <span class="p">:</span> <span class="n">Generate</span> <span class="n">Eclipse</span> <span class="n">configuration</span> <span class="n">files</span> <span class="n">to</span> <span class="kn">import</span> <span class="nn">BALTIK</span> <span class="n">sources</span> <span class="p">(</span><span class="n">TRUST</span> <span class="n">project</span> <span class="n">should</span> <span class="n">have</span> <span class="n">been</span> <span class="n">configured</span> <span class="n">under</span> <span class="n">Eclipse</span><span class="p">)</span><span class="o">.</span>
<span class="o">-</span><span class="n">probes</span>                       <span class="p">:</span> <span class="n">Monitor</span> <span class="n">the</span> <span class="n">TRUST</span> <span class="n">calculation</span> <span class="n">only</span><span class="o">.</span>
<span class="o">-</span><span class="n">evol</span>                         <span class="p">:</span> <span class="n">Monitor</span> <span class="n">the</span> <span class="n">TRUST</span> <span class="n">calculation</span> <span class="p">(</span><span class="n">GUI</span><span class="p">)</span><span class="o">.</span>
<span class="o">-</span><span class="n">prm</span>                          <span class="p">:</span> <span class="n">Write</span> <span class="n">a</span> <span class="n">prm</span> <span class="n">file</span> <span class="p">(</span><span class="n">deprecated</span><span class="p">)</span><span class="o">.</span>
<span class="o">-</span><span class="n">jupyter</span>                      <span class="p">:</span> <span class="n">Create</span> <span class="n">basic</span> <span class="n">jupyter</span> <span class="n">notebook</span> <span class="n">file</span><span class="o">.</span>
<span class="o">-</span><span class="n">clean</span>                        <span class="p">:</span> <span class="n">Clean</span> <span class="n">the</span> <span class="n">current</span> <span class="n">directory</span> <span class="kn">from</span> <span class="nn">all</span> <span class="n">the</span> <span class="n">generated</span> <span class="n">files</span> <span class="n">by</span> <span class="n">TRUST</span><span class="o">.</span>
<span class="o">-</span><span class="n">search</span> <span class="n">keywords</span>              <span class="p">:</span> <span class="n">Know</span> <span class="n">the</span> <span class="nb">list</span> <span class="n">of</span> <span class="n">test</span> <span class="n">cases</span> <span class="kn">from</span> <span class="nn">the</span> <span class="n">data</span> <span class="n">bases</span> <span class="n">which</span> <span class="n">contain</span> <span class="n">keywords</span><span class="o">.</span>
<span class="o">-</span><span class="n">copy</span>                         <span class="p">:</span> <span class="n">Copy</span> <span class="n">the</span> <span class="n">test</span> <span class="n">case</span> <span class="n">datafile</span> <span class="kn">from</span> <span class="nn">the</span> <span class="n">TRUST</span> <span class="n">database</span> <span class="n">under</span> <span class="n">the</span> <span class="n">present</span> <span class="n">directory</span><span class="o">.</span>
<span class="o">-</span><span class="n">check</span><span class="o">|-</span><span class="n">ctest</span> <span class="nb">all</span><span class="o">|</span><span class="n">testcase</span><span class="o">|</span><span class="nb">list</span>            <span class="p">:</span> <span class="n">Check</span><span class="o">|</span><span class="n">ctest</span> <span class="n">the</span> <span class="n">non</span> <span class="n">regression</span> <span class="n">of</span> <span class="nb">all</span> <span class="n">the</span> <span class="n">test</span> <span class="n">cases</span> <span class="ow">or</span> <span class="n">a</span> <span class="n">single</span> <span class="n">test</span> <span class="n">case</span> <span class="ow">or</span> <span class="n">a</span> <span class="nb">list</span> <span class="n">of</span> <span class="n">tests</span> <span class="n">cases</span> <span class="n">specified</span> <span class="ow">in</span> <span class="n">a</span> <span class="n">file</span><span class="o">.</span>
<span class="o">-</span><span class="n">check</span><span class="o">|-</span><span class="n">ctest</span> <span class="n">function</span><span class="o">|</span><span class="n">class</span><span class="o">|</span><span class="n">class</span><span class="p">::</span><span class="n">method</span> <span class="p">:</span> <span class="n">Check</span><span class="o">|</span><span class="n">ctest</span> <span class="n">the</span> <span class="n">non</span> <span class="n">regression</span> <span class="n">of</span> <span class="n">a</span> <span class="nb">list</span> <span class="n">of</span> <span class="n">tests</span> <span class="n">cases</span> <span class="n">covering</span> <span class="n">a</span> <span class="n">function</span><span class="p">,</span> <span class="n">a</span> <span class="k">class</span> <span class="nc">or</span> <span class="n">a</span> <span class="k">class</span> <span class="nc">method</span><span class="o">.</span>
<span class="o">-</span><span class="n">gdb</span>                          <span class="p">:</span> <span class="n">Run</span> <span class="n">under</span> <span class="n">gdb</span> <span class="n">debugger</span><span class="o">.</span>
<span class="o">-</span><span class="n">valgrind</span>                     <span class="p">:</span> <span class="n">Run</span> <span class="n">under</span> <span class="n">valgrind</span><span class="o">.</span>
<span class="o">-</span><span class="n">valgrind_strict</span>              <span class="p">:</span> <span class="n">Run</span> <span class="n">under</span> <span class="n">valgrind</span> <span class="k">with</span> <span class="n">no</span> <span class="n">suppressions</span><span class="o">.</span>
<span class="o">-</span><span class="n">callgrind</span>                    <span class="p">:</span> <span class="n">Run</span> <span class="n">callgrind</span> <span class="n">tool</span> <span class="p">(</span><span class="n">profiling</span><span class="p">)</span> <span class="kn">from</span> <span class="nn">valgrind.</span>
<span class="o">-</span><span class="n">massif</span>                       <span class="p">:</span> <span class="n">Run</span> <span class="n">massif</span> <span class="n">tool</span> <span class="p">(</span><span class="n">heap</span> <span class="n">profile</span><span class="p">)</span> <span class="kn">from</span> <span class="nn">valgrind.</span>
<span class="o">-</span><span class="n">heaptrack</span>                    <span class="p">:</span> <span class="n">Run</span> <span class="n">heaptrack</span> <span class="p">(</span><span class="n">heap</span> <span class="n">profile</span><span class="p">)</span><span class="o">.</span> <span class="n">Better</span> <span class="n">than</span> <span class="n">massif</span><span class="o">.</span>
<span class="o">-</span><span class="n">advisor</span>                      <span class="p">:</span> <span class="n">Run</span> <span class="n">advisor</span> <span class="n">tool</span> <span class="p">(</span><span class="n">vectorization</span><span class="p">)</span><span class="o">.</span>
<span class="o">-</span><span class="n">vtune</span>                        <span class="p">:</span> <span class="n">Run</span> <span class="n">vtune</span> <span class="n">tool</span> <span class="p">(</span><span class="n">profiling</span><span class="p">)</span><span class="o">.</span>
<span class="o">-</span><span class="n">perf</span>                         <span class="p">:</span> <span class="n">Run</span> <span class="n">perf</span> <span class="n">tool</span> <span class="p">(</span><span class="n">profiling</span><span class="p">)</span><span class="o">.</span>
<span class="o">-</span><span class="n">trace</span>                        <span class="p">:</span> <span class="n">Run</span> <span class="n">traceanalyzer</span> <span class="n">tool</span> <span class="p">(</span><span class="n">MPI</span> <span class="n">profiling</span><span class="p">)</span><span class="o">.</span>
<span class="o">-</span><span class="n">create_sub_file</span>              <span class="p">:</span> <span class="n">Create</span> <span class="n">a</span> <span class="n">submission</span> <span class="n">file</span> <span class="n">only</span><span class="o">.</span>
<span class="o">-</span><span class="n">prod</span>                         <span class="p">:</span> <span class="n">Create</span> <span class="n">a</span> <span class="n">submission</span> <span class="n">file</span> <span class="ow">and</span> <span class="n">submit</span> <span class="n">the</span> <span class="n">job</span> <span class="n">on</span> <span class="n">the</span> <span class="n">main</span> <span class="n">production</span> <span class="k">class</span> <span class="nc">with</span> <span class="n">exclusive</span> <span class="n">resource</span><span class="o">.</span>
<span class="o">-</span><span class="n">bigmem</span>                       <span class="p">:</span> <span class="n">Create</span> <span class="n">a</span> <span class="n">submission</span> <span class="n">file</span> <span class="ow">and</span> <span class="n">submit</span> <span class="n">the</span> <span class="n">job</span> <span class="n">on</span> <span class="n">the</span> <span class="n">big</span> <span class="n">memory</span> <span class="n">production</span> <span class="n">class</span><span class="o">.</span>
<span class="o">-</span><span class="n">queue</span> <span class="n">queue</span>                  <span class="p">:</span> <span class="n">Create</span> <span class="n">a</span> <span class="n">submission</span> <span class="n">file</span> <span class="k">with</span> <span class="n">the</span> <span class="n">specified</span> <span class="n">queue</span> <span class="ow">and</span> <span class="n">submit</span> <span class="n">the</span> <span class="n">job</span><span class="o">.</span>
<span class="o">-</span><span class="n">c</span> <span class="n">ncpus</span>                      <span class="p">:</span> <span class="n">Use</span> <span class="n">ncpus</span> <span class="n">CPUs</span> <span class="n">allocated</span> <span class="n">per</span> <span class="n">task</span> <span class="k">for</span> <span class="n">a</span> <span class="n">parallel</span> <span class="n">calculation</span><span class="o">.</span>
<span class="n">datafile</span> <span class="o">-</span><span class="n">help_trust</span>          <span class="p">:</span> <span class="n">Print</span> <span class="n">options</span> <span class="n">of</span> <span class="n">TRUST_EXECUTABLE</span> <span class="p">[</span><span class="n">CASE</span><span class="p">[</span><span class="o">.</span><span class="n">data</span><span class="p">]]</span> <span class="p">[</span><span class="n">options</span><span class="p">]</span><span class="o">.</span>
<span class="o">-</span><span class="n">convert_data</span> <span class="n">datafile</span>        <span class="p">:</span> <span class="n">Convert</span> <span class="n">a</span> <span class="n">data</span> <span class="n">file</span> <span class="n">to</span> <span class="n">the</span> <span class="n">new</span> <span class="mf">1.9.1</span> <span class="n">syntax</span> <span class="p">(</span><span class="n">milieu</span><span class="p">,</span> <span class="n">interfaces</span><span class="p">,</span> <span class="n">read_med</span> <span class="ow">and</span> <span class="n">champ_fonc_med</span><span class="p">)</span><span class="o">.</span>
</pre></div>
</div>
</section>
<section id="parallel-calculation">
<h3 id="parallel-calculation">Parallel Calculation<a class="headerlink" href="#parallel-calculation" title="Permalink to this heading">¶</a></h3>
<p>To run a parallel calculation, you must do two runs:</p>
<ul class="simple">
<li><p>the first one, to partition and create your ’n’ sub-domains (two methods: “By hand” method (see below) and “Assisted” method ( see sections <a class="reference internal" href="para.html#decjdd"><span class="std std-ref">The different blocks</span></a> &amp; <a class="reference internal" href="para.html#makepardata"><span class="std std-ref">Partitionning: “Assisted” method</span></a>).</p></li>
<li><p>the second one, to read your ’n’ sub-domains and run the calculation on ’n’ processors.</p></li>
</ul>
<p>We will explain here how to do such work:</p>
<ul>
<li><p><strong>Partitioning: “By hand” method</strong></p>
<p>You have to make two data files:</p>
<ol class="arabic simple">
<li><p><code class="docutils literal notranslate"><span class="pre">BuildMeshes.data</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Calculation.data</span></code></p></li>
</ol>
<p>The <code class="docutils literal notranslate"><span class="pre">BuildMeshes.data</span></code> file only contains the same information as the begining of the sequential data file and partitioning information.
This file will create the sub-domains (cf .Zones files).</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>Dimension<span class="w"> </span><span class="m">2</span>
Domaine<span class="w"> </span>my_domain

<span class="c1"># BEGIN MESH #</span>
Read_file<span class="w"> </span>my_mesh.geo<span class="w"> </span><span class="p">;</span>
<span class="c1"># END MESH #</span>

<span class="c1"># BEGIN PARTITION #</span>
Partition<span class="w"> </span>my_domain
<span class="o">{</span>
<span class="w">   </span>Partition_tool<span class="w"> </span>partitioner_name<span class="w"> </span><span class="o">{</span><span class="w"> </span>option1<span class="w"> </span>option2<span class="w"> </span>...<span class="w"> </span><span class="o">}</span>
<span class="w">   </span>Larg_joint<span class="w"> </span><span class="m">2</span>
<span class="w">   </span>zones_name<span class="w"> </span>DOM
<span class="w">   </span>...
<span class="o">}</span>
End
<span class="c1"># END PARTITION #</span>
</pre></div>
</div>
<p>Run the <code class="docutils literal notranslate"><span class="pre">BuildMeshes.data</span></code> with <strong>TRUST</strong>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;</span> <span class="n">trust</span> <span class="n">BuildMeshes</span>
</pre></div>
</div>
<p>You may have obtained files named <code class="docutils literal notranslate"><span class="pre">DOM_000n*.Zones</span></code> which contains the ’n’ sub-domains.</p>
</li>
<li><p><strong>Read the sub-domains</strong></p>
<p>The <code class="docutils literal notranslate"><span class="pre">Calculation.data</span></code> file contains the domain definition, the block which will read the sub-domains and the problem definition</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>Dimension<span class="w"> </span><span class="m">2</span>
Domaine<span class="w"> </span>my_domain

Pb_Hydraulique<span class="w"> </span>my_problem

<span class="c1"># BEGIN SCATTER #</span>
Scatter<span class="w"> </span>DOM<span class="w"> </span>.Zones<span class="w"> </span>my_domain
<span class="c1"># END SCATTER #</span>

VDF<span class="w"> </span>my_discretization

Scheme_euler_explicit<span class="w"> </span>my_scheme
Read<span class="w"> </span>my_scheme<span class="w"> </span><span class="o">{</span><span class="w"> </span>...<span class="w"> </span><span class="o">}</span>

Associate<span class="w"> </span>my_problem<span class="w"> </span>my_domain
Associate<span class="w"> </span>my_problem<span class="w"> </span>my_scheme
Discretize<span class="w"> </span>my_problem<span class="w"> </span>my_discretization

Read<span class="w"> </span>my_problem
<span class="o">{</span>
<span class="w">   </span>Fluide_Incompressible<span class="w"> </span><span class="o">{</span><span class="w"> </span>...<span class="w"> </span><span class="o">}</span>
<span class="w">   </span>...
<span class="o">}</span>
Solve<span class="w"> </span>my_problem
End
</pre></div>
</div>
<p>Run the <code class="docutils literal notranslate"><span class="pre">Calculation.data</span></code> file with <strong>TRUST</strong>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;</span> <span class="n">trust</span> <span class="n">Calculation</span> <span class="n">procs_number</span>
</pre></div>
</div>
<p>This will read your <code class="docutils literal notranslate"><span class="pre">DOM_000n*.Zones</span></code> files. You can see the documentation of the <strong>scatter</strong> keyword in Reference Manual which is available <a class="reference external" href="https://github.com/cea-trust-platform/trust-code/blob/master/doc/TRUST/TRUST_Reference_Manual.pdf">here</a>.</p>
<p>For more information, have a look on the first exercise of the <a class="reference external" href="https://github.com/cea-trust-platform/trust-code/blob/master/doc/TRUST/TRUST_tutorial.pdf">TRUST Tutorial</a>; Flow around an Obstacle, Parallel calculation section !</p>
</li>
</ul>
</section>
</section>
<section id="interactive-evolution">
<h2 id="interactive-evolution">Interactive Evolution<a class="headerlink" href="#interactive-evolution" title="Permalink to this heading">¶</a></h2>
<p>To learn how to use the “<strong>-evol</strong>” option, you can see the first exercise of the <strong>TRUST</strong> tutorial: Flow around an obstacle available on <a class="reference external" href="https://github.com/cea-trust-platform/trust-code/blob/master/doc/TRUST/TRUST_tutorial.pdf">this link</a>.</p>
</section>
</section>


          </article>
        </div>
      </div>
    </main>
  </div>
  <footer class="md-footer">
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
          
            <a href="../index.html" title="TRUST Generic Guide"
               class="md-flex md-footer-nav__link md-footer-nav__link--prev"
               rel="prev">
              <div class="md-flex__cell md-flex__cell--shrink">
                <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
              </div>
              <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
                <span class="md-flex__ellipsis">
                  <span
                      class="md-footer-nav__direction"> Previous </span> TRUST Generic Guide </span>
              </div>
            </a>
          
          
            <a href="data.html" title="Data setting"
               class="md-flex md-footer-nav__link md-footer-nav__link--next"
               rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title"><span
                class="md-flex__ellipsis"> <span
                class="md-footer-nav__direction"> Next </span> Data setting </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink"><i
                class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          
        </a>
        
      </nav>
    </div>
    <div class="md-footer-meta md-typeset">
      <div class="md-footer-meta__inner md-grid">
        <div class="md-footer-copyright">
          <div class="md-footer-copyright__highlight">
              &#169; Copyright .
              
          </div>
            Created using
            <a href="http://www.sphinx-doc.org/">Sphinx</a> 7.0.1.
             and
            <a href="https://github.com/bashtage/sphinx-material/">Material for
              Sphinx</a>
        </div>
      </div>
    </div>
  </footer>
  <script src="../_static/javascripts/application.js"></script>
  <script>app.initialize({version: "1.0.4", url: {base: ".."}})</script>
  </body>
</html>